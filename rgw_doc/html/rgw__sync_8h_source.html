<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Ceph RADOS Gateway: rgw_sync.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ceph RADOS Gateway
   &#160;<span id="projectnumber">54b6c99f8f191958919a1d08a57b4bbad18ba57a</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">rgw_sync.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rgw__sync_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef CEPH_RGW_SYNC_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CEPH_RGW_SYNC_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__coroutine_8h.html">rgw_coroutine.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__http__client_8h.html">rgw_http_client.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__meta__sync__status_8h.html">rgw_meta_sync_status.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;include/stringify.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;common/RWLock.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="rgw__sync_8h.html#ac8a60a8be2db5d0fddffd40fdba3399f">   11</a></span>&#160;<span class="preprocessor">#define ERROR_LOGGER_SHARDS 32</span></div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="rgw__sync_8h.html#ac5f423d1a7806a5f3e8995fa874d51c4">   12</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define RGW_SYNC_ERROR_LOG_SHARD_PREFIX &quot;sync.error-log&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="structrgw__mdlog__info.html">   14</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structrgw__mdlog__info.html">rgw_mdlog_info</a> {</div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="structrgw__mdlog__info.html#ae00078e5381c6420e1c6c7e71e57c66b">   15</a></span>&#160;  uint32_t <a class="code" href="structrgw__mdlog__info.html#ae00078e5381c6420e1c6c7e71e57c66b">num_shards</a>;</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="structrgw__mdlog__info.html#a3ce669afd4c4b9706abe8b4b6b7d8ea4">   16</a></span>&#160;  std::string <a class="code" href="structrgw__mdlog__info.html#a3ce669afd4c4b9706abe8b4b6b7d8ea4">period</a>; <span class="comment">//&lt; period id of the master&#39;s oldest metadata log</span></div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="structrgw__mdlog__info.html#a66b8a82bece2c17d28259af23e311518">   17</a></span>&#160;  epoch_t <a class="code" href="structrgw__mdlog__info.html#a66b8a82bece2c17d28259af23e311518">realm_epoch</a>; <span class="comment">//&lt; realm epoch of oldest metadata log</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="structrgw__mdlog__info.html#a78eaf2d9281e102921792960af7113cd">   19</a></span>&#160;  <a class="code" href="structrgw__mdlog__info.html#a78eaf2d9281e102921792960af7113cd">rgw_mdlog_info</a>() : <a class="code" href="structrgw__mdlog__info.html#ae00078e5381c6420e1c6c7e71e57c66b">num_shards</a>(0), <a class="code" href="structrgw__mdlog__info.html#a66b8a82bece2c17d28259af23e311518">realm_epoch</a>(0) {}</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structrgw__mdlog__info.html#a060e8fb92b63bb6997e97c2a4aa10eb6">decode_json</a>(JSONObj *obj);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;};</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="structrgw__mdlog__entry.html">   25</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structrgw__mdlog__entry.html">rgw_mdlog_entry</a> {</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structrgw__mdlog__entry.html#a0d77c495d9f15ca9ba2ef6986a17d4db">   26</a></span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structrgw__mdlog__entry.html#a0d77c495d9f15ca9ba2ef6986a17d4db">id</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structrgw__mdlog__entry.html#adb8db94f8f2d38bb7fa9919e5ca7e37d">   27</a></span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structrgw__mdlog__entry.html#adb8db94f8f2d38bb7fa9919e5ca7e37d">section</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structrgw__mdlog__entry.html#af6fba6dde4817ee351007af26d393360">   28</a></span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structrgw__mdlog__entry.html#af6fba6dde4817ee351007af26d393360">name</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structrgw__mdlog__entry.html#a61e00ec20a6a7c3ad481c1904b5a4ac1">   29</a></span>&#160;  ceph::real_time <a class="code" href="structrgw__mdlog__entry.html#a61e00ec20a6a7c3ad481c1904b5a4ac1">timestamp</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structrgw__mdlog__entry.html#ad65316bffbb7be2c9f9b540d64a3e881">   30</a></span>&#160;  <a class="code" href="structRGWMetadataLogData.html">RGWMetadataLogData</a> <a class="code" href="structrgw__mdlog__entry.html#ad65316bffbb7be2c9f9b540d64a3e881">log_data</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structrgw__mdlog__entry.html#a36d6229ab8550750a1ec3f5bedbdd5b7">decode_json</a>(JSONObj *obj);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structrgw__mdlog__entry.html#adc212a6925d27bbc7442722e48cbf2f2">   34</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structrgw__mdlog__entry.html#adc212a6925d27bbc7442722e48cbf2f2">convert_from</a>(cls_log_entry&amp; le) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">id</span> = le.id;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="structrgw__mdlog__entry.html#adb8db94f8f2d38bb7fa9919e5ca7e37d">section</a> = le.section;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="structrgw__mdlog__entry.html#af6fba6dde4817ee351007af26d393360">name</a> = le.name;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="structrgw__mdlog__entry.html#a61e00ec20a6a7c3ad481c1904b5a4ac1">timestamp</a> = le.timestamp.to_real_time();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      bufferlist::iterator iter = le.data.begin();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      ::decode(<a class="code" href="structrgw__mdlog__entry.html#ad65316bffbb7be2c9f9b540d64a3e881">log_data</a>, iter);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    } <span class="keywordflow">catch</span> (buffer::error&amp; err) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;};</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structrgw__mdlog__shard__data.html">   49</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structrgw__mdlog__shard__data.html">rgw_mdlog_shard_data</a> {</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structrgw__mdlog__shard__data.html#a04e6adb5011f524422b4b41f1a41c4da">   50</a></span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structrgw__mdlog__shard__data.html#a04e6adb5011f524422b4b41f1a41c4da">marker</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structrgw__mdlog__shard__data.html#ab77660b0c0d37723354b723798f45eb7">   51</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structrgw__mdlog__shard__data.html#ab77660b0c0d37723354b723798f45eb7">truncated</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structrgw__mdlog__shard__data.html#ae6ec7f28f6c03a06a52da26831a5c69b">   52</a></span>&#160;  vector&lt;rgw_mdlog_entry&gt; <a class="code" href="structrgw__mdlog__shard__data.html#ae6ec7f28f6c03a06a52da26831a5c69b">entries</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structrgw__mdlog__shard__data.html#a7927f7215a90352f4fd09064b253560f">decode_json</a>(JSONObj *obj);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;};</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">class </span><a class="code" href="classRGWAsyncRadosProcessor.html">RGWAsyncRadosProcessor</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">class </span><a class="code" href="classRGWMetaSyncStatusManager.html">RGWMetaSyncStatusManager</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">class </span><a class="code" href="classRGWMetaSyncCR.html">RGWMetaSyncCR</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">class </span><a class="code" href="classRGWRESTConn.html">RGWRESTConn</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classRGWSyncErrorLogger.html">   62</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWSyncErrorLogger.html">RGWSyncErrorLogger</a> {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classRGWRados.html">RGWRados</a> *store;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  vector&lt;string&gt; oids;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">int</span> num_shards;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  atomic_t counter;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classRGWSyncErrorLogger.html#a44381312efbc6f5508c3fc3ee350c173">RGWSyncErrorLogger</a>(<a class="code" href="classRGWRados.html">RGWRados</a> *_store, <span class="keyword">const</span> <span class="keywordtype">string</span> oid_prefix, <span class="keywordtype">int</span> _num_shards);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *<a class="code" href="classRGWSyncErrorLogger.html#a0657e1a2467ac4d6798826ad3e071581">log_error_cr</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; source_zone, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; section, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name, uint32_t error_code, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; message);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">string</span> <a class="code" href="classRGWSyncErrorLogger.html#a281db563c4c2a4063629cd6efa8a792e">get_shard_oid</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; oid_prefix, <span class="keywordtype">int</span> shard_id);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;};</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html">   76</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structrgw__sync__error__info.html">rgw_sync_error_info</a> {</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html#a57762fd99b670d8862cbc7fb127ac569">   77</a></span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structrgw__sync__error__info.html#a57762fd99b670d8862cbc7fb127ac569">source_zone</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html#a775c931d605422bd41121c9c0f62a64d">   78</a></span>&#160;  uint32_t <a class="code" href="structrgw__sync__error__info.html#a775c931d605422bd41121c9c0f62a64d">error_code</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html#a576ba1c47839d1f631f4c89cabec414f">   79</a></span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structrgw__sync__error__info.html#a576ba1c47839d1f631f4c89cabec414f">message</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html#a3c10ea59979278a73429642d477643a3">   81</a></span>&#160;  <a class="code" href="structrgw__sync__error__info.html#a3c10ea59979278a73429642d477643a3">rgw_sync_error_info</a>() : <a class="code" href="structrgw__sync__error__info.html#a775c931d605422bd41121c9c0f62a64d">error_code</a>(0) {}</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html#a799aea84e8d29d3c04d764ae630a20bc">   82</a></span>&#160;  <a class="code" href="structrgw__sync__error__info.html#a799aea84e8d29d3c04d764ae630a20bc">rgw_sync_error_info</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; _source_zone, uint32_t _error_code, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; _message) : <a class="code" href="structrgw__sync__error__info.html#a57762fd99b670d8862cbc7fb127ac569">source_zone</a>(_source_zone), <a class="code" href="structrgw__sync__error__info.html#a775c931d605422bd41121c9c0f62a64d">error_code</a>(_error_code), <a class="code" href="structrgw__sync__error__info.html#a576ba1c47839d1f631f4c89cabec414f">message</a>(_message) {}</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html#acbeafbfa48b529a6d23d45f0508369f5">   84</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structrgw__sync__error__info.html#acbeafbfa48b529a6d23d45f0508369f5">encode</a>(bufferlist&amp; bl)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ENCODE_START(1, 1, bl);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="structrgw__sync__error__info.html#acbeafbfa48b529a6d23d45f0508369f5">::encode</a>(<a class="code" href="structrgw__sync__error__info.html#a57762fd99b670d8862cbc7fb127ac569">source_zone</a>, bl);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="structrgw__sync__error__info.html#acbeafbfa48b529a6d23d45f0508369f5">::encode</a>(<a class="code" href="structrgw__sync__error__info.html#a775c931d605422bd41121c9c0f62a64d">error_code</a>, bl);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="structrgw__sync__error__info.html#acbeafbfa48b529a6d23d45f0508369f5">::encode</a>(<a class="code" href="structrgw__sync__error__info.html#a576ba1c47839d1f631f4c89cabec414f">message</a>, bl);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    ENCODE_FINISH(bl);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structrgw__sync__error__info.html#a485f8d93b0f1a22a3b526ab2c6206b79">   92</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structrgw__sync__error__info.html#a485f8d93b0f1a22a3b526ab2c6206b79">decode</a>(bufferlist::iterator&amp; bl) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    DECODE_START(1, bl);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="structrgw__sync__error__info.html#a485f8d93b0f1a22a3b526ab2c6206b79">::decode</a>(<a class="code" href="structrgw__sync__error__info.html#a57762fd99b670d8862cbc7fb127ac569">source_zone</a>, bl);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="structrgw__sync__error__info.html#a485f8d93b0f1a22a3b526ab2c6206b79">::decode</a>(<a class="code" href="structrgw__sync__error__info.html#a775c931d605422bd41121c9c0f62a64d">error_code</a>, bl);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="structrgw__sync__error__info.html#a485f8d93b0f1a22a3b526ab2c6206b79">::decode</a>(<a class="code" href="structrgw__sync__error__info.html#a576ba1c47839d1f631f4c89cabec414f">message</a>, bl);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    DECODE_FINISH(bl);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structrgw__sync__error__info.html#a92fc5a77eeb26353ac474ee125070b85">dump</a>(Formatter *f) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;};</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<a class="code" href="namespacergw.html#a12e768365595ed6aa121311114126794">WRITE_CLASS_ENCODER</a>(<a class="code" href="structrgw__sync__error__info.html">rgw_sync_error_info</a>)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="rgw__sync_8h.html#a56083ecd2aed60436aac0efea7f39408">  104</a></span>&#160;<span class="preprocessor">#define DEFAULT_BACKOFF_MAX 30</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classRGWSyncBackoff.html">  106</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWSyncBackoff.html">RGWSyncBackoff</a> {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">int</span> cur_wait;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> max_secs;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">void</span> update_wait_time();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classRGWSyncBackoff.html#abda29a06effd71d89e91796fa91b43c9">  112</a></span>&#160;  <a class="code" href="classRGWSyncBackoff.html#abda29a06effd71d89e91796fa91b43c9">RGWSyncBackoff</a>(<span class="keywordtype">int</span> _max_secs = <a class="code" href="rgw__sync_8h.html#a56083ecd2aed60436aac0efea7f39408">DEFAULT_BACKOFF_MAX</a>) : cur_wait(0), max_secs(_max_secs) {}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWSyncBackoff.html#aa793435b1d97fcaabbbc48a55e32e55a">backoff_sleep</a>();</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classRGWSyncBackoff.html#a020bd2076168bc4cd71ddeb59e2f0883">  115</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWSyncBackoff.html#a020bd2076168bc4cd71ddeb59e2f0883">reset</a>() {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    cur_wait = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWSyncBackoff.html#a291a4e6cd7598b8e29a245f3cc4c720d">backoff</a>(<a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *op);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;};</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classRGWBackoffControlCR.html">  122</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWBackoffControlCR.html">RGWBackoffControlCR</a> : <span class="keyword">public</span> <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *cr;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  Mutex lock;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="classRGWSyncBackoff.html">RGWSyncBackoff</a> backoff;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">bool</span> reset_backoff;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">bool</span> exit_on_error;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classRGWBackoffControlCR.html#ad9b27ba88ad33601ccdf833d83d92e9d">  133</a></span>&#160;  <span class="keywordtype">bool</span> *<a class="code" href="classRGWBackoffControlCR.html#ad9b27ba88ad33601ccdf833d83d92e9d">backoff_ptr</a>() {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> &amp;reset_backoff;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classRGWBackoffControlCR.html#af3286294ada2705450a9e8fbb3c7aa4d">  137</a></span>&#160;  Mutex&amp; <a class="code" href="classRGWBackoffControlCR.html#af3286294ada2705450a9e8fbb3c7aa4d">cr_lock</a>() {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> lock;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classRGWBackoffControlCR.html#ae70793f9973a01e39a10bb08aaad1992">  141</a></span>&#160;  <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *<a class="code" href="classRGWBackoffControlCR.html#ae70793f9973a01e39a10bb08aaad1992">get_cr</a>() {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span> cr;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classRGWBackoffControlCR.html#a2cd39bfeba7c7f3a47ff8a4fac1b1dfd">  146</a></span>&#160;  <a class="code" href="classRGWBackoffControlCR.html#a2cd39bfeba7c7f3a47ff8a4fac1b1dfd">RGWBackoffControlCR</a>(CephContext *_cct, <span class="keywordtype">bool</span> _exit_on_error) : <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a>(_cct), cr(NULL), lock(<span class="stringliteral">&quot;RGWBackoffControlCR::lock:&quot;</span> + stringify(this)),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                                                reset_backoff(false), exit_on_error(_exit_on_error) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classRGWBackoffControlCR.html#aab2752f0edf42e879efd14de87967ed0">  150</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classRGWBackoffControlCR.html#aab2752f0edf42e879efd14de87967ed0">~RGWBackoffControlCR</a>() {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (cr) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      cr-&gt;put();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *<a class="code" href="classRGWBackoffControlCR.html#ab301c86dd81d7c54f52a89f77cbda2ae">alloc_cr</a>() = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classRGWBackoffControlCR.html#aab619fdb34b48f1c68a0e3b2ae9959e1">  157</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *<a class="code" href="classRGWBackoffControlCR.html#aab619fdb34b48f1c68a0e3b2ae9959e1">alloc_finisher_cr</a>() { <span class="keywordflow">return</span> NULL; }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWBackoffControlCR.html#ab8c0ff4d829bafad17e8f7cfb494e200">operate</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;};</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html">  162</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structRGWMetaSyncEnv.html">RGWMetaSyncEnv</a> {</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html#ab36b21aa854fe50e545bca25bd9dac3e">  163</a></span>&#160;  CephContext *<a class="code" href="structRGWMetaSyncEnv.html#ab36b21aa854fe50e545bca25bd9dac3e">cct</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html#a8064825477daed04afa31af7b610210c">  164</a></span>&#160;  <a class="code" href="classRGWRados.html">RGWRados</a> *<a class="code" href="structRGWMetaSyncEnv.html#a8064825477daed04afa31af7b610210c">store</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html#a034788325c9dc0088cf04e3a62146669">  165</a></span>&#160;  <a class="code" href="classRGWRESTConn.html">RGWRESTConn</a> *<a class="code" href="structRGWMetaSyncEnv.html#a034788325c9dc0088cf04e3a62146669">conn</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html#a82b0822d252abc47a0b7681e7b7a4e65">  166</a></span>&#160;  <a class="code" href="classRGWAsyncRadosProcessor.html">RGWAsyncRadosProcessor</a> *<a class="code" href="structRGWMetaSyncEnv.html#a82b0822d252abc47a0b7681e7b7a4e65">async_rados</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html#a678a49079b9bf662f9fd428173d486d2">  167</a></span>&#160;  <a class="code" href="classRGWHTTPManager.html">RGWHTTPManager</a> *<a class="code" href="structRGWMetaSyncEnv.html#a678a49079b9bf662f9fd428173d486d2">http_manager</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html#a9fffe3b3b8990e0054de4b4af1e512ad">  168</a></span>&#160;  <a class="code" href="classRGWSyncErrorLogger.html">RGWSyncErrorLogger</a> *<a class="code" href="structRGWMetaSyncEnv.html#a9fffe3b3b8990e0054de4b4af1e512ad">error_logger</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structRGWMetaSyncEnv.html#a0256044ec0fc7ba52d6360afc151321b">  170</a></span>&#160;  <a class="code" href="structRGWMetaSyncEnv.html#a0256044ec0fc7ba52d6360afc151321b">RGWMetaSyncEnv</a>() : <a class="code" href="structRGWMetaSyncEnv.html#ab36b21aa854fe50e545bca25bd9dac3e">cct</a>(NULL), <a class="code" href="structRGWMetaSyncEnv.html#a8064825477daed04afa31af7b610210c">store</a>(NULL), <a class="code" href="structRGWMetaSyncEnv.html#a034788325c9dc0088cf04e3a62146669">conn</a>(NULL), <a class="code" href="structRGWMetaSyncEnv.html#a82b0822d252abc47a0b7681e7b7a4e65">async_rados</a>(NULL), <a class="code" href="structRGWMetaSyncEnv.html#a678a49079b9bf662f9fd428173d486d2">http_manager</a>(NULL), <a class="code" href="structRGWMetaSyncEnv.html#a9fffe3b3b8990e0054de4b4af1e512ad">error_logger</a>(NULL) {}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structRGWMetaSyncEnv.html#ad2e54643dd54cc013a411291f54bea2a">init</a>(CephContext *_cct, <a class="code" href="classRGWRados.html">RGWRados</a> *_store, <a class="code" href="classRGWRESTConn.html">RGWRESTConn</a> *_conn,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="classRGWAsyncRadosProcessor.html">RGWAsyncRadosProcessor</a> *_async_rados, <a class="code" href="classRGWHTTPManager.html">RGWHTTPManager</a> *_http_manager,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="classRGWSyncErrorLogger.html">RGWSyncErrorLogger</a> *_error_logger);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structRGWMetaSyncEnv.html#ac372e8cc10cda802d7b2f33374a467ca">shard_obj_name</a>(<span class="keywordtype">int</span> shard_id);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">string</span> <a class="code" href="structRGWMetaSyncEnv.html#acb3600306dd508fb378174f061ad64dc">status_oid</a>();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;};</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="classRGWRemoteMetaLog.html">  180</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWRemoteMetaLog.html">RGWRemoteMetaLog</a> : <span class="keyword">public</span> <a class="code" href="classRGWCoroutinesManager.html">RGWCoroutinesManager</a> {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="classRGWRados.html">RGWRados</a> *store;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="classRGWRESTConn.html">RGWRESTConn</a> *conn;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="classRGWAsyncRadosProcessor.html">RGWAsyncRadosProcessor</a> *async_rados;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="classRGWHTTPManager.html">RGWHTTPManager</a> http_manager;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="classRGWMetaSyncStatusManager.html">RGWMetaSyncStatusManager</a> *status_manager;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="classRGWSyncErrorLogger.html">RGWSyncErrorLogger</a> *error_logger;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="classRGWMetaSyncCR.html">RGWMetaSyncCR</a> *meta_sync_cr;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="classRGWSyncBackoff.html">RGWSyncBackoff</a> backoff;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="structRGWMetaSyncEnv.html">RGWMetaSyncEnv</a> sync_env;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="structrgw__meta__sync__status.html">rgw_meta_sync_status</a> sync_status;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">void</span> init_sync_env(<a class="code" href="structRGWMetaSyncEnv.html">RGWMetaSyncEnv</a> *env);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">int</span> store_sync_info();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  atomic_t going_down;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classRGWRemoteMetaLog.html#a1841c2d05cc9f1414b7794917ecacc93">  202</a></span>&#160;  <a class="code" href="classRGWRemoteMetaLog.html#a1841c2d05cc9f1414b7794917ecacc93">RGWRemoteMetaLog</a>(<a class="code" href="classRGWRados.html">RGWRados</a> *_store, <a class="code" href="classRGWAsyncRadosProcessor.html">RGWAsyncRadosProcessor</a> *async_rados,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                   <a class="code" href="classRGWMetaSyncStatusManager.html">RGWMetaSyncStatusManager</a> *_sm)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    : <a class="code" href="classRGWCoroutinesManager.html">RGWCoroutinesManager</a>(_store-&gt;ctx(), _store-&gt;get_cr_registry()),</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      store(_store), conn(NULL), async_rados(async_rados),</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      http_manager(store-&gt;ctx(), <a class="code" href="classRGWCoroutinesManager.html#a9e364706fc5260610c3a6bdb474ed20c">completion_mgr</a>),</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      status_manager(_sm), error_logger(NULL), meta_sync_cr(NULL) {}</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="classRGWRemoteMetaLog.html#a0a28df5f54cec1d8a409c41414fdbdd5">~RGWRemoteMetaLog</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWRemoteMetaLog.html#a8ab8b3b9a62246c7c2b9e598fecf8d04">init</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWRemoteMetaLog.html#a03e4077e1b6ed29c80edffb38ec0dc9d">finish</a>();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWRemoteMetaLog.html#ac7ae06ab8af94c05d1dd9ebd69a26386">read_log_info</a>(<a class="code" href="structrgw__mdlog__info.html">rgw_mdlog_info</a> *log_info);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWRemoteMetaLog.html#ae2ee296e7ae669954461d8b5f22082ef">read_master_log_shards_info</a>(<span class="keywordtype">string</span> *master_period, map&lt;int, RGWMetadataLogInfo&gt; *shards_info);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWRemoteMetaLog.html#a545796f9e9f57cfc6dbe22d95a5d3963">read_master_log_shards_next</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; period, map&lt;int, string&gt; shard_markers, map&lt;int, rgw_mdlog_shard_data&gt; *result);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWRemoteMetaLog.html#a251e3254f1b04cf05198c920b6c82e67">read_sync_status</a>();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWRemoteMetaLog.html#a842b032364af446eede23ce08d0df51a">init_sync_status</a>();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWRemoteMetaLog.html#a082ba1797f7020d525b535c9318d1f40">run_sync</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWRemoteMetaLog.html#ad12a06e230da26ed8042b2071c009c21">wakeup</a>(<span class="keywordtype">int</span> shard_id);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classRGWRemoteMetaLog.html#a5d6446d0a5aa49dc670de3b3b7b10137">  223</a></span>&#160;  <a class="code" href="structRGWMetaSyncEnv.html">RGWMetaSyncEnv</a>&amp; <a class="code" href="classRGWRemoteMetaLog.html#a5d6446d0a5aa49dc670de3b3b7b10137">get_sync_env</a>() {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">return</span> sync_env;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classRGWRemoteMetaLog.html#a1537d831c6aeb7932713264c240306bc">  226</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structrgw__meta__sync__status.html">rgw_meta_sync_status</a>&amp; <a class="code" href="classRGWRemoteMetaLog.html#a1537d831c6aeb7932713264c240306bc">get_sync_status</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> sync_status; }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;};</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html">  229</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWMetaSyncStatusManager.html">RGWMetaSyncStatusManager</a> {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classRGWRados.html">RGWRados</a> *store;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  librados::IoCtx ioctx;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="classRGWRemoteMetaLog.html">RGWRemoteMetaLog</a> master_log;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  map&lt;int, rgw_obj&gt; shard_objs;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">struct </span>utime_shard {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    real_time ts;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">int</span> shard_id;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    utime_shard() : shard_id(-1) {}</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="rgw__period__history_8cc.html#a87fecb8346f3d2a9a43ffde857510439">operator&lt;</a>(<span class="keyword">const</span> utime_shard&amp; rhs)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">if</span> (ts == rhs.ts) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> shard_id &lt; rhs.shard_id;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">return</span> ts &lt; rhs.ts;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  };</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  RWLock ts_to_shard_lock;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  map&lt;utime_shard, int&gt; ts_to_shard;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  vector&lt;string&gt; clone_markers;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#a8ac58a8d9adfbfb4e4605f3ec6576f1e">  256</a></span>&#160;  <a class="code" href="classRGWMetaSyncStatusManager.html#a8ac58a8d9adfbfb4e4605f3ec6576f1e">RGWMetaSyncStatusManager</a>(<a class="code" href="classRGWRados.html">RGWRados</a> *_store, <a class="code" href="classRGWAsyncRadosProcessor.html">RGWAsyncRadosProcessor</a> *async_rados)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    : store(_store), master_log(store, async_rados, this),</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      ts_to_shard_lock(<span class="stringliteral">&quot;ts_to_shard_lock&quot;</span>) {}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncStatusManager.html#a4f66865fa87b3c928cb0fd7c58d241b2">init</a>();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWMetaSyncStatusManager.html#aec4ffa80f2f98eacbd15fded65fe9e00">finish</a>();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#ac4860c07e28660236bf952c5d7da0f77">  262</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structrgw__meta__sync__status.html">rgw_meta_sync_status</a>&amp; <a class="code" href="classRGWMetaSyncStatusManager.html#ac4860c07e28660236bf952c5d7da0f77">get_sync_status</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#a1537d831c6aeb7932713264c240306bc">get_sync_status</a>();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#a5ab7d11cd2a7e44a7fef6496c05f779f">  266</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncStatusManager.html#a5ab7d11cd2a7e44a7fef6496c05f779f">read_sync_status</a>() { <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#a251e3254f1b04cf05198c920b6c82e67">read_sync_status</a>(); }</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#a2a9c091783bfcf6aa51d092cb1cefba2">  267</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncStatusManager.html#a2a9c091783bfcf6aa51d092cb1cefba2">init_sync_status</a>() { <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#a842b032364af446eede23ce08d0df51a">init_sync_status</a>(); }</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#a85717dc25c793ebbfb6ada2a49c55088">  268</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncStatusManager.html#a85717dc25c793ebbfb6ada2a49c55088">read_log_info</a>(<a class="code" href="structrgw__mdlog__info.html">rgw_mdlog_info</a> *log_info) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#ac7ae06ab8af94c05d1dd9ebd69a26386">read_log_info</a>(log_info);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#a01f1edc75af2cea7dcd20e38c24c5bb0">  271</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncStatusManager.html#a01f1edc75af2cea7dcd20e38c24c5bb0">read_master_log_shards_info</a>(<span class="keywordtype">string</span> *master_period, map&lt;int, RGWMetadataLogInfo&gt; *shards_info) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#ae2ee296e7ae669954461d8b5f22082ef">read_master_log_shards_info</a>(master_period, shards_info);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#aeda4b9d5c33fc9be11cd4313d2af410a">  274</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncStatusManager.html#aeda4b9d5c33fc9be11cd4313d2af410a">read_master_log_shards_next</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; period, map&lt;int, string&gt; shard_markers, map&lt;int, rgw_mdlog_shard_data&gt; *result) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#a545796f9e9f57cfc6dbe22d95a5d3963">read_master_log_shards_next</a>(period, shard_markers, result);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#ad4f98c7c1475cd8281fd890cf29050aa">  278</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncStatusManager.html#ad4f98c7c1475cd8281fd890cf29050aa">run</a>() { <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#a082ba1797f7020d525b535c9318d1f40">run_sync</a>(); }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#a421b83fa18e936e50413085495b89d1c">  280</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWMetaSyncStatusManager.html#a421b83fa18e936e50413085495b89d1c">wakeup</a>(<span class="keywordtype">int</span> shard_id) { <span class="keywordflow">return</span> master_log.<a class="code" href="classRGWRemoteMetaLog.html#ad12a06e230da26ed8042b2071c009c21">wakeup</a>(shard_id); }</div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classRGWMetaSyncStatusManager.html#a09e7d7e861cb968355de446bd88049f8">  281</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWMetaSyncStatusManager.html#a09e7d7e861cb968355de446bd88049f8">stop</a>() {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    master_log.<a class="code" href="classRGWRemoteMetaLog.html#a03e4077e1b6ed29c80edffb38ec0dc9d">finish</a>();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;};</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">class</span> K&gt;</div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html">  287</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWSyncShardMarkerTrack.html">RGWSyncShardMarkerTrack</a> {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">struct </span>marker_entry {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    uint64_t pos;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    real_time timestamp;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    marker_entry() : pos(0) {}</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    marker_entry(uint64_t _p, <span class="keyword">const</span> real_time&amp; _ts) : pos(_p), timestamp(_ts) {}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  };</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keyword">typename</span> std::map&lt;T, marker_entry&gt; pending;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  T high_marker;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  T last_stored_marker;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  marker_entry high_entry;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordtype">int</span> window_size;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordtype">int</span> updates_since_flush;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#adcee13a7b8f735fba5925c6e0e2d943b">  306</a></span>&#160;  <span class="keyword">typename</span> std::set&lt;K&gt; <a class="code" href="classRGWSyncShardMarkerTrack.html#adcee13a7b8f735fba5925c6e0e2d943b">need_retry_set</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *<a class="code" href="classRGWSyncShardMarkerTrack.html#a7378881fa6fe8576269217d32b21fb69">store_marker</a>(<span class="keyword">const</span> T&amp; new_marker, uint64_t index_pos, <span class="keyword">const</span> real_time&amp; timestamp) = 0;</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#ac2514c7bc7018ccac2bb09557b22676d">  309</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#ac2514c7bc7018ccac2bb09557b22676d">handle_finish</a>(<span class="keyword">const</span> T&amp; marker) { }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#a15090bb298fb98264dba0461f80f12f8">  312</a></span>&#160;  <a class="code" href="classRGWSyncShardMarkerTrack.html#a15090bb298fb98264dba0461f80f12f8">RGWSyncShardMarkerTrack</a>(<span class="keywordtype">int</span> _window_size) : window_size(_window_size), updates_since_flush(0) {}</div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#aa56b590fe80f90970088ecedbe605e62">  313</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#aa56b590fe80f90970088ecedbe605e62">~RGWSyncShardMarkerTrack</a>() {}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#a9d4d9da2f1e61d999c3404f4ca89aa30">  315</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#a9d4d9da2f1e61d999c3404f4ca89aa30">start</a>(<span class="keyword">const</span> T&amp; pos, <span class="keywordtype">int</span> index_pos, <span class="keyword">const</span> real_time&amp; timestamp) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span> (pending.find(pos) != pending.end()) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    pending[pos] = marker_entry(index_pos, timestamp);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#a70583af62d15501b2cdb7b70c4b375b9">  323</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#a70583af62d15501b2cdb7b70c4b375b9">try_update_high_marker</a>(<span class="keyword">const</span> T&amp; pos, <span class="keywordtype">int</span> index_pos, <span class="keyword">const</span> real_time&amp; timestamp) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (!(pos &lt;= high_marker)) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      high_marker = pos;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      high_entry = marker_entry(index_pos, timestamp);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#a9beb9d830ceed7db32a9324c7dec1267">  330</a></span>&#160;  <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *<a class="code" href="classRGWSyncShardMarkerTrack.html#a9beb9d830ceed7db32a9324c7dec1267">finish</a>(<span class="keyword">const</span> T&amp; pos) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (pending.empty()) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">/* can happen, due to a bug that ended up with multiple objects with the same name and version</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">       * -- which can happen when versioning is enabled an the version is &#39;null&#39;.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keyword">typename</span> std::map&lt;T, marker_entry&gt;::iterator iter = pending.begin();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">bool</span> is_first = (pos == iter-&gt;first);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keyword">typename</span> std::map&lt;T, marker_entry&gt;::iterator pos_iter = pending.find(pos);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> (pos_iter == pending.end()) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="comment">/* see pending.empty() comment */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> (!(pos &lt;= high_marker)) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      high_marker = pos;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      high_entry = pos_iter-&gt;second;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    pending.erase(pos);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="classRGWSyncShardMarkerTrack.html#ac2514c7bc7018ccac2bb09557b22676d">handle_finish</a>(pos);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    updates_since_flush++;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> (is_first &amp;&amp; (updates_since_flush &gt;= window_size || pending.empty())) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#abecf44d5f05178ee7858639c94a75adb">flush</a>();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#abecf44d5f05178ee7858639c94a75adb">  365</a></span>&#160;  <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> *<a class="code" href="classRGWSyncShardMarkerTrack.html#abecf44d5f05178ee7858639c94a75adb">flush</a>() {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (last_stored_marker == high_marker) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    updates_since_flush = 0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    last_stored_marker = high_marker;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#a7378881fa6fe8576269217d32b21fb69">store_marker</a>(high_marker, high_entry.pos, high_entry.timestamp);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">   * a key needs retry if it was processing when another marker that points</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">   * to the same bucket shards arrives. Instead of processing it, we mark</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">   * it as need_retry so that when we finish processing the original, we</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">   * retry the processing on the same bucket shard, in case there are more</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">   * entries to process. This closes a race that can happen.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#a177041a806d1c259db43c9ad5eb40bae">  382</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#a177041a806d1c259db43c9ad5eb40bae">need_retry</a>(<span class="keyword">const</span> K&amp; key) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classRGWSyncShardMarkerTrack.html#adcee13a7b8f735fba5925c6e0e2d943b">need_retry_set</a>.find(key) != <a class="code" href="classRGWSyncShardMarkerTrack.html#adcee13a7b8f735fba5925c6e0e2d943b">need_retry_set</a>.end());</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#ae16d9bbeef29b0e40aac79a38dec8e46">  386</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#ae16d9bbeef29b0e40aac79a38dec8e46">set_need_retry</a>(<span class="keyword">const</span> K&amp; key) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="classRGWSyncShardMarkerTrack.html#adcee13a7b8f735fba5925c6e0e2d943b">need_retry_set</a>.insert(key);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="classRGWSyncShardMarkerTrack.html#ae74759309bf7739b77fa187f52b3f251">  390</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRGWSyncShardMarkerTrack.html#ae74759309bf7739b77fa187f52b3f251">reset_need_retry</a>(<span class="keyword">const</span> K&amp; key) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="classRGWSyncShardMarkerTrack.html#adcee13a7b8f735fba5925c6e0e2d943b">need_retry_set</a>.erase(key);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;};</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keyword">class </span><a class="code" href="classRGWMetaSyncShardMarkerTrack.html">RGWMetaSyncShardMarkerTrack</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classRGWMetaSyncSingleEntryCR.html">  397</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWMetaSyncSingleEntryCR.html">RGWMetaSyncSingleEntryCR</a> : <span class="keyword">public</span> <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="structRGWMetaSyncEnv.html">RGWMetaSyncEnv</a> *sync_env;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordtype">string</span> raw_key;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordtype">string</span> entry_marker;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="rgw__metadata_8h.html#af43317dbf8c164afb601da7ad1a76492">RGWMDLogStatus</a> op_status;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  ssize_t pos;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">string</span> section;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordtype">string</span> key;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordtype">int</span> sync_status;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  bufferlist md_bl;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="classRGWMetaSyncShardMarkerTrack.html">RGWMetaSyncShardMarkerTrack</a> *marker_tracker;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">int</span> tries;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classRGWMetaSyncSingleEntryCR.html#af9e6f91cc5864b81e81ac4ba68ebd008">  417</a></span>&#160;  <a class="code" href="classRGWMetaSyncSingleEntryCR.html#af9e6f91cc5864b81e81ac4ba68ebd008">RGWMetaSyncSingleEntryCR</a>(<a class="code" href="structRGWMetaSyncEnv.html">RGWMetaSyncEnv</a> *_sync_env,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; _raw_key, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; _entry_marker,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                           <span class="keyword">const</span> <a class="code" href="rgw__metadata_8h.html#af43317dbf8c164afb601da7ad1a76492">RGWMDLogStatus</a>&amp; _op_status,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                           <a class="code" href="classRGWMetaSyncShardMarkerTrack.html">RGWMetaSyncShardMarkerTrack</a> *_marker_tracker) : <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a>(_sync_env-&gt;<a class="code" href="classRGWCoroutine.html#a887e803a293aff88fd8d60003a73e50a">cct</a>),</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                                      sync_env(_sync_env),</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                              raw_key(_raw_key), entry_marker(_entry_marker),</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                                      op_status(_op_status),</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                                      pos(0), sync_status(0),</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                                      marker_tracker(_marker_tracker), tries(0) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWMetaSyncSingleEntryCR.html#ab963121b32a93a377a2b5b58e18396fd">operate</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;};</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="classRGWShardCollectCR.html">  431</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRGWShardCollectCR.html">RGWShardCollectCR</a> : <span class="keyword">public</span> <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a> {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">int</span> cur_shard;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordtype">int</span> current_running;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">int</span> max_concurrent;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordtype">int</span> status;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classRGWShardCollectCR.html#a6840f6a92761a822acf9715eddf4a22b">  438</a></span>&#160;  <a class="code" href="classRGWShardCollectCR.html#a6840f6a92761a822acf9715eddf4a22b">RGWShardCollectCR</a>(CephContext *_cct, <span class="keywordtype">int</span> _max_concurrent) : <a class="code" href="classRGWCoroutine.html">RGWCoroutine</a>(_cct),</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                                             current_running(0),</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                             max_concurrent(_max_concurrent),</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                             status(0) {}</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classRGWShardCollectCR.html#a5d4854348bb1ce4f07f55951e9a7a791">spawn_next</a>() = 0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classRGWShardCollectCR.html#ab740f298932cb4afb21dd016acf43d20">operate</a>();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;};</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="classRGWCoroutine_html_a887e803a293aff88fd8d60003a73e50a"><div class="ttname"><a href="classRGWCoroutine.html#a887e803a293aff88fd8d60003a73e50a">RGWCoroutine::cct</a></div><div class="ttdeci">CephContext * cct</div><div class="ttdef"><b>Definition:</b> rgw_coroutine.h:202</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_a177041a806d1c259db43c9ad5eb40bae"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#a177041a806d1c259db43c9ad5eb40bae">RGWSyncShardMarkerTrack::need_retry</a></div><div class="ttdeci">bool need_retry(const K &amp;key)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:382</div></div>
<div class="ttc" id="structrgw__mdlog__entry_html_adb8db94f8f2d38bb7fa9919e5ca7e37d"><div class="ttname"><a href="structrgw__mdlog__entry.html#adb8db94f8f2d38bb7fa9919e5ca7e37d">rgw_mdlog_entry::section</a></div><div class="ttdeci">string section</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:27</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a85717dc25c793ebbfb6ada2a49c55088"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a85717dc25c793ebbfb6ada2a49c55088">RGWMetaSyncStatusManager::read_log_info</a></div><div class="ttdeci">int read_log_info(rgw_mdlog_info *log_info)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:268</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a8ab8b3b9a62246c7c2b9e598fecf8d04"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a8ab8b3b9a62246c7c2b9e598fecf8d04">RGWRemoteMetaLog::init</a></div><div class="ttdeci">int init()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:273</div></div>
<div class="ttc" id="rgw__period__history_8cc_html_a87fecb8346f3d2a9a43ffde857510439"><div class="ttname"><a href="rgw__period__history_8cc.html#a87fecb8346f3d2a9a43ffde857510439">operator&lt;</a></div><div class="ttdeci">bool operator&lt;(const RGWPeriodHistory::History &amp;lhs, const RGWPeriodHistory::History &amp;rhs)</div><div class="ttdoc">value comparison for avl_set </div><div class="ttdef"><b>Definition:</b> rgw_period_history.cc:38</div></div>
<div class="ttc" id="classRGWShardCollectCR_html"><div class="ttname"><a href="classRGWShardCollectCR.html">RGWShardCollectCR</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:431</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_a9fffe3b3b8990e0054de4b4af1e512ad"><div class="ttname"><a href="structRGWMetaSyncEnv.html#a9fffe3b3b8990e0054de4b4af1e512ad">RGWMetaSyncEnv::error_logger</a></div><div class="ttdeci">RGWSyncErrorLogger * error_logger</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:168</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_a7378881fa6fe8576269217d32b21fb69"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#a7378881fa6fe8576269217d32b21fb69">RGWSyncShardMarkerTrack::store_marker</a></div><div class="ttdeci">virtual RGWCoroutine * store_marker(const T &amp;new_marker, uint64_t index_pos, const real_time &amp;timestamp)=0</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a1841c2d05cc9f1414b7794917ecacc93"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a1841c2d05cc9f1414b7794917ecacc93">RGWRemoteMetaLog::RGWRemoteMetaLog</a></div><div class="ttdeci">RGWRemoteMetaLog(RGWRados *_store, RGWAsyncRadosProcessor *async_rados, RGWMetaSyncStatusManager *_sm)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:202</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_ad4f98c7c1475cd8281fd890cf29050aa"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#ad4f98c7c1475cd8281fd890cf29050aa">RGWMetaSyncStatusManager::run</a></div><div class="ttdeci">int run()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:278</div></div>
<div class="ttc" id="rgw__http__client_8h_html"><div class="ttname"><a href="rgw__http__client_8h.html">rgw_http_client.h</a></div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_a15090bb298fb98264dba0461f80f12f8"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#a15090bb298fb98264dba0461f80f12f8">RGWSyncShardMarkerTrack::RGWSyncShardMarkerTrack</a></div><div class="ttdeci">RGWSyncShardMarkerTrack(int _window_size)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:312</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a4f66865fa87b3c928cb0fd7c58d241b2"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a4f66865fa87b3c928cb0fd7c58d241b2">RGWMetaSyncStatusManager::init</a></div><div class="ttdeci">int init()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:298</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_a799aea84e8d29d3c04d764ae630a20bc"><div class="ttname"><a href="structrgw__sync__error__info.html#a799aea84e8d29d3c04d764ae630a20bc">rgw_sync_error_info::rgw_sync_error_info</a></div><div class="ttdeci">rgw_sync_error_info(const string &amp;_source_zone, uint32_t _error_code, const string &amp;_message)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:82</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_a0256044ec0fc7ba52d6360afc151321b"><div class="ttname"><a href="structRGWMetaSyncEnv.html#a0256044ec0fc7ba52d6360afc151321b">RGWMetaSyncEnv::RGWMetaSyncEnv</a></div><div class="ttdeci">RGWMetaSyncEnv()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:170</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_ab301c86dd81d7c54f52a89f77cbda2ae"><div class="ttname"><a href="classRGWBackoffControlCR.html#ab301c86dd81d7c54f52a89f77cbda2ae">RGWBackoffControlCR::alloc_cr</a></div><div class="ttdeci">virtual RGWCoroutine * alloc_cr()=0</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_ac7ae06ab8af94c05d1dd9ebd69a26386"><div class="ttname"><a href="classRGWRemoteMetaLog.html#ac7ae06ab8af94c05d1dd9ebd69a26386">RGWRemoteMetaLog::read_log_info</a></div><div class="ttdeci">int read_log_info(rgw_mdlog_info *log_info)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:231</div></div>
<div class="ttc" id="structrgw__mdlog__shard__data_html_a04e6adb5011f524422b4b41f1a41c4da"><div class="ttname"><a href="structrgw__mdlog__shard__data.html#a04e6adb5011f524422b4b41f1a41c4da">rgw_mdlog_shard_data::marker</a></div><div class="ttdeci">string marker</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:50</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html">RGWSyncShardMarkerTrack</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:287</div></div>
<div class="ttc" id="rgw__metadata_8h_html_af43317dbf8c164afb601da7ad1a76492"><div class="ttname"><a href="rgw__metadata_8h.html#af43317dbf8c164afb601da7ad1a76492">RGWMDLogStatus</a></div><div class="ttdeci">RGWMDLogStatus</div><div class="ttdef"><b>Definition:</b> rgw_metadata.h:25</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_a70583af62d15501b2cdb7b70c4b375b9"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#a70583af62d15501b2cdb7b70c4b375b9">RGWSyncShardMarkerTrack::try_update_high_marker</a></div><div class="ttdeci">void try_update_high_marker(const T &amp;pos, int index_pos, const real_time &amp;timestamp)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:323</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_ae74759309bf7739b77fa187f52b3f251"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#ae74759309bf7739b77fa187f52b3f251">RGWSyncShardMarkerTrack::reset_need_retry</a></div><div class="ttdeci">void reset_need_retry(const K &amp;key)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:390</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_ad2e54643dd54cc013a411291f54bea2a"><div class="ttname"><a href="structRGWMetaSyncEnv.html#ad2e54643dd54cc013a411291f54bea2a">RGWMetaSyncEnv::init</a></div><div class="ttdeci">void init(CephContext *_cct, RGWRados *_store, RGWRESTConn *_conn, RGWAsyncRadosProcessor *_async_rados, RGWHTTPManager *_http_manager, RGWSyncErrorLogger *_error_logger)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:348</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_a775c931d605422bd41121c9c0f62a64d"><div class="ttname"><a href="structrgw__sync__error__info.html#a775c931d605422bd41121c9c0f62a64d">rgw_sync_error_info::error_code</a></div><div class="ttdeci">uint32_t error_code</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:78</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_aeda4b9d5c33fc9be11cd4313d2af410a"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#aeda4b9d5c33fc9be11cd4313d2af410a">RGWMetaSyncStatusManager::read_master_log_shards_next</a></div><div class="ttdeci">int read_master_log_shards_next(const string &amp;period, map&lt; int, string &gt; shard_markers, map&lt; int, rgw_mdlog_shard_data &gt; *result)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:274</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_ad12a06e230da26ed8042b2071c009c21"><div class="ttname"><a href="classRGWRemoteMetaLog.html#ad12a06e230da26ed8042b2071c009c21">RGWRemoteMetaLog::wakeup</a></div><div class="ttdeci">void wakeup(int shard_id)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:1989</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html"><div class="ttname"><a href="classRGWBackoffControlCR.html">RGWBackoffControlCR</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:122</div></div>
<div class="ttc" id="structrgw__mdlog__shard__data_html_ae6ec7f28f6c03a06a52da26831a5c69b"><div class="ttname"><a href="structrgw__mdlog__shard__data.html#ae6ec7f28f6c03a06a52da26831a5c69b">rgw_mdlog_shard_data::entries</a></div><div class="ttdeci">vector&lt; rgw_mdlog_entry &gt; entries</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:52</div></div>
<div class="ttc" id="classRGWSyncBackoff_html_abda29a06effd71d89e91796fa91b43c9"><div class="ttname"><a href="classRGWSyncBackoff.html#abda29a06effd71d89e91796fa91b43c9">RGWSyncBackoff::RGWSyncBackoff</a></div><div class="ttdeci">RGWSyncBackoff(int _max_secs=DEFAULT_BACKOFF_MAX)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:112</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_acb3600306dd508fb378174f061ad64dc"><div class="ttname"><a href="structRGWMetaSyncEnv.html#acb3600306dd508fb378174f061ad64dc">RGWMetaSyncEnv::status_oid</a></div><div class="ttdeci">string status_oid()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:359</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a03e4077e1b6ed29c80edffb38ec0dc9d"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a03e4077e1b6ed29c80edffb38ec0dc9d">RGWRemoteMetaLog::finish</a></div><div class="ttdeci">void finish()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:290</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a082ba1797f7020d525b535c9318d1f40"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a082ba1797f7020d525b535c9318d1f40">RGWRemoteMetaLog::run_sync</a></div><div class="ttdeci">int run_sync()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:1857</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_a485f8d93b0f1a22a3b526ab2c6206b79"><div class="ttname"><a href="structrgw__sync__error__info.html#a485f8d93b0f1a22a3b526ab2c6206b79">rgw_sync_error_info::decode</a></div><div class="ttdeci">void decode(bufferlist::iterator &amp;bl)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:92</div></div>
<div class="ttc" id="structrgw__mdlog__info_html"><div class="ttname"><a href="structrgw__mdlog__info.html">rgw_mdlog_info</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:14</div></div>
<div class="ttc" id="structRGWMetadataLogData_html"><div class="ttname"><a href="structRGWMetadataLogData.html">RGWMetadataLogData</a></div><div class="ttdef"><b>Definition:</b> rgw_metadata.h:212</div></div>
<div class="ttc" id="structrgw__mdlog__entry_html_af6fba6dde4817ee351007af26d393360"><div class="ttname"><a href="structrgw__mdlog__entry.html#af6fba6dde4817ee351007af26d393360">rgw_mdlog_entry::name</a></div><div class="ttdeci">string name</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:28</div></div>
<div class="ttc" id="structrgw__mdlog__shard__data_html"><div class="ttname"><a href="structrgw__mdlog__shard__data.html">rgw_mdlog_shard_data</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:49</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_ad9b27ba88ad33601ccdf833d83d92e9d"><div class="ttname"><a href="classRGWBackoffControlCR.html#ad9b27ba88ad33601ccdf833d83d92e9d">RGWBackoffControlCR::backoff_ptr</a></div><div class="ttdeci">bool * backoff_ptr()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:133</div></div>
<div class="ttc" id="structrgw__mdlog__entry_html_a61e00ec20a6a7c3ad481c1904b5a4ac1"><div class="ttname"><a href="structrgw__mdlog__entry.html#a61e00ec20a6a7c3ad481c1904b5a4ac1">rgw_mdlog_entry::timestamp</a></div><div class="ttdeci">ceph::real_time timestamp</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:29</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_abecf44d5f05178ee7858639c94a75adb"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#abecf44d5f05178ee7858639c94a75adb">RGWSyncShardMarkerTrack::flush</a></div><div class="ttdeci">RGWCoroutine * flush()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:365</div></div>
<div class="ttc" id="rgw__sync_8h_html_a56083ecd2aed60436aac0efea7f39408"><div class="ttname"><a href="rgw__sync_8h.html#a56083ecd2aed60436aac0efea7f39408">DEFAULT_BACKOFF_MAX</a></div><div class="ttdeci">#define DEFAULT_BACKOFF_MAX</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:104</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a01f1edc75af2cea7dcd20e38c24c5bb0"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a01f1edc75af2cea7dcd20e38c24c5bb0">RGWMetaSyncStatusManager::read_master_log_shards_info</a></div><div class="ttdeci">int read_master_log_shards_info(string *master_period, map&lt; int, RGWMetadataLogInfo &gt; *shards_info)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:271</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_ab36b21aa854fe50e545bca25bd9dac3e"><div class="ttname"><a href="structRGWMetaSyncEnv.html#ab36b21aa854fe50e545bca25bd9dac3e">RGWMetaSyncEnv::cct</a></div><div class="ttdeci">CephContext * cct</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:163</div></div>
<div class="ttc" id="structrgw__mdlog__info_html_a060e8fb92b63bb6997e97c2a4aa10eb6"><div class="ttname"><a href="structrgw__mdlog__info.html#a060e8fb92b63bb6997e97c2a4aa10eb6">rgw_mdlog_info::decode_json</a></div><div class="ttdeci">void decode_json(JSONObj *obj)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:123</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a5d6446d0a5aa49dc670de3b3b7b10137"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a5d6446d0a5aa49dc670de3b3b7b10137">RGWRemoteMetaLog::get_sync_env</a></div><div class="ttdeci">RGWMetaSyncEnv &amp; get_sync_env()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:223</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_a92fc5a77eeb26353ac474ee125070b85"><div class="ttname"><a href="structrgw__sync__error__info.html#a92fc5a77eeb26353ac474ee125070b85">rgw_sync_error_info::dump</a></div><div class="ttdeci">void dump(Formatter *f) const </div><div class="ttdef"><b>Definition:</b> rgw_json_enc.cc:1264</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_ac372e8cc10cda802d7b2f33374a467ca"><div class="ttname"><a href="structRGWMetaSyncEnv.html#ac372e8cc10cda802d7b2f33374a467ca">RGWMetaSyncEnv::shard_obj_name</a></div><div class="ttdeci">string shard_obj_name(int shard_id)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:364</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_af3286294ada2705450a9e8fbb3c7aa4d"><div class="ttname"><a href="classRGWBackoffControlCR.html#af3286294ada2705450a9e8fbb3c7aa4d">RGWBackoffControlCR::cr_lock</a></div><div class="ttdeci">Mutex &amp; cr_lock()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:137</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_a57762fd99b670d8862cbc7fb127ac569"><div class="ttname"><a href="structrgw__sync__error__info.html#a57762fd99b670d8862cbc7fb127ac569">rgw_sync_error_info::source_zone</a></div><div class="ttdeci">string source_zone</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:77</div></div>
<div class="ttc" id="classRGWRados_html"><div class="ttname"><a href="classRGWRados.html">RGWRados</a></div><div class="ttdef"><b>Definition:</b> rgw_rados.h:1702</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_ac4860c07e28660236bf952c5d7da0f77"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#ac4860c07e28660236bf952c5d7da0f77">RGWMetaSyncStatusManager::get_sync_status</a></div><div class="ttdeci">const rgw_meta_sync_status &amp; get_sync_status() const </div><div class="ttdef"><b>Definition:</b> rgw_sync.h:262</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a5ab7d11cd2a7e44a7fef6496c05f779f"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a5ab7d11cd2a7e44a7fef6496c05f779f">RGWMetaSyncStatusManager::read_sync_status</a></div><div class="ttdeci">int read_sync_status()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:266</div></div>
<div class="ttc" id="classRGWSyncErrorLogger_html"><div class="ttname"><a href="classRGWSyncErrorLogger.html">RGWSyncErrorLogger</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:62</div></div>
<div class="ttc" id="classRGWShardCollectCR_html_a5d4854348bb1ce4f07f55951e9a7a791"><div class="ttname"><a href="classRGWShardCollectCR.html#a5d4854348bb1ce4f07f55951e9a7a791">RGWShardCollectCR::spawn_next</a></div><div class="ttdeci">virtual bool spawn_next()=0</div></div>
<div class="ttc" id="structrgw__sync__error__info_html"><div class="ttname"><a href="structrgw__sync__error__info.html">rgw_sync_error_info</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:76</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a545796f9e9f57cfc6dbe22d95a5d3963"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a545796f9e9f57cfc6dbe22d95a5d3963">RGWRemoteMetaLog::read_master_log_shards_next</a></div><div class="ttdeci">int read_master_log_shards_next(const string &amp;period, map&lt; int, string &gt; shard_markers, map&lt; int, rgw_mdlog_shard_data &gt; *result)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:264</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_a2cd39bfeba7c7f3a47ff8a4fac1b1dfd"><div class="ttname"><a href="classRGWBackoffControlCR.html#a2cd39bfeba7c7f3a47ff8a4fac1b1dfd">RGWBackoffControlCR::RGWBackoffControlCR</a></div><div class="ttdeci">RGWBackoffControlCR(CephContext *_cct, bool _exit_on_error)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:146</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a421b83fa18e936e50413085495b89d1c"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a421b83fa18e936e50413085495b89d1c">RGWMetaSyncStatusManager::wakeup</a></div><div class="ttdeci">void wakeup(int shard_id)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:280</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_a82b0822d252abc47a0b7681e7b7a4e65"><div class="ttname"><a href="structRGWMetaSyncEnv.html#a82b0822d252abc47a0b7681e7b7a4e65">RGWMetaSyncEnv::async_rados</a></div><div class="ttdeci">RGWAsyncRadosProcessor * async_rados</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:166</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_a034788325c9dc0088cf04e3a62146669"><div class="ttname"><a href="structRGWMetaSyncEnv.html#a034788325c9dc0088cf04e3a62146669">RGWMetaSyncEnv::conn</a></div><div class="ttdeci">RGWRESTConn * conn</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:165</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_ae2ee296e7ae669954461d8b5f22082ef"><div class="ttname"><a href="classRGWRemoteMetaLog.html#ae2ee296e7ae669954461d8b5f22082ef">RGWRemoteMetaLog::read_master_log_shards_info</a></div><div class="ttdeci">int read_master_log_shards_info(string *master_period, map&lt; int, RGWMetadataLogInfo &gt; *shards_info)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:247</div></div>
<div class="ttc" id="classRGWSyncErrorLogger_html_a281db563c4c2a4063629cd6efa8a792e"><div class="ttname"><a href="classRGWSyncErrorLogger.html#a281db563c4c2a4063629cd6efa8a792e">RGWSyncErrorLogger::get_shard_oid</a></div><div class="ttdeci">static string get_shard_oid(const string &amp;oid_prefix, int shard_id)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:39</div></div>
<div class="ttc" id="classRGWMetaSyncSingleEntryCR_html"><div class="ttname"><a href="classRGWMetaSyncSingleEntryCR.html">RGWMetaSyncSingleEntryCR</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:397</div></div>
<div class="ttc" id="namespacergw_html_a12e768365595ed6aa121311114126794"><div class="ttname"><a href="namespacergw.html#a12e768365595ed6aa121311114126794">rgw::WRITE_CLASS_ENCODER</a></div><div class="ttdeci">WRITE_CLASS_ENCODER(fh_key)</div></div>
<div class="ttc" id="structrgw__mdlog__shard__data_html_ab77660b0c0d37723354b723798f45eb7"><div class="ttname"><a href="structrgw__mdlog__shard__data.html#ab77660b0c0d37723354b723798f45eb7">rgw_mdlog_shard_data::truncated</a></div><div class="ttdeci">bool truncated</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:51</div></div>
<div class="ttc" id="classRGWSyncBackoff_html_a291a4e6cd7598b8e29a245f3cc4c720d"><div class="ttname"><a href="classRGWSyncBackoff.html#a291a4e6cd7598b8e29a245f3cc4c720d">RGWSyncBackoff::backoff</a></div><div class="ttdeci">void backoff(RGWCoroutine *op)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:77</div></div>
<div class="ttc" id="classRGWMetaSyncSingleEntryCR_html_af9e6f91cc5864b81e81ac4ba68ebd008"><div class="ttname"><a href="classRGWMetaSyncSingleEntryCR.html#af9e6f91cc5864b81e81ac4ba68ebd008">RGWMetaSyncSingleEntryCR::RGWMetaSyncSingleEntryCR</a></div><div class="ttdeci">RGWMetaSyncSingleEntryCR(RGWMetaSyncEnv *_sync_env, const string &amp;_raw_key, const string &amp;_entry_marker, const RGWMDLogStatus &amp;_op_status, RGWMetaSyncShardMarkerTrack *_marker_tracker)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:417</div></div>
<div class="ttc" id="classRGWSyncBackoff_html_a020bd2076168bc4cd71ddeb59e2f0883"><div class="ttname"><a href="classRGWSyncBackoff.html#a020bd2076168bc4cd71ddeb59e2f0883">RGWSyncBackoff::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:115</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html"><div class="ttname"><a href="structRGWMetaSyncEnv.html">RGWMetaSyncEnv</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:162</div></div>
<div class="ttc" id="rgw__coroutine_8h_html"><div class="ttname"><a href="rgw__coroutine_8h.html">rgw_coroutine.h</a></div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html">RGWMetaSyncStatusManager</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:229</div></div>
<div class="ttc" id="structrgw__mdlog__entry_html"><div class="ttname"><a href="structrgw__mdlog__entry.html">rgw_mdlog_entry</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:25</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a1537d831c6aeb7932713264c240306bc"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a1537d831c6aeb7932713264c240306bc">RGWRemoteMetaLog::get_sync_status</a></div><div class="ttdeci">const rgw_meta_sync_status &amp; get_sync_status() const </div><div class="ttdef"><b>Definition:</b> rgw_sync.h:226</div></div>
<div class="ttc" id="classRGWCoroutinesManager_html"><div class="ttname"><a href="classRGWCoroutinesManager.html">RGWCoroutinesManager</a></div><div class="ttdef"><b>Definition:</b> rgw_coroutine.h:511</div></div>
<div class="ttc" id="classRGWSyncBackoff_html"><div class="ttname"><a href="classRGWSyncBackoff.html">RGWSyncBackoff</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:106</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_ae16d9bbeef29b0e40aac79a38dec8e46"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#ae16d9bbeef29b0e40aac79a38dec8e46">RGWSyncShardMarkerTrack::set_need_retry</a></div><div class="ttdeci">void set_need_retry(const K &amp;key)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:386</div></div>
<div class="ttc" id="structrgw__mdlog__entry_html_ad65316bffbb7be2c9f9b540d64a3e881"><div class="ttname"><a href="structrgw__mdlog__entry.html#ad65316bffbb7be2c9f9b540d64a3e881">rgw_mdlog_entry::log_data</a></div><div class="ttdeci">RGWMetadataLogData log_data</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:30</div></div>
<div class="ttc" id="classRGWShardCollectCR_html_ab740f298932cb4afb21dd016acf43d20"><div class="ttname"><a href="classRGWShardCollectCR.html#ab740f298932cb4afb21dd016acf43d20">RGWShardCollectCR::operate</a></div><div class="ttdeci">int operate()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:145</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_aab2752f0edf42e879efd14de87967ed0"><div class="ttname"><a href="classRGWBackoffControlCR.html#aab2752f0edf42e879efd14de87967ed0">RGWBackoffControlCR::~RGWBackoffControlCR</a></div><div class="ttdeci">virtual ~RGWBackoffControlCR()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:150</div></div>
<div class="ttc" id="classRGWRESTConn_html"><div class="ttname"><a href="classRGWRESTConn.html">RGWRESTConn</a></div><div class="ttdef"><b>Definition:</b> rgw_rest_conn.h:52</div></div>
<div class="ttc" id="structrgw__mdlog__info_html_a78eaf2d9281e102921792960af7113cd"><div class="ttname"><a href="structrgw__mdlog__info.html#a78eaf2d9281e102921792960af7113cd">rgw_mdlog_info::rgw_mdlog_info</a></div><div class="ttdeci">rgw_mdlog_info()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:19</div></div>
<div class="ttc" id="classRGWCoroutinesManager_html_a9e364706fc5260610c3a6bdb474ed20c"><div class="ttname"><a href="classRGWCoroutinesManager.html#a9e364706fc5260610c3a6bdb474ed20c">RGWCoroutinesManager::completion_mgr</a></div><div class="ttdeci">RGWCompletionManager * completion_mgr</div><div class="ttdef"><b>Definition:</b> rgw_coroutine.h:522</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_a576ba1c47839d1f631f4c89cabec414f"><div class="ttname"><a href="structrgw__sync__error__info.html#a576ba1c47839d1f631f4c89cabec414f">rgw_sync_error_info::message</a></div><div class="ttdeci">string message</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:79</div></div>
<div class="ttc" id="structrgw__mdlog__shard__data_html_a7927f7215a90352f4fd09064b253560f"><div class="ttname"><a href="structrgw__mdlog__shard__data.html#a7927f7215a90352f4fd09064b253560f">rgw_mdlog_shard_data::decode_json</a></div><div class="ttdeci">void decode_json(JSONObj *obj)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:139</div></div>
<div class="ttc" id="structrgw__mdlog__info_html_ae00078e5381c6420e1c6c7e71e57c66b"><div class="ttname"><a href="structrgw__mdlog__info.html#ae00078e5381c6420e1c6c7e71e57c66b">rgw_mdlog_info::num_shards</a></div><div class="ttdeci">uint32_t num_shards</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:15</div></div>
<div class="ttc" id="structrgw__mdlog__entry_html_a36d6229ab8550750a1ec3f5bedbdd5b7"><div class="ttname"><a href="structrgw__mdlog__entry.html#a36d6229ab8550750a1ec3f5bedbdd5b7">rgw_mdlog_entry::decode_json</a></div><div class="ttdeci">void decode_json(JSONObj *obj)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:129</div></div>
<div class="ttc" id="classRGWMetaSyncShardMarkerTrack_html"><div class="ttname"><a href="classRGWMetaSyncShardMarkerTrack.html">RGWMetaSyncShardMarkerTrack</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:1072</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a251e3254f1b04cf05198c920b6c82e67"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a251e3254f1b04cf05198c920b6c82e67">RGWRemoteMetaLog::read_sync_status</a></div><div class="ttdeci">int read_sync_status()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:1776</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_acbeafbfa48b529a6d23d45f0508369f5"><div class="ttname"><a href="structrgw__sync__error__info.html#acbeafbfa48b529a6d23d45f0508369f5">rgw_sync_error_info::encode</a></div><div class="ttdeci">void encode(bufferlist &amp;bl) const </div><div class="ttdef"><b>Definition:</b> rgw_sync.h:84</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_aa56b590fe80f90970088ecedbe605e62"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#aa56b590fe80f90970088ecedbe605e62">RGWSyncShardMarkerTrack::~RGWSyncShardMarkerTrack</a></div><div class="ttdeci">virtual ~RGWSyncShardMarkerTrack()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:313</div></div>
<div class="ttc" id="classRGWMetaSyncSingleEntryCR_html_ab963121b32a93a377a2b5b58e18396fd"><div class="ttname"><a href="classRGWMetaSyncSingleEntryCR.html#ab963121b32a93a377a2b5b58e18396fd">RGWMetaSyncSingleEntryCR::operate</a></div><div class="ttdeci">int operate()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:1104</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a0a28df5f54cec1d8a409c41414fdbdd5"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a0a28df5f54cec1d8a409c41414fdbdd5">RGWRemoteMetaLog::~RGWRemoteMetaLog</a></div><div class="ttdeci">~RGWRemoteMetaLog()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:226</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a8ac58a8d9adfbfb4e4605f3ec6576f1e"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a8ac58a8d9adfbfb4e4605f3ec6576f1e">RGWMetaSyncStatusManager::RGWMetaSyncStatusManager</a></div><div class="ttdeci">RGWMetaSyncStatusManager(RGWRados *_store, RGWAsyncRadosProcessor *async_rados)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:256</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_aab619fdb34b48f1c68a0e3b2ae9959e1"><div class="ttname"><a href="classRGWBackoffControlCR.html#aab619fdb34b48f1c68a0e3b2ae9959e1">RGWBackoffControlCR::alloc_finisher_cr</a></div><div class="ttdeci">virtual RGWCoroutine * alloc_finisher_cr()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:157</div></div>
<div class="ttc" id="classRGWCoroutine_html"><div class="ttname"><a href="classRGWCoroutine.html">RGWCoroutine</a></div><div class="ttdef"><b>Definition:</b> rgw_coroutine.h:167</div></div>
<div class="ttc" id="structrgw__mdlog__info_html_a3ce669afd4c4b9706abe8b4b6b7d8ea4"><div class="ttname"><a href="structrgw__mdlog__info.html#a3ce669afd4c4b9706abe8b4b6b7d8ea4">rgw_mdlog_info::period</a></div><div class="ttdeci">std::string period</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:16</div></div>
<div class="ttc" id="classRGWAsyncRadosProcessor_html"><div class="ttname"><a href="classRGWAsyncRadosProcessor.html">RGWAsyncRadosProcessor</a></div><div class="ttdef"><b>Definition:</b> rgw_cr_rados.h:55</div></div>
<div class="ttc" id="structrgw__mdlog__info_html_a66b8a82bece2c17d28259af23e311518"><div class="ttname"><a href="structrgw__mdlog__info.html#a66b8a82bece2c17d28259af23e311518">rgw_mdlog_info::realm_epoch</a></div><div class="ttdeci">epoch_t realm_epoch</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:17</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a09e7d7e861cb968355de446bd88049f8"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a09e7d7e861cb968355de446bd88049f8">RGWMetaSyncStatusManager::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:281</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_adcee13a7b8f735fba5925c6e0e2d943b"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#adcee13a7b8f735fba5925c6e0e2d943b">RGWSyncShardMarkerTrack::need_retry_set</a></div><div class="ttdeci">std::set&lt; K &gt; need_retry_set</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:306</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html"><div class="ttname"><a href="classRGWRemoteMetaLog.html">RGWRemoteMetaLog</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.h:180</div></div>
<div class="ttc" id="classRGWRemoteMetaLog_html_a842b032364af446eede23ce08d0df51a"><div class="ttname"><a href="classRGWRemoteMetaLog.html#a842b032364af446eede23ce08d0df51a">RGWRemoteMetaLog::init_sync_status</a></div><div class="ttdeci">int init_sync_status()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:1785</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_ae70793f9973a01e39a10bb08aaad1992"><div class="ttname"><a href="classRGWBackoffControlCR.html#ae70793f9973a01e39a10bb08aaad1992">RGWBackoffControlCR::get_cr</a></div><div class="ttdeci">RGWCoroutine * get_cr()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:141</div></div>
<div class="ttc" id="classRGWMetaSyncCR_html"><div class="ttname"><a href="classRGWMetaSyncCR.html">RGWMetaSyncCR</a></div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:1658</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_a8064825477daed04afa31af7b610210c"><div class="ttname"><a href="structRGWMetaSyncEnv.html#a8064825477daed04afa31af7b610210c">RGWMetaSyncEnv::store</a></div><div class="ttdeci">RGWRados * store</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:164</div></div>
<div class="ttc" id="classRGWSyncErrorLogger_html_a44381312efbc6f5508c3fc3ee350c173"><div class="ttname"><a href="classRGWSyncErrorLogger.html#a44381312efbc6f5508c3fc3ee350c173">RGWSyncErrorLogger::RGWSyncErrorLogger</a></div><div class="ttdeci">RGWSyncErrorLogger(RGWRados *_store, const string oid_prefix, int _num_shards)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:34</div></div>
<div class="ttc" id="classRGWBackoffControlCR_html_ab8c0ff4d829bafad17e8f7cfb494e200"><div class="ttname"><a href="classRGWBackoffControlCR.html#ab8c0ff4d829bafad17e8f7cfb494e200">RGWBackoffControlCR::operate</a></div><div class="ttdeci">int operate()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:83</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_a2a9c091783bfcf6aa51d092cb1cefba2"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#a2a9c091783bfcf6aa51d092cb1cefba2">RGWMetaSyncStatusManager::init_sync_status</a></div><div class="ttdeci">int init_sync_status()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:267</div></div>
<div class="ttc" id="structrgw__mdlog__entry_html_adc212a6925d27bbc7442722e48cbf2f2"><div class="ttname"><a href="structrgw__mdlog__entry.html#adc212a6925d27bbc7442722e48cbf2f2">rgw_mdlog_entry::convert_from</a></div><div class="ttdeci">bool convert_from(cls_log_entry &amp;le)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:34</div></div>
<div class="ttc" id="structRGWMetaSyncEnv_html_a678a49079b9bf662f9fd428173d486d2"><div class="ttname"><a href="structRGWMetaSyncEnv.html#a678a49079b9bf662f9fd428173d486d2">RGWMetaSyncEnv::http_manager</a></div><div class="ttdeci">RGWHTTPManager * http_manager</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:167</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_a9d4d9da2f1e61d999c3404f4ca89aa30"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#a9d4d9da2f1e61d999c3404f4ca89aa30">RGWSyncShardMarkerTrack::start</a></div><div class="ttdeci">bool start(const T &amp;pos, int index_pos, const real_time &amp;timestamp)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:315</div></div>
<div class="ttc" id="structrgw__meta__sync__status_html"><div class="ttname"><a href="structrgw__meta__sync__status.html">rgw_meta_sync_status</a></div><div class="ttdef"><b>Definition:</b> rgw_meta_sync_status.h:88</div></div>
<div class="ttc" id="classRGWShardCollectCR_html_a6840f6a92761a822acf9715eddf4a22b"><div class="ttname"><a href="classRGWShardCollectCR.html#a6840f6a92761a822acf9715eddf4a22b">RGWShardCollectCR::RGWShardCollectCR</a></div><div class="ttdeci">RGWShardCollectCR(CephContext *_cct, int _max_concurrent)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:438</div></div>
<div class="ttc" id="classRGWSyncBackoff_html_aa793435b1d97fcaabbbc48a55e32e55a"><div class="ttname"><a href="classRGWSyncBackoff.html#aa793435b1d97fcaabbbc48a55e32e55a">RGWSyncBackoff::backoff_sleep</a></div><div class="ttdeci">void backoff_sleep()</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:71</div></div>
<div class="ttc" id="classRGWHTTPManager_html"><div class="ttname"><a href="classRGWHTTPManager.html">RGWHTTPManager</a></div><div class="ttdef"><b>Definition:</b> rgw_http_client.h:217</div></div>
<div class="ttc" id="rgw__meta__sync__status_8h_html"><div class="ttname"><a href="rgw__meta__sync__status_8h.html">rgw_meta_sync_status.h</a></div></div>
<div class="ttc" id="structrgw__mdlog__entry_html_a0d77c495d9f15ca9ba2ef6986a17d4db"><div class="ttname"><a href="structrgw__mdlog__entry.html#a0d77c495d9f15ca9ba2ef6986a17d4db">rgw_mdlog_entry::id</a></div><div class="ttdeci">string id</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:26</div></div>
<div class="ttc" id="structrgw__sync__error__info_html_a3c10ea59979278a73429642d477643a3"><div class="ttname"><a href="structrgw__sync__error__info.html#a3c10ea59979278a73429642d477643a3">rgw_sync_error_info::rgw_sync_error_info</a></div><div class="ttdeci">rgw_sync_error_info()</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:81</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_a9beb9d830ceed7db32a9324c7dec1267"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#a9beb9d830ceed7db32a9324c7dec1267">RGWSyncShardMarkerTrack::finish</a></div><div class="ttdeci">RGWCoroutine * finish(const T &amp;pos)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:330</div></div>
<div class="ttc" id="classRGWMetaSyncStatusManager_html_aec4ffa80f2f98eacbd15fded65fe9e00"><div class="ttname"><a href="classRGWMetaSyncStatusManager.html#aec4ffa80f2f98eacbd15fded65fe9e00">RGWMetaSyncStatusManager::finish</a></div><div class="ttdeci">void finish()</div></div>
<div class="ttc" id="classRGWSyncErrorLogger_html_a0657e1a2467ac4d6798826ad3e071581"><div class="ttname"><a href="classRGWSyncErrorLogger.html#a0657e1a2467ac4d6798826ad3e071581">RGWSyncErrorLogger::log_error_cr</a></div><div class="ttdeci">RGWCoroutine * log_error_cr(const string &amp;source_zone, const string &amp;section, const string &amp;name, uint32_t error_code, const string &amp;message)</div><div class="ttdef"><b>Definition:</b> rgw_sync.cc:45</div></div>
<div class="ttc" id="classRGWSyncShardMarkerTrack_html_ac2514c7bc7018ccac2bb09557b22676d"><div class="ttname"><a href="classRGWSyncShardMarkerTrack.html#ac2514c7bc7018ccac2bb09557b22676d">RGWSyncShardMarkerTrack::handle_finish</a></div><div class="ttdeci">virtual void handle_finish(const T &amp;marker)</div><div class="ttdef"><b>Definition:</b> rgw_sync.h:309</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 14 2016 21:41:39 for Ceph RADOS Gateway by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
