<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Ceph RADOS Gateway: rgw_file.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ceph RADOS Gateway
   &#160;<span id="projectnumber">54b6c99f8f191958919a1d08a57b4bbad18ba57a</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">rgw_file.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rgw__file_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// -*- mode:C++; tab-width:8; c-basic-offset:2; indent-tabs-mode:t -*-</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// vim: ts=8 sw=2 smarttab</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifndef RGW_FILE_H</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define RGW_FILE_H</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;include/rados/rgw_file.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* internal header */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;mutex&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;deque&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;boost/intrusive_ptr.hpp&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;boost/range/adaptor/reversed.hpp&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;boost/container/flat_map.hpp&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;boost/variant.hpp&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;boost/utility/string_ref.hpp&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;xxhash.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;include/buffer.h&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;common/sstring.hh&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;common/cohort_lru.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__common_8h.html">rgw_common.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__user_8h.html">rgw_user.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__lib_8h.html">rgw_lib.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__ldap_8h.html">rgw_ldap.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rgw__token_8h.html">rgw_token.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/* XXX</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * ASSERT_H somehow not defined after all the above (which bring</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * in common/debug.h [e.g., dout])</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;include/assert.h&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="rgw__file_8h.html#a34de3d25465d88a39b97eee7882d3379">   45</a></span>&#160;<span class="preprocessor">#define RGW_RWXMODE  (S_IRWXU | S_IRWXG | S_IRWXO)</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="rgw__file_8h.html#abae3672cba958af452662b56b8ddcb0a">   47</a></span>&#160;<span class="preprocessor">#define RGW_RWMODE (RGW_RWXMODE &amp;           \</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">              ~(S_IXUSR | S_IXGRP | S_IXOTH))</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">namespace </span>rgw {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespacergw.html#a5733d80369bdc151f8f734905770a1f3">   54</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacergw.html#a5733d80369bdc151f8f734905770a1f3">ignore</a>(T &amp;&amp;) {}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">namespace </span>bi = boost::intrusive;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keyword">class </span>RGWLibFS;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">class </span>RGWFileHandle;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">class </span>RGWWriteRequest;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">   * XXX</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">   * The current 64-bit, non-cryptographic hash used here is intended</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">   * for prototyping only.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">   * However, the invariant being prototyped is that objects be</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">   * identifiable by their hash components alone.  We believe this can</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">   * be legitimately implemented using 128-hash values for bucket and</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">   * object components, together with a cluster-resident cryptographic</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">   * key.  Since an MD5 or SHA-1 key is 128 bits and the (fast),</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">   * non-cryptographic CityHash128 hash algorithm takes a 128-bit seed,</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">   * speculatively we could use that for the final hash computations.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html">   76</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structrgw_1_1fh__key.html">fh_key</a></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  {</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">   78</a></span>&#160;    rgw_fh_hk <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">   80</a></span>&#160;    <span class="keyword">static</span> constexpr uint64_t <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">seed</a> = 8675309;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#a47ab0fdc65c2a29d167d9bff88c204f3">   82</a></span>&#160;    <a class="code" href="structrgw_1_1fh__key.html#a47ab0fdc65c2a29d167d9bff88c204f3">fh_key</a>() {}</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#a786a0b84dc3295769b85a33876cb687e">   84</a></span>&#160;    <a class="code" href="structrgw_1_1fh__key.html#a786a0b84dc3295769b85a33876cb687e">fh_key</a>(<span class="keyword">const</span> rgw_fh_hk&amp; _hk)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      : <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>(_hk) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">// nothing</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#aa938558fd255ee4fc297596ad3ae5991">   89</a></span>&#160;    <a class="code" href="structrgw_1_1fh__key.html#aa938558fd255ee4fc297596ad3ae5991">fh_key</a>(<span class="keyword">const</span> uint64_t bk, <span class="keyword">const</span> uint64_t ok) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket = bk;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object = ok;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#a53acc4c80ee2e847200f9667625d2883">   94</a></span>&#160;    <a class="code" href="structrgw_1_1fh__key.html#a53acc4c80ee2e847200f9667625d2883">fh_key</a>(<span class="keyword">const</span> uint64_t bk, <span class="keyword">const</span> <span class="keywordtype">char</span> *_o) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket = bk;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object = XXH64(_o, ::strlen(_o), <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">seed</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#aafec173de4b8d2b726bff6fb50a69f88">   99</a></span>&#160;    <a class="code" href="structrgw_1_1fh__key.html#aafec173de4b8d2b726bff6fb50a69f88">fh_key</a>(<span class="keyword">const</span> std::string&amp; _b, <span class="keyword">const</span> std::string&amp; _o) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket = XXH64(_b.c_str(), _o.length(), <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">seed</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object = XXH64(_o.c_str(), _o.length(), <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">seed</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#a57d77c5f562d21290ed94280849ef128">  104</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structrgw_1_1fh__key.html#a57d77c5f562d21290ed94280849ef128">encode</a>(buffer::list&amp; bl)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      ENCODE_START(1, 1, bl);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a57d77c5f562d21290ed94280849ef128">::encode</a>(<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket, bl);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#a57d77c5f562d21290ed94280849ef128">::encode</a>(<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object, bl);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      ENCODE_FINISH(bl);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structrgw_1_1fh__key.html#af95b01f600fd6a173d2b604685553bda">  111</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structrgw_1_1fh__key.html#af95b01f600fd6a173d2b604685553bda">decode</a>(bufferlist::iterator&amp; bl) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      DECODE_START(1, bl);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#af95b01f600fd6a173d2b604685553bda">::decode</a>(<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket, bl);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html#af95b01f600fd6a173d2b604685553bda">::decode</a>(<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object, bl);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      DECODE_FINISH(bl);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }; <span class="comment">/* fh_key */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="namespacergw.html#a12e768365595ed6aa121311114126794">WRITE_CLASS_ENCODER</a>(fh_key);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="namespacergw.html#aa217e6c2e1039bb992e36ab91d69d8bf">  121</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacergw.html#aa217e6c2e1039bb992e36ab91d69d8bf">operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; rhs)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span> ((lhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket &lt; rhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket) ||</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        ((lhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket == rhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket) &amp;&amp;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          (lhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object &lt; rhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object)));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="namespacergw.html#ac9b5e09284173b17c1c330337c079b0d">  128</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacergw.html#ac9b5e09284173b17c1c330337c079b0d">operator&gt;</a>(<span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; rhs)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> (rhs &lt; lhs);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="namespacergw.html#a7c2a0e1d50dba271764d3f34f70b12a0">  133</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacergw.html#a7c2a0e1d50dba271764d3f34f70b12a0">operator==</a>(<span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; rhs)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">return</span> ((lhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket == rhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket) &amp;&amp;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        (lhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object == rhs.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="namespacergw.html#af832fa02fa66e375a70119598d0e3c50">  139</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacergw.html#af832fa02fa66e375a70119598d0e3c50">operator!=</a>(<span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; rhs)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> !(lhs == rhs);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="namespacergw.html#af648f6b54862c8b7037d8b006ef7b65b">  144</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacergw.html#af648f6b54862c8b7037d8b006ef7b65b">operator&lt;=</a>(<span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; rhs)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> (lhs &lt; rhs) || (lhs == rhs);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keyword">using</span> boost::variant;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keyword">using</span> boost::container::flat_map;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html">  152</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a> : <span class="keyword">public</span> cohort::lru::Object</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">struct </span>rgw_file_handle fh;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    std::mutex mtx;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* fs;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* bucket;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">/* const */</span> std::string name; <span class="comment">/* XXX file or bucket name */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">/* const */</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a> fhk;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">using</span> lock_guard = std::lock_guard&lt;std::mutex&gt;;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">using</span> unique_lock = std::unique_lock&lt;std::mutex&gt;;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">/* median file name length (HPC) has been found to be 16,</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">     * w/90% of file names &lt;= 31 (Yifan Wang, CMU) */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keyword">using</span> dirent_string = basic_sstring&lt;char, uint16_t, 32&gt;;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">using</span> marker_cache_t = flat_map&lt;uint64_t, dirent_string&gt;;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">using</span> name_cache_t = flat_map&lt;dirent_string, uint8_t&gt;;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">struct </span>State {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      uint64_t dev;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordtype">size_t</span> size;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      uint64_t nlink;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      uint32_t owner_uid; <span class="comment">/* XXX need Unix attr */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      uint32_t owner_gid; <span class="comment">/* XXX need Unix attr */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      mode_t unix_mode;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keyword">struct </span>timespec ctime;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keyword">struct </span>timespec mtime;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keyword">struct </span>timespec atime;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      State() : dev(0), size(0), nlink(1), owner_uid(0), owner_gid(0),</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        ctime{0,0}, mtime{0,0}, atime{0,0} {}</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    } state;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">struct </span>file {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="classrgw_1_1RGWWriteRequest.html">RGWWriteRequest</a>* write_req;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      file() : write_req(<span class="keyword">nullptr</span>) {}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      ~file();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    };</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">struct </span>directory {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">FLAG_NONE</a> =     0x0000;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keyword">static</span> constexpr uint32_t FLAG_CACHED =   0x0001;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keyword">static</span> constexpr uint32_t FLAG_OVERFLOW = 0x0002;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      uint32_t flags;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      marker_cache_t marker_cache;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      name_cache_t name_cache;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      directory() : flags(<a class="code" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">FLAG_NONE</a>) {}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordtype">void</span> clear_state() {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    marker_cache.clear();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    name_cache.clear();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordtype">void</span> set_overflow() {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    clear_state();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    flags |= FLAG_OVERFLOW;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    };</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    boost::variant&lt;file, directory&gt; variant_type;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    uint16_t depth;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    uint32_t flags;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a932accea77101187fee3a915b0d20588">  221</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">static</span> std::string <a class="code" href="classrgw_1_1RGWFileHandle.html#a932accea77101187fee3a915b0d20588">root_name</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a4f355729b987961d5117bea3a7237efe">  223</a></span>&#160;    <span class="keyword">static</span> constexpr uint16_t <a class="code" href="classrgw_1_1RGWFileHandle.html#a4f355729b987961d5117bea3a7237efe">MAX_DEPTH</a> = 256;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">  225</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">FLAG_NONE</a> =    0x0000;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a6d00387228389c3a65ace094383ab025">  226</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#a6d00387228389c3a65ace094383ab025">FLAG_OPEN</a> =    0x0001;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#af7449c9fe71c1bcdb32e023fcbcd8e11">  227</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#af7449c9fe71c1bcdb32e023fcbcd8e11">FLAG_ROOT</a> =    0x0002;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a0031684e510e759fa1c1b0ca68b9794e">  228</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#a0031684e510e759fa1c1b0ca68b9794e">FLAG_CREATE</a> =  0x0004;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ab8062b6d03caf3cdb31c19a3c8571c81">  229</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#ab8062b6d03caf3cdb31c19a3c8571c81">FLAG_CREATING</a> =  0x0008;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#aff531ac63c0d64e084f86048262cf335">  230</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#aff531ac63c0d64e084f86048262cf335">FLAG_DIRECTORY</a> = 0x0010;</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#aad7147e0ac74c588716b23f1d15f1387">  231</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#aad7147e0ac74c588716b23f1d15f1387">FLAG_BUCKET</a> = 0x0020;</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a151c7b6a6f016e56104020cfbecb2b88">  232</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#a151c7b6a6f016e56104020cfbecb2b88">FLAG_LOCK</a> =   0x0040;</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a8fa75a2cf243f79875cf08c73d0f389c">  233</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#a8fa75a2cf243f79875cf08c73d0f389c">FLAG_DELETED</a> = 0x0080;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="rgw__file_8h.html#a35b722e79e5cbfc3e70c42dc67657534">  235</a></span>&#160;<span class="preprocessor">#define CREATE_FLAGS(x) \</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">    ((x) &amp; ~(RGWFileHandle::FLAG_CREATE|RGWFileHandle::FLAG_LOCK))</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#af4478af9baf74a5e607ea6b1e614abf4">  238</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>(<a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* _fs, uint32_t fs_inst)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      : fs(_fs), bucket(nullptr), parent(nullptr), variant_type{directory()},</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    depth(0), flags(<a class="code" href="classrgw_1_1RGWFileHandle.html#af7449c9fe71c1bcdb32e023fcbcd8e11">FLAG_ROOT</a>)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">/* root */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    fh.fh_type = RGW_FS_TYPE_DIRECTORY;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    variant_type = directory();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">/* stat */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    state.dev = fs_inst;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    state.unix_mode = <a class="code" href="rgw__file_8h.html#a34de3d25465d88a39b97eee7882d3379">RGW_RWXMODE</a>|S_IFDIR;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">/* pointer to self */</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    fh.fh_private = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">void</span> init_rootfs(std::string&amp; fsid, <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">/* fh_key */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      fh.fh_hk.bucket = XXH64(fsid.c_str(), fsid.length(), <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">fh_key::seed</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      fh.fh_hk.object = XXH64(object_name.c_str(), object_name.length(),</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                  <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">fh_key::seed</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      fhk = fh.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      name = <a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#acfaedf1fa07d814faa5c21197fa4258b">  265</a></span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html#acfaedf1fa07d814faa5c21197fa4258b">RGWFileHandle</a>(<a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* fs, uint32_t fs_inst, <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _parent,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; _fhk, std::string&amp; _name, uint32_t _flags)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      : fs(fs), bucket(nullptr), parent(_parent), name(std::move(_name)),</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    fhk(_fhk), flags(_flags) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">if</span> (parent-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#ab50442186c8b140b5da64eac684d9f20">is_root</a>()) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    fh.fh_type = RGW_FS_TYPE_DIRECTORY;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    variant_type = directory();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    flags |= <a class="code" href="classrgw_1_1RGWFileHandle.html#aad7147e0ac74c588716b23f1d15f1387">FLAG_BUCKET</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    bucket = (parent-&gt;flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#aad7147e0ac74c588716b23f1d15f1387">FLAG_BUCKET</a>) ? parent</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      : parent-&gt;bucket;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    if (flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#aff531ac63c0d64e084f86048262cf335">FLAG_DIRECTORY</a>) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      fh.fh_type = RGW_FS_TYPE_DIRECTORY;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      variant_type = directory();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      fh.fh_type = RGW_FS_TYPE_FILE;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      variant_type = file();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      depth = parent-&gt;depth + 1;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">/* save constant fhk */</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      fh.fh_hk = fhk.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>; <span class="comment">/* XXX redundant in fh_hk */</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="comment">/* stat */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      state.dev = fs_inst;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">switch</span> (fh.fh_type) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">case</span> RGW_FS_TYPE_DIRECTORY:</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    state.unix_mode = <a class="code" href="rgw__file_8h.html#a34de3d25465d88a39b97eee7882d3379">RGW_RWXMODE</a>|S_IFDIR;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">case</span> RGW_FS_TYPE_FILE:</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    state.unix_mode = <a class="code" href="rgw__file_8h.html#abae3672cba958af452662b56b8ddcb0a">RGW_RWMODE</a>|S_IFREG;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">/* pointer to self */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      fh.fh_private = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">  308</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">return</span> fhk;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ac54638447ec4940e07d69dac37de4292">  312</a></span>&#160;    directory* <a class="code" href="classrgw_1_1RGWFileHandle.html#ac54638447ec4940e07d69dac37de4292">get_directory</a>() {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">return</span> get&lt;directory&gt;(&amp;variant_type);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#abd217f21e47973a87727a7ee45509c0a">  316</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#abd217f21e47973a87727a7ee45509c0a">get_size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> state.size; }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a56f38544722185b5776797652641a1f1">  318</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classrgw_1_1RGWFileHandle.html#a56f38544722185b5776797652641a1f1">stype</a>() {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#aee0a7e2a3c4d950261f4bc76eeb8ed8a">is_dir</a>() ? <span class="stringliteral">&quot;DIR&quot;</span> : <span class="stringliteral">&quot;FILE&quot;</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ada58227cc76f0974c6f9eb77042d534d">  322</a></span>&#160;    uint16_t <a class="code" href="classrgw_1_1RGWFileHandle.html#ada58227cc76f0974c6f9eb77042d534d">get_depth</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> depth; }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#acf29e35b3333e7a3faf079d33f295e7b">  324</a></span>&#160;    <span class="keyword">struct </span>rgw_file_handle* <a class="code" href="classrgw_1_1RGWFileHandle.html#acf29e35b3333e7a3faf079d33f295e7b">get_fh</a>() { <span class="keywordflow">return</span> &amp;fh; }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a341675e834ef07cc43021999de82717c">  326</a></span>&#160;    <a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* <a class="code" href="classrgw_1_1RGWFileHandle.html#a341675e834ef07cc43021999de82717c">get_fs</a>() { <span class="keywordflow">return</span> fs; }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a5c771407169165286bc9cb33a11683f6">  328</a></span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWFileHandle.html#a5c771407169165286bc9cb33a11683f6">get_parent</a>() { <span class="keywordflow">return</span> parent; }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a85c4c632dbc12630a9a2f084e7d24878">  330</a></span>&#160;    uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#a85c4c632dbc12630a9a2f084e7d24878">get_owner_uid</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> state.owner_uid; }</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#acfabf725c0bbe38e1f00442cbb9bd057">  331</a></span>&#160;    uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#acfabf725c0bbe38e1f00442cbb9bd057">get_owner_gid</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> state.owner_gid; }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#aedf815c3b4bef0b2a8e197ec29613df2">  333</a></span>&#160;    <span class="keyword">struct </span>timespec <a class="code" href="classrgw_1_1RGWFileHandle.html#aedf815c3b4bef0b2a8e197ec29613df2">get_mtime</a>() const { <span class="keywordflow">return</span> state.mtime; }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a1789de1dcc9d3103dedcaefb9b563939">  335</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a1789de1dcc9d3103dedcaefb9b563939">create_stat</a>(<span class="keyword">struct</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a>* st, uint32_t mask) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span> (mask &amp; RGW_SETATTR_UID)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    state.owner_uid = st-&gt;st_uid;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">if</span> (mask &amp; RGW_SETATTR_GID)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    state.owner_gid = st-&gt;st_gid;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span> (mask &amp; RGW_SETATTR_MODE)  {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">switch</span> (fh.fh_type) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">case</span> RGW_FS_TYPE_DIRECTORY:</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      state.unix_mode = st-&gt;st_mode|S_IFDIR;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">case</span> RGW_FS_TYPE_FILE:</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      state.unix_mode = st-&gt;st_mode|S_IFREG;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">  355</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a>(<span class="keyword">struct</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a>* st) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">/* partial Unix attrs */</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      memset(st, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a>));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      st-&gt;st_dev = state.dev;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      st-&gt;st_ino = fh.fh_hk.object; <span class="comment">// XXX</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      st-&gt;st_uid = state.owner_uid;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      st-&gt;st_gid = state.owner_gid;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      st-&gt;st_mode = state.unix_mode;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      st-&gt;st_atim = state.atime;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      st-&gt;st_mtim = state.mtime;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      st-&gt;st_ctim = state.ctime;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">switch</span> (fh.fh_type) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">case</span> RGW_FS_TYPE_DIRECTORY:</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    st-&gt;st_mode = <a class="code" href="rgw__file_8h.html#a34de3d25465d88a39b97eee7882d3379">RGW_RWXMODE</a>|S_IFDIR <span class="comment">/* state.unix_mode|S_IFDIR */</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    st-&gt;st_nlink = 3;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">case</span> RGW_FS_TYPE_FILE:</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    st-&gt;st_mode = <a class="code" href="rgw__file_8h.html#abae3672cba958af452662b56b8ddcb0a">RGW_RWMODE</a>|S_IFREG <span class="comment">/* state.unix_mode|S_IFREG */</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    st-&gt;st_nlink = 1;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    st-&gt;st_blksize = 4096;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    st-&gt;st_size = state.size;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    st-&gt;st_blocks = (state.size) / 512;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">  388</a></span>&#160;    <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classrgw_1_1RGWFileHandle.html#ab50442186c8b140b5da64eac684d9f20">is_root</a>())</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a932accea77101187fee3a915b0d20588">root_name</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">if</span> (flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#aad7147e0ac74c588716b23f1d15f1387">FLAG_BUCKET</a>)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> name;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">return</span> bucket-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">  396</a></span>&#160;    <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> name; }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a7cb402ea666ff86a390d10adb99807af">  398</a></span>&#160;    std::string <a class="code" href="classrgw_1_1RGWFileHandle.html#a7cb402ea666ff86a390d10adb99807af">full_object_name</a>(<span class="keywordtype">bool</span> omit_bucket = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      std::string path;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      std::vector&lt;const std::string*&gt; segments;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordtype">int</span> reserve = 0;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* tfh = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">while</span> (tfh &amp;&amp; !tfh-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#ab50442186c8b140b5da64eac684d9f20">is_root</a>() &amp;&amp; !(tfh-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#a0c0784b237d715616ac5002305528d48">is_bucket</a>() &amp;&amp; omit_bucket)) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    segments.push_back(&amp;tfh-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>());</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    reserve += (1 + tfh-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>().length());</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    tfh = tfh-&gt;parent;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      path.reserve(reserve);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; s : boost::adaptors::reverse(segments)) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (! first)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      path += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">if</span> (!omit_bucket &amp;&amp; (path.front() != <span class="charliteral">&#39;/&#39;</span>)) <span class="comment">// pretty-print</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        path += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    path += *s;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">return</span> path;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a93ee4c3f0f85ce2d1ad8cbd9c1ad7df3">  423</a></span>&#160;    <span class="keyword">inline</span> std::string <a class="code" href="classrgw_1_1RGWFileHandle.html#a93ee4c3f0f85ce2d1ad8cbd9c1ad7df3">relative_object_name</a>() {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a7cb402ea666ff86a390d10adb99807af">full_object_name</a>(<span class="keyword">true</span> <span class="comment">/* omit_bucket */</span>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a75a1eacc3db9c16cc675c0df8ba52476">  427</a></span>&#160;    <span class="keyword">inline</span> std::string <a class="code" href="classrgw_1_1RGWFileHandle.html#a75a1eacc3db9c16cc675c0df8ba52476">format_child_name</a>(<span class="keyword">const</span> std::string&amp; cbasename) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      std::string child_name{<a class="code" href="classrgw_1_1RGWFileHandle.html#a93ee4c3f0f85ce2d1ad8cbd9c1ad7df3">relative_object_name</a>()};</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> ((child_name.size() &gt; 0) &amp;&amp;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      (child_name.back() != <span class="charliteral">&#39;/&#39;</span>))</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    child_name += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      child_name += cbasename;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">return</span> child_name;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a42104aadfd3dfd985655b3bff2824da3">  436</a></span>&#160;    <span class="keyword">inline</span> std::string <a class="code" href="classrgw_1_1RGWFileHandle.html#a42104aadfd3dfd985655b3bff2824da3">make_key_name</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      std::string key_name{<a class="code" href="classrgw_1_1RGWFileHandle.html#a7cb402ea666ff86a390d10adb99807af">full_object_name</a>()};</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">if</span> (key_name.length() &gt; 0)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    key_name += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      key_name += name;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">return</span> key_name;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ac565ed2678f9c2755f4dee617bcabea1">  444</a></span>&#160;    <a class="code" href="structrgw_1_1fh__key.html">fh_key</a> <a class="code" href="classrgw_1_1RGWFileHandle.html#ac565ed2678f9c2755f4dee617bcabea1">make_fhk</a>(<span class="keyword">const</span> std::string&amp; name) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">if</span> (depth &lt;= 1)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>(fhk.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object, name.c_str());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    std::string key_name = <a class="code" href="classrgw_1_1RGWFileHandle.html#a42104aadfd3dfd985655b3bff2824da3">make_key_name</a>(name.c_str());</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>(fhk.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket, key_name.c_str());</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a6baabcc9626a6b9ca4aca2757a40e6c1">  453</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a6baabcc9626a6b9ca4aca2757a40e6c1">add_marker</a>(uint64_t off, <span class="keyword">const</span> boost::string_ref&amp; marker,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            uint8_t obj_type) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keyword">using</span> std::get;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      directory* d = get&lt;directory&gt;(&amp;variant_type);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">if</span> (d) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    unique_lock guard(mtx);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// XXXX check for failure (dup key)</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    d-&gt;marker_cache.insert(</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      marker_cache_t::value_type(off, marker.data()));</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">/* 90% of directories hold &lt;= 32 entries (Yifan Wang, CMU),</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">     * but go big */</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span> (d-&gt;name_cache.size() &lt; 128) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      d-&gt;name_cache.insert(</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        name_cache_t::value_type(marker.data(), obj_type));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      d-&gt;set_overflow(); <span class="comment">// too many</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">/* XXX */</span></div>
<div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a71add63c3631838b73297f4f34cda182">  474</a></span>&#160;    std::string <a class="code" href="classrgw_1_1RGWFileHandle.html#a71add63c3631838b73297f4f34cda182">find_marker</a>(uint64_t off) { <span class="comment">// XXX copy</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">using</span> std::get;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      directory* d = get&lt;directory&gt;(&amp;variant_type);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">if</span> (d) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; iter = d-&gt;marker_cache.find(off);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span> (iter != d-&gt;marker_cache.end())</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">return</span> iter-&gt;second;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a9349d7b338f95e08b5a481dec8175bb9">  485</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a9349d7b338f95e08b5a481dec8175bb9">is_open</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a6d00387228389c3a65ace094383ab025">FLAG_OPEN</a>; }</div>
<div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ab50442186c8b140b5da64eac684d9f20">  486</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#ab50442186c8b140b5da64eac684d9f20">is_root</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#af7449c9fe71c1bcdb32e023fcbcd8e11">FLAG_ROOT</a>; }</div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a0c0784b237d715616ac5002305528d48">  487</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a0c0784b237d715616ac5002305528d48">is_bucket</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#aad7147e0ac74c588716b23f1d15f1387">FLAG_BUCKET</a>; }</div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a7fdbebe5b4659bb57e548808cace45be">  488</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a7fdbebe5b4659bb57e548808cace45be">is_object</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code" href="classrgw_1_1RGWFileHandle.html#a0c0784b237d715616ac5002305528d48">is_bucket</a>(); }</div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#afc125bc2bbd9ee49d91f0d67e57425f3">  489</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#afc125bc2bbd9ee49d91f0d67e57425f3">is_file</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (fh.fh_type == RGW_FS_TYPE_FILE); }</div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#aee0a7e2a3c4d950261f4bc76eeb8ed8a">  490</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#aee0a7e2a3c4d950261f4bc76eeb8ed8a">is_dir</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (fh.fh_type == RGW_FS_TYPE_DIRECTORY); }</div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a9213adb9ffb760cdbfe5109d3db972e8">  491</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a9213adb9ffb760cdbfe5109d3db972e8">creating</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#ab8062b6d03caf3cdb31c19a3c8571c81">FLAG_CREATING</a>; }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#aa4a3e26bc13cce2e80a843c2e878050e">  493</a></span>&#160;    uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#aa4a3e26bc13cce2e80a843c2e878050e">open</a>(uint32_t gsh_flags) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      lock_guard guard(mtx);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">if</span> (! (flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a6d00387228389c3a65ace094383ab025">FLAG_OPEN</a>)) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    flags |= <a class="code" href="classrgw_1_1RGWFileHandle.html#a6d00387228389c3a65ace094383ab025">FLAG_OPEN</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">return</span> EPERM;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a60a129497f73f9e16a4d86d873e096ff">readdir</a>(rgw_readdir_cb rcb, <span class="keywordtype">void</span> *cb_arg, uint64_t *offset, <span class="keywordtype">bool</span> *eof,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        uint32_t flags);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#ad161b2b69b1702aaaa3a77436050fc7c">write</a>(uint64_t off, <span class="keywordtype">size_t</span> len, <span class="keywordtype">size_t</span> *nbytes, <span class="keywordtype">void</span> *buffer);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#aa850ddb3561607ca6b4129ef2a382271">write_finish</a>();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#ac619fb7838374169af1b34a4f8a1dcad">close</a>();</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a3b9e07d9efcd0dd25963117b7c77c70b">  508</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a3b9e07d9efcd0dd25963117b7c77c70b">open_for_create</a>() {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      lock_guard guard(mtx);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      flags |= <a class="code" href="classrgw_1_1RGWFileHandle.html#ab8062b6d03caf3cdb31c19a3c8571c81">FLAG_CREATING</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ab5db5b6c8bc5a32349912720241df65f">  513</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#ab5db5b6c8bc5a32349912720241df65f">clear_creating</a>() {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      lock_guard guard(mtx);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      flags &amp;= ~<a class="code" href="classrgw_1_1RGWFileHandle.html#ab8062b6d03caf3cdb31c19a3c8571c81">FLAG_CREATING</a>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a20a64de75ec640751e3503c2cfaf3da3">  518</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a20a64de75ec640751e3503c2cfaf3da3">set_nlink</a>(<span class="keyword">const</span> uint64_t n) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      state.nlink = n;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a174ce3fbc31fbb2ff07875aea1d56fe1">  522</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a174ce3fbc31fbb2ff07875aea1d56fe1">set_size</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> size) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      state.size = size;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a527db9bd370f200b120ec9d136a38c15">  526</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a527db9bd370f200b120ec9d136a38c15">set_times</a>(real_time t) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      state.ctime = real_clock::to_timespec(t);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      state.mtime = state.ctime;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      state.atime = state.ctime;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ae0578e2667ece4725262575f6feaa31b">  532</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#ae0578e2667ece4725262575f6feaa31b">set_ctime</a>(<span class="keyword">const</span> <span class="keyword">struct</span> timespec &amp;ts) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      state.ctime = ts;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a20daf561a0fb92aa12ae6cd449b93afb">  536</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a20daf561a0fb92aa12ae6cd449b93afb">set_mtime</a>(<span class="keyword">const</span> <span class="keyword">struct</span> timespec &amp;ts) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      state.mtime = ts;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a31ca13a8d792f594a537fa058d846292">  540</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a31ca13a8d792f594a537fa058d846292">set_atime</a>(<span class="keyword">const</span> <span class="keyword">struct</span> timespec &amp;ts) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      state.atime = ts;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">  544</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">encode</a>(buffer::list&amp; bl)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      ENCODE_START(1, 1, bl);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(uint32_t(fh.fh_type), bl);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(state.dev, bl);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(state.size, bl);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(state.nlink, bl);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(state.owner_uid, bl);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(state.owner_gid, bl);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(state.unix_mode, bl);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; t : { state.ctime, state.mtime, state.atime }) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">::encode</a>(real_clock::from_timespec(t), bl);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      ENCODE_FINISH(bl);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">  559</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">decode</a>(bufferlist::iterator&amp; bl) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      DECODE_START(1, bl);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      uint32_t fh_type;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(fh_type, bl);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      assert(fh.fh_type == fh_type);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(state.dev, bl);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(state.size, bl);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(state.nlink, bl);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(state.owner_uid, bl);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(state.owner_gid, bl);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(state.unix_mode, bl);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      ceph::real_time enc_time;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> t : { &amp;(state.ctime), &amp;(state.mtime), &amp;(state.atime) }) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">::decode</a>(enc_time, bl);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    *t = real_clock::to_timespec(enc_time);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      DECODE_FINISH(bl);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a07dc960e190ecbeaf2ad17a7ffa8a660">encode_attrs</a>(ceph::buffer::list&amp; ux_key1,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;              ceph::buffer::list&amp; ux_attrs1);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a6505d0956c7ff406b319b61380e8d2ba">decode_attrs</a>(<span class="keyword">const</span> ceph::buffer::list* ux_key1,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;              <span class="keyword">const</span> ceph::buffer::list* ux_attrs1);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#aa60a708cb8c058de16d4fc040a2ee827">reclaim</a>();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a836685891496827e7b814e2c4e0e0001">  586</a></span>&#160;    <span class="keyword">typedef</span> cohort::lru::LRU&lt;std::mutex&gt; <a class="code" href="classrgw_1_1RGWFileHandle.html#a836685891496827e7b814e2c4e0e0001">FhLRU</a>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhLT.html">  588</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structrgw_1_1RGWFileHandle_1_1FhLT.html">FhLT</a></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="comment">// for internal ordering</span></div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhLT.html#aede91ac2f051e41df3555d8f9ffb9201">  591</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhLT.html#aede91ac2f051e41df3555d8f9ffb9201">operator()</a>(<span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; rhs)<span class="keyword"> const</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> (lhs.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>() &lt; rhs.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>()); }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="comment">// for external search by fh_key</span></div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhLT.html#a037449d03534e81432d13b0b8486f3eb">  595</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhLT.html#a037449d03534e81432d13b0b8486f3eb">operator()</a>(<span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; k, <span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; fh)<span class="keyword"> const</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> k &lt; fh.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>(); }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhLT.html#a772b572a84d82be6fb6e87ec25457397">  598</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhLT.html#a772b572a84d82be6fb6e87ec25457397">operator()</a>(<span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; fh, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; k)<span class="keyword"> const</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> fh.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>() &lt; k; }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    };</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html">  602</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html">FhEQ</a></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    {</div>
<div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#a1a085453b8697cfd8399d4513525f077">  604</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#a1a085453b8697cfd8399d4513525f077">operator()</a>(<span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; lhs, <span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; rhs)<span class="keyword"> const</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> (lhs.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>() == rhs.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>()); }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#ab78f5b5b0b2caf7ca0e8eadc8615798e">  607</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#ab78f5b5b0b2caf7ca0e8eadc8615798e">operator()</a>(<span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; k, <span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; fh)<span class="keyword"> const</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> k == fh.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>(); }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#a9c2296475a618c7fa972c18f021da435">  610</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#a9c2296475a618c7fa972c18f021da435">operator()</a>(<span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>&amp; fh, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; k)<span class="keyword"> const</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">    </span>{ <span class="keywordflow">return</span> fh.<a class="code" href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">get_key</a>() == k; }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    };</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a224cde9cf422aac065a4935d5e02af23">  614</a></span>&#160;    <span class="keyword">typedef</span> bi::link_mode&lt;bi::safe_link&gt; <a class="code" href="classrgw_1_1RGWFileHandle.html#a224cde9cf422aac065a4935d5e02af23">link_mode</a>; <span class="comment">/* XXX normal */</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor">#if defined(FHCACHE_AVL)</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor"></span>    <span class="keyword">typedef</span> bi::avl_set_member_hook&lt;link_mode&gt; <a class="code" href="classrgw_1_1RGWFileHandle.html#ac0d23c8cdc62ec49770842713756f129">tree_hook_type</a>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor"></span>    <span class="comment">/* RBT */</span></div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ac0d23c8cdc62ec49770842713756f129">  619</a></span>&#160;    <span class="keyword">typedef</span> bi::set_member_hook&lt;link_mode&gt; <a class="code" href="classrgw_1_1RGWFileHandle.html#ac0d23c8cdc62ec49770842713756f129">tree_hook_type</a>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ac927da7ee130812cd099fe2fff956b67">  621</a></span>&#160;<span class="preprocessor"></span>    tree_hook_type <a class="code" href="classrgw_1_1RGWFileHandle.html#ac927da7ee130812cd099fe2fff956b67">fh_hook</a>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keyword">typedef</span> bi::member_hook&lt;</div>
<div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a47dd86ffc364e747248594c6d5723897">  624</a></span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>, <a class="code" href="classrgw_1_1RGWFileHandle.html#ac0d23c8cdc62ec49770842713756f129">tree_hook_type</a>, &amp;<a class="code" href="classrgw_1_1RGWFileHandle.html#ac927da7ee130812cd099fe2fff956b67">RGWFileHandle::fh_hook</a>&gt; <a class="code" href="classrgw_1_1RGWFileHandle.html#a47dd86ffc364e747248594c6d5723897">FhHook</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">#if defined(FHCACHE_AVL)</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor"></span>    <span class="keyword">typedef</span> bi::avltree&lt;RGWFileHandle, bi::compare&lt;FhLT&gt;, FhHook&gt; FHTree;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00629"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#a5563c9498bce45b4f9581730d64bdba1">  629</a></span>&#160;<span class="preprocessor"></span>    <span class="keyword">typedef</span> bi::rbtree&lt;RGWFileHandle, bi::compare&lt;FhLT&gt;, FhHook&gt; <a class="code" href="classrgw_1_1RGWFileHandle.html#a5563c9498bce45b4f9581730d64bdba1">FhTree</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor"></span>    <span class="keyword">typedef</span> cohort::lru::TreeX&lt;<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>, <a class="code" href="classrgw_1_1RGWFileHandle.html#a5563c9498bce45b4f9581730d64bdba1">FhTree</a>, <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhLT.html">FhLT</a>, <a class="code" href="structrgw_1_1RGWFileHandle_1_1FhEQ.html">FhEQ</a>, <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>,</div>
<div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#aa505b1652780ffb0e7928fff8c99727b">  632</a></span>&#160;                   std::mutex&gt; <a class="code" href="classrgw_1_1RGWFileHandle.html#aa505b1652780ffb0e7928fff8c99727b">FHCache</a>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle.html#ac8c4afd64dedb5ad8bbb0e1a93ef362e">  634</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#ac8c4afd64dedb5ad8bbb0e1a93ef362e">~RGWFileHandle</a>() {}</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html">  636</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html">Factory</a> : <span class="keyword">public</span> cohort::lru::ObjectFactory</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a3db02f6ea5b5a90da4874d3b2e5fca35">  639</a></span>&#160;      <a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a3db02f6ea5b5a90da4874d3b2e5fca35">fs</a>;</div>
<div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a111d1d4f10fba6466dd066320a121f76">  640</a></span>&#160;      uint32_t <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a111d1d4f10fba6466dd066320a121f76">fs_inst</a>;</div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa3c545ff3c489a696992d8d2e180a69b">  641</a></span>&#160;      RGWFileHandle* <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa3c545ff3c489a696992d8d2e180a69b">parent</a>;</div>
<div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aececbe4b0b9dfff8fdb4eb39c9420e18">  642</a></span>&#160;      <span class="keyword">const</span> fh_key&amp; <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aececbe4b0b9dfff8fdb4eb39c9420e18">fhk</a>;</div>
<div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a98f63f57a8b8673f6cb4883211a4a5b3">  643</a></span>&#160;      std::string&amp; <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a98f63f57a8b8673f6cb4883211a4a5b3">name</a>;</div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a7ef649bf83d9530a7377e651b0676d3b">  644</a></span>&#160;      uint32_t <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a7ef649bf83d9530a7377e651b0676d3b">flags</a>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa47266444aea293f58544708a78b2bb2">Factory</a>() = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#ace9c37299b8c00ceee03e3d769f0a98f">  648</a></span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#ace9c37299b8c00ceee03e3d769f0a98f">Factory</a>(<a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a3db02f6ea5b5a90da4874d3b2e5fca35">fs</a>, uint32_t <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a111d1d4f10fba6466dd066320a121f76">fs_inst</a>, RGWFileHandle* <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa3c545ff3c489a696992d8d2e180a69b">parent</a>,</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keyword">const</span> fh_key&amp; <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aececbe4b0b9dfff8fdb4eb39c9420e18">fhk</a>, std::string&amp; <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a98f63f57a8b8673f6cb4883211a4a5b3">name</a>, uint32_t <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a7ef649bf83d9530a7377e651b0676d3b">flags</a>)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    : fs(fs), fs_inst(fs_inst), parent(parent), fhk(fhk), name(name),</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      flags(flags) {}</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#ad54f435622514661452e4bae74613e20">  653</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#ad54f435622514661452e4bae74613e20">recycle</a> (cohort::lru::Object* o) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">/* re-use an existing object */</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    o-&gt;~Object(); <span class="comment">// call lru::Object virtual dtor</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// placement new!</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keyword">new</span> (o) RGWFileHandle(<a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a3db02f6ea5b5a90da4874d3b2e5fca35">fs</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a111d1d4f10fba6466dd066320a121f76">fs_inst</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa3c545ff3c489a696992d8d2e180a69b">parent</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aececbe4b0b9dfff8fdb4eb39c9420e18">fhk</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a98f63f57a8b8673f6cb4883211a4a5b3">name</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a7ef649bf83d9530a7377e651b0676d3b">flags</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a38b0a79144abfeff79a25a5b4aa380eb">  660</a></span>&#160;      cohort::lru::Object* <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a38b0a79144abfeff79a25a5b4aa380eb">alloc</a>() {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> RGWFileHandle(<a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a3db02f6ea5b5a90da4874d3b2e5fca35">fs</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a111d1d4f10fba6466dd066320a121f76">fs_inst</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa3c545ff3c489a696992d8d2e180a69b">parent</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#aececbe4b0b9dfff8fdb4eb39c9420e18">fhk</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a98f63f57a8b8673f6cb4883211a4a5b3">name</a>, <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html#a7ef649bf83d9530a7377e651b0676d3b">flags</a>);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }; <span class="comment">/* Factory */</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  }; <span class="comment">/* RGWFileHandle */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="namespacergw.html#a12e768365595ed6aa121311114126794">WRITE_CLASS_ENCODER</a>(RGWFileHandle);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="namespacergw.html#a07be50b94390c980f71b1e0604380520">  669</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="namespacergw.html#a07be50b94390c980f71b1e0604380520">get_rgwfh</a>(<span class="keyword">struct</span> rgw_file_handle* fh) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>*<span class="keyword">&gt;</span>(fh-&gt;fh_private);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="namespacergw.html#a91c107b9a28ca60c4777c28cf5f59632">  673</a></span>&#160;  <span class="keyword">typedef</span> std::tuple&lt;RGWFileHandle*, uint32_t&gt; <a class="code" href="namespacergw.html#a91c107b9a28ca60c4777c28cf5f59632">LookupFHResult</a>;</div>
<div class="line"><a name="l00674"></a><span class="lineno"><a class="line" href="namespacergw.html#a925f71101c6109eaabbbf4d65c591c5d">  674</a></span>&#160;  <span class="keyword">typedef</span> std::tuple&lt;RGWFileHandle*, int&gt; <a class="code" href="namespacergw.html#a925f71101c6109eaabbbf4d65c591c5d">MkObjResult</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html">  676</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    CephContext* cct;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keyword">struct </span>rgw_fs fs;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a> root_fh;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keyword">mutable</span> std::atomic&lt;uint64_t&gt; refcnt;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html#aa505b1652780ffb0e7928fff8c99727b">RGWFileHandle::FHCache</a> fh_cache;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html#a836685891496827e7b814e2c4e0e0001">RGWFileHandle::FhLRU</a> fh_lru;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    std::string uid; <span class="comment">// should match user.user_id, iiuc</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> user;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="structRGWAccessKey.html">RGWAccessKey</a> key; <span class="comment">// XXXX acc_key</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keyword">static</span> atomic&lt;uint32_t&gt; fs_inst;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    std::string fsid;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">using</span> lock_guard = std::lock_guard&lt;std::mutex&gt;;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keyword">using</span> unique_lock = std::unique_lock&lt;std::mutex&gt;;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keyword">struct </span>event</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keyword">enum class</span> type : uint8_t { READDIR } ;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      type t;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a> fhk;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keyword">struct </span>timespec ts;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      event(type t, <span class="keyword">const</span> <a class="code" href="structrgw_1_1fh__key.html">fh_key</a>&amp; k, <span class="keyword">const</span> <span class="keyword">struct</span> timespec&amp; ts)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    : t(t), fhk(k), ts(ts) {}</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    };</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keyword">using</span> event_vector = <span class="comment">/* boost::small_vector&lt;event, 16&gt; */</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      std::vector&lt;event&gt;;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keyword">struct </span>state {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      std::mutex mtx;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      std::atomic&lt;uint32_t&gt; flags;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      std::deque&lt;event&gt; events;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      state() : flags(0) {}</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordtype">void</span> push_event(<span class="keyword">const</span> event&amp; ev) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    lock_guard guard(mtx);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    events.push_back(ev);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    } state;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a1eb86f0f6c411b00f7f590570d3645b0">  722</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#acb8969da1b5beea521fa029651fbe7fc">  726</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">FLAG_NONE</a> =      0x0000;</div>
<div class="line"><a name="l00727"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a0b30b34313956094745fe4840f78caec">  727</a></span>&#160;    <span class="keyword">static</span> constexpr uint32_t FLAG_CLOSED =    0x0001;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#af2ff9fe0ef5e0545a807067c6636c34c">  729</a></span>&#160;    <a class="code" href="classrgw_1_1RGWLibFS.html#af2ff9fe0ef5e0545a807067c6636c34c">RGWLibFS</a>(CephContext* _cct, <span class="keyword">const</span> <span class="keywordtype">char</span> *_uid, <span class="keyword">const</span> <span class="keywordtype">char</span> *_user_id,</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* _key)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      : cct(_cct), root_fh(this, get_inst()), refcnt(1),</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    fh_cache(cct-&gt;_conf-&gt;rgw_nfs_fhcache_partitions,</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;         cct-&gt;_conf-&gt;rgw_nfs_fhcache_size),</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    fh_lru(cct-&gt;_conf-&gt;rgw_nfs_lru_lanes,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;           cct-&gt;_conf-&gt;rgw_nfs_lru_lane_hiwat),</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    uid(_uid), key(_user_id, _key) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="comment">/* no bucket may be named rgw_fs_inst-(.*) */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      fsid = <a class="code" href="classrgw_1_1RGWFileHandle.html#a932accea77101187fee3a915b0d20588">RGWFileHandle::root_name</a> + <span class="stringliteral">&quot;rgw_fs_inst-&quot;</span> +</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    std::to_string(++(fs_inst));</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      root_fh.init_rootfs(fsid <span class="comment">/* bucket */</span>, <a class="code" href="classrgw_1_1RGWFileHandle.html#a932accea77101187fee3a915b0d20588">RGWFileHandle::root_name</a>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="comment">/* pointer to self */</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      fs.fs_private = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="comment">/* expose public root fh */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      fs.root_fh = root_fh.get_fh();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a8d0131dff32d88e53ef8a6920f0acecf">  751</a></span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWLibFS.html#a8d0131dff32d88e53ef8a6920f0acecf">intrusive_ptr_add_ref</a>(<span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* fs) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      fs-&gt;refcnt.fetch_add(1, std::memory_order_relaxed);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a6d0043585c5a46437fafb2c0a9c3d7af">  755</a></span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWLibFS.html#a6d0043585c5a46437fafb2c0a9c3d7af">intrusive_ptr_release</a>(<span class="keyword">const</span> <a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* fs) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span> (fs-&gt;refcnt.fetch_sub(1, std::memory_order_release) == 0) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    std::atomic_thread_fence(std::memory_order_acquire);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keyword">delete</span> fs;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a1ea8c6d92723ade8196ca80dde1f5b9a">  762</a></span>&#160;    <a class="code" href="classrgw_1_1RGWLibFS.html">RGWLibFS</a>* <a class="code" href="classrgw_1_1RGWLibFS.html#a1ea8c6d92723ade8196ca80dde1f5b9a">ref</a>() {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <a class="code" href="rgw__main_8cc.html#a16c5542a513398593bf270eeebd3ea6d">intrusive_ptr_add_ref</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">this</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#acf285a5e341bb35fad15a6870e167e0d">  767</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWLibFS.html#acf285a5e341bb35fad15a6870e167e0d">rele</a>() {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <a class="code" href="rgw__main_8cc.html#af3e97d07a077cd4939ff7cc8a1661e85">intrusive_ptr_release</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a92d338d83c64813a44f041842edd8cc1">  771</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWLibFS.html#a92d338d83c64813a44f041842edd8cc1">authorize</a>(<a class="code" href="classRGWRados.html">RGWRados</a>* <a class="code" href="rgw__admin_8cc.html#a9b49a835107f65049c05bddc99751652">store</a>) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keywordtype">int</span> ret = <a class="code" href="rgw__user_8cc.html#a9d0d930124e3ab630b88157dd300bc21">rgw_get_user_info_by_access_key</a>(store, key.id, user);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="structRGWAccessKey.html">RGWAccessKey</a>* key0 = user.get_key0();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">if</span> (!key0 ||</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        (key0-&gt;<a class="code" href="structRGWAccessKey.html#a8a87deb3d5d326b8e990dbc915015c03">key</a> != key.key))</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> (user.suspended)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">return</span> -<a class="code" href="rgw__common_8h.html#ae725f810ce0b0649b76acded093131bf">ERR_USER_SUSPENDED</a>;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">/* try external authenticators (ldap for now) */</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <a class="code" href="classrgw_1_1LDAPHelper.html">rgw::LDAPHelper</a>* ldh = <a class="code" href="namespacergw.html#a2d2589dec8dc14314573384f2244ff45">rgwlib</a>.<a class="code" href="classrgw_1_1RGWLib.html#afc455f5dcbcf1ffac25ac60084ba85a3">get_ldh</a>(); <span class="comment">/* !nullptr */</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="classrgw_1_1RGWToken.html">RGWToken</a> token{<a class="code" href="namespacergw.html#a62778069fc9c34bb1aada3f786438489">from_base64</a>(key.id)};</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> (token.valid() &amp;&amp; (ldh-&gt;<a class="code" href="classrgw_1_1LDAPHelper.html#a695c45289ece0fa35b1242666bb0db75">auth</a>(token.id, token.key) == 0)) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="comment">/* try to store user if it doesn&#39;t already exist */</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="rgw__user_8cc.html#adf858619fe81ae69cc25ce7f96454302">rgw_get_user_info_by_uid</a>(store, token.id, user) &lt; 0) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordtype">int</span> ret = <a class="code" href="rgw__user_8cc.html#af3740c7763c6f4ce4dea93627a36decc">rgw_store_user_info</a>(store, user, NULL, NULL, real_time(),</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                      <span class="keyword">true</span>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          lsubdout(get_context(), rgw, 10)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;NOTICE: failed to store new user&#39;s info: ret=&quot;</span> &lt;&lt; ret</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        &lt;&lt; dendl;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    } <span class="comment">/* auth success */</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    } <span class="comment">/* authorize */</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">/* find or create an RGWFileHandle */</span></div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a11e8af827a1bcf6dec846d0291185285">  801</a></span>&#160;    <a class="code" href="namespacergw.html#a91c107b9a28ca60c4777c28cf5f59632">LookupFHResult</a> <a class="code" href="classrgw_1_1RGWLibFS.html#a11e8af827a1bcf6dec846d0291185285">lookup_fh</a>(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                 <span class="keyword">const</span> uint32_t flags = <a class="code" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">RGWFileHandle::FLAG_NONE</a>) {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keyword">using</span> std::get;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="comment">// cast int32_t(RGWFileHandle::FLAG_NONE) due to strictness of Clang </span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="comment">// the cast transfers a lvalue into a rvalue  in the ctor</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="comment">// check the commit message for the full details</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <a class="code" href="namespacergw.html#a91c107b9a28ca60c4777c28cf5f59632">LookupFHResult</a> fhr { <span class="keyword">nullptr</span>, uint32_t(<a class="code" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">RGWFileHandle::FLAG_NONE</a>) };</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">/* mount is stale? */</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">if</span> (state.flags &amp; FLAG_CLOSED)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">return</span> fhr;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      RGWFileHandle::FHCache::Latch lat;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      std::string obj_name{name};</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      std::string key_name{parent-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#a42104aadfd3dfd985655b3bff2824da3">make_key_name</a>(name)};</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      lsubdout(get_context(), rgw, 10)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot; lookup called on &quot;</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    &lt;&lt; parent-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>() &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; key_name</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; obj_name &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    &lt;&lt; dendl;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html">fh_key</a> fhk = parent-&gt;<a class="code" href="classrgw_1_1RGWFileHandle.html#ac565ed2678f9c2755f4dee617bcabea1">make_fhk</a>(key_name);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    retry:</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* fh =</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    fh_cache.find_latch(fhk.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object <span class="comment">/* partition selector*/</span>,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                fhk <span class="comment">/* key */</span>, lat <span class="comment">/* serializer */</span>,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                RGWFileHandle::FHCache::FLAG_LOCK);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="comment">/* LATCHED */</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">if</span> (fh) {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    fh-&gt;mtx.lock(); <span class="comment">// XXX !RAII because may-return-LOCKED</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">if</span> (fh-&gt;flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a8fa75a2cf243f79875cf08c73d0f389c">RGWFileHandle::FLAG_DELETED</a>) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="comment">/* for now, delay briefly and retry */</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      lat.lock-&gt;unlock();</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      fh-&gt;mtx.unlock();</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      std::this_thread::sleep_for(std::chrono::milliseconds(20));</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordflow">goto</span> retry; <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">/* need initial ref from LRU (fast path) */</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (! fh_lru.ref(fh, cohort::lru::FLAG_INITIAL)) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      lat.lock-&gt;unlock();</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      fh-&gt;mtx.unlock();</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">goto</span> retry; <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">/* LATCHED, LOCKED */</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">if</span> (! (flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a151c7b6a6f016e56104020cfbecb2b88">RGWFileHandle::FLAG_LOCK</a>))</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      fh-&gt;mtx.unlock(); <span class="comment">/* ! LOCKED */</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">/* make or re-use handle */</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle_1_1Factory.html">RGWFileHandle::Factory</a> prototype(<span class="keyword">this</span>, get_inst(), parent, fhk,</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                     obj_name, <a class="code" href="rgw__file_8h.html#a35b722e79e5cbfc3e70c42dc67657534">CREATE_FLAGS</a>(flags));</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    fh = <span class="keyword">static_cast&lt;</span><a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      fh_lru.insert(&amp;prototype,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            cohort::lru::Edge::MRU,</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            cohort::lru::FLAG_INITIAL));</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">if</span> (fh) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="comment">/* lock fh (LATCHED) */</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">if</span> (flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a151c7b6a6f016e56104020cfbecb2b88">RGWFileHandle::FLAG_LOCK</a>)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        fh-&gt;mtx.lock();</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="comment">/* inserts, releasing latch */</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      fh_cache.insert_latched(fh, lat, RGWFileHandle::FHCache::FLAG_UNLOCK);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      get&lt;1&gt;(fhr) |= <a class="code" href="classrgw_1_1RGWFileHandle.html#a0031684e510e759fa1c1b0ca68b9794e">RGWFileHandle::FLAG_CREATE</a>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">goto</span> out; <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      lat.lock-&gt;unlock();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">goto</span> retry; <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      lat.lock-&gt;unlock(); <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    out:</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      get&lt;0&gt;(fhr) = fh;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">return</span> fhr;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#aee335d52eb05461a644505a4fba5277d">  878</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWLibFS.html#aee335d52eb05461a644505a4fba5277d">unref</a>(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* fh) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      (void) fh_lru.unref(fh, cohort::lru::FLAG_NONE);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a78f3128f52285ce46b68407fb6edc769">  882</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWLibFS.html#a78f3128f52285ce46b68407fb6edc769">ref</a>(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* fh) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      fh_lru.ref(fh, cohort::lru::FLAG_NONE);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">return</span> fh;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordtype">int</span> getattr(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* rgw_fh, <span class="keyword">struct</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a>* st);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="namespacergw.html#a91c107b9a28ca60c4777c28cf5f59632">LookupFHResult</a> stat_bucket(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent,</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">char</span> *path, uint32_t flags);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <a class="code" href="namespacergw.html#a91c107b9a28ca60c4777c28cf5f59632">LookupFHResult</a> stat_leaf(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                 uint32_t flags);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">int</span> read(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* rgw_fh, uint64_t offset, <span class="keywordtype">size_t</span> length,</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;         <span class="keywordtype">size_t</span>* bytes_read, <span class="keywordtype">void</span>* buffer, uint32_t flags);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordtype">int</span> rename(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* old_fh, <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* new_fh,</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;           <span class="keyword">const</span> <span class="keywordtype">char</span> *old_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *new_name);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="namespacergw.html#a925f71101c6109eaabbbf4d65c591c5d">MkObjResult</a> create(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">struct</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a> *st,</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;              uint32_t mask, uint32_t flags);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="namespacergw.html#a925f71101c6109eaabbbf4d65c591c5d">MkObjResult</a> mkdir(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">struct</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a> *st,</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;              uint32_t mask, uint32_t flags);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="namespacergw.html#a925f71101c6109eaabbbf4d65c591c5d">MkObjResult</a> mkdir2(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">struct</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">stat</a> *st,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;              uint32_t mask, uint32_t flags);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordtype">int</span> unlink(<a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">/* find existing RGWFileHandle */</span></div>
<div class="line"><a name="l00912"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a54119250286cc55abb58e66bbe65eeed">  912</a></span>&#160;    <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWLibFS.html#a54119250286cc55abb58e66bbe65eeed">lookup_handle</a>(<span class="keyword">struct</span> rgw_fh_hk fh_hk) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">if</span> (state.flags &amp; FLAG_CLOSED)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      RGWFileHandle::FHCache::Latch lat;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <a class="code" href="structrgw_1_1fh__key.html">fh_key</a> fhk(fh_hk);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    retry:</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* fh =</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    fh_cache.find_latch(fhk.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object <span class="comment">/* partition selector*/</span>,</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                fhk <span class="comment">/* key */</span>, lat <span class="comment">/* serializer */</span>,</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                RGWFileHandle::FHCache::FLAG_LOCK);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="comment">/* LATCHED */</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">if</span> (! fh) {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    lsubdout(get_context(), rgw, 0)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot; handle lookup failed &lt;&quot;</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      &lt;&lt; fhk.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.bucket &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; fhk.<a class="code" href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">fh_hk</a>.object &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;(need persistent handles)&quot;</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      &lt;&lt; dendl;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      fh-&gt;mtx.lock();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keywordflow">if</span> (fh-&gt;flags &amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#a8fa75a2cf243f79875cf08c73d0f389c">RGWFileHandle::FLAG_DELETED</a>) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">/* for now, delay briefly and retry */</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    lat.lock-&gt;unlock();</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    fh-&gt;mtx.unlock();</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    std::this_thread::sleep_for(std::chrono::milliseconds(20));</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">goto</span> retry; <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">if</span> (! fh_lru.ref(fh, cohort::lru::FLAG_INITIAL)) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    lat.lock-&gt;unlock();</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    fh-&gt;mtx.unlock();</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">goto</span> retry; <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="comment">/* LATCHED */</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    out:</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      lat.lock-&gt;unlock(); <span class="comment">/* !LATCHED */</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordflow">return</span> fh;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a50e404a5fed170b5e1d2d0e854ccba5a">  953</a></span>&#160;    CephContext* <a class="code" href="classrgw_1_1RGWLibFS.html#a50e404a5fed170b5e1d2d0e854ccba5a">get_context</a>() {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">return</span> cct;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a06e29dc1d70d9f8d354e12ff32d442a4">  957</a></span>&#160;    <span class="keyword">struct </span>rgw_fs* <a class="code" href="classrgw_1_1RGWLibFS.html#a06e29dc1d70d9f8d354e12ff32d442a4">get_fs</a>() { <span class="keywordflow">return</span> &amp;fs; }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#a7b953f6ab9112622a016e61d4da98f04">  959</a></span>&#160;    uint32_t <a class="code" href="classrgw_1_1RGWLibFS.html#a7b953f6ab9112622a016e61d4da98f04">get_inst</a>() { <span class="keywordflow">return</span> fs_inst; }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWLibFS.html#aa1c7c83992e6a23a3c173e492b52e792">  961</a></span>&#160;    <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a>* <a class="code" href="classrgw_1_1RGWLibFS.html#aa1c7c83992e6a23a3c173e492b52e792">get_user</a>() { <span class="keywordflow">return</span> &amp;user; }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWFileHandle.html#ac619fb7838374169af1b34a4f8a1dcad">close</a>();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordtype">void</span> gc();</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  }; <span class="comment">/* RGWLibFS */</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">  967</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> std::string <a class="code" href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">make_uri</a>(<span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>,</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                   <span class="keyword">const</span> std::string&amp; object_name) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  std::string uri(<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  uri.reserve(bucket_name.length() + object_name.length() + 2);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  uri += <a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  uri += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  uri += <a class="code" href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">object_name</a>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">return</span> uri;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;}</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">  read directory content (buckets)</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00981"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html">  981</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWListBucketsRequest.html">RGWListBucketsRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                  <span class="keyword">public</span> <a class="code" href="classRGWListBuckets.html">RGWListBuckets</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;{</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00985"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a1c63eb2c03904d626e62a8401be1b92c">  985</a></span>&#160;  <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a1c63eb2c03904d626e62a8401be1b92c">rgw_fh</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a4b58f97c5a957b6c19c22ea9118e723e">  986</a></span>&#160;  uint64_t* <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a4b58f97c5a957b6c19c22ea9118e723e">offset</a>;</div>
<div class="line"><a name="l00987"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a3bd92a8779e0278b55f728ce4a423b84">  987</a></span>&#160;  <span class="keywordtype">void</span>* <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a3bd92a8779e0278b55f728ce4a423b84">cb_arg</a>;</div>
<div class="line"><a name="l00988"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#add7324e84d5ebafd1e1a086bd4813800">  988</a></span>&#160;  rgw_readdir_cb <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#add7324e84d5ebafd1e1a086bd4813800">rcb</a>;</div>
<div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a5bc97911889f7a3d1ca866c894d5e6bc">  989</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a5bc97911889f7a3d1ca866c894d5e6bc">ix</a>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#af77e2766023d950170fb214170e35a44">  991</a></span>&#160;  <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#af77e2766023d950170fb214170e35a44">RGWListBucketsRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _rgw_fh, rgw_readdir_cb _rcb,</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordtype">void</span>* _cb_arg, uint64_t* _offset)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), rgw_fh(_rgw_fh), offset(_offset),</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      cb_arg(_cb_arg), rcb(_rcb), ix(0) {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keyword">const</span> std::string&amp; sm = rgw_fh-&gt;find_marker(*offset);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (sm.size() &gt; 0) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <a class="code" href="classRGWListBuckets.html#a66dc6625c4e6826b95533f1549c52933">RGWListBuckets::marker</a> =</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    rgw_fh-&gt;relative_object_name();</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">if</span> (marker.back() != <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    marker += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      marker += sm;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a1c5355b578c682ebecb084c43d88a092"> 1007</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a1c5355b578c682ebecb084c43d88a092">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a9c48e1a236adb4908aaf4027f3dba8d6"> 1009</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a9c48e1a236adb4908aaf4027f3dba8d6">op_init</a>() {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a1a0d30cca4b985877e11539a90777fc0"> 1020</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a1a0d30cca4b985877e11539a90777fc0">header_init</a>() {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;GET&quot;</span>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef">OP_GET</a>;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = <span class="stringliteral">&quot;/&quot;</span>; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div>
<div class="line"><a name="l01038"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a8a8f25f47b9b792d72a54952b00f622b"> 1038</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a8a8f25f47b9b792d72a54952b00f622b">get_params</a>() {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    limit = -1; <span class="comment">/* no limit */</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a2000cc05c28804e04a10620eab3bdf53"> 1043</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a2000cc05c28804e04a10620eab3bdf53">send_response_begin</a>(<span class="keywordtype">bool</span> has_buckets) {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    sent_data = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a384688b20c1b8f4bbb9aaff335239963"> 1047</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a384688b20c1b8f4bbb9aaff335239963">send_response_data</a>(<a class="code" href="classRGWUserBuckets.html">RGWUserBuckets</a>&amp; buckets) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span> (!sent_data)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    map&lt;string, RGWBucketEnt&gt;&amp; m = buckets.<a class="code" href="classRGWUserBuckets.html#ad54feabb52e471a9cacdbaca4828b9e6">get_buckets</a>();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; iter : m) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      boost::string_ref marker{iter.first};</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keyword">const</span> <a class="code" href="structRGWBucketEnt.html">RGWBucketEnt</a>&amp; ent = iter.second;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="comment">/* call me maybe */</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      this-&gt;operator()(ent.<a class="code" href="structRGWBucketEnt.html#af8b9ef66b40a78862007e883847da902">bucket</a>.<a class="code" href="structrgw__bucket.html#a32d3529f5b0c53051c856a7abe867a6b">name</a>, marker);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      ++ix;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  } <span class="comment">/* send_response_data */</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a1696d5967f7de8188ca2a865a5be7860"> 1060</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a1696d5967f7de8188ca2a865a5be7860">send_response_end</a>() {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">// do nothing</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#acd23b102146d3824cd32522368d5a103"> 1064</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#acd23b102146d3824cd32522368d5a103">operator()</a>(<span class="keyword">const</span> boost::string_ref&amp; name, <span class="keyword">const</span> boost::string_ref&amp; marker) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    uint64_t off = XXH64(name.data(), name.length(), <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">fh_key::seed</a>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    *offset = off;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">/* update traversal cache */</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    rgw_fh-&gt;add_marker(off, marker, RGW_FS_TYPE_DIRECTORY);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    rcb(name.data(), cb_arg, off);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWListBucketsRequest.html#a5468d199ae9fb3ad111d5ccfc6f99987"> 1073</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWListBucketsRequest.html#a5468d199ae9fb3ad111d5ccfc6f99987">eof</a>() {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;READDIR offset: &quot;</span> &lt;&lt; *offset</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; is_truncated: &quot;</span> &lt;&lt; is_truncated</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;               &lt;&lt; dendl;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keywordflow">return</span> !is_truncated;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;}; <span class="comment">/* RGWListBucketsRequest */</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">  read directory content (bucket objects)</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html"> 1086</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classrgw_1_1RGWReaddirRequest.html">RGWReaddirRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                <span class="keyword">public</span> <a class="code" href="classRGWListBucket.html">RGWListBucket</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01090"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a34f5489c4294a9f4cdc4c7ab8ebd2aba"> 1090</a></span>&#160;  <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a34f5489c4294a9f4cdc4c7ab8ebd2aba">rgw_fh</a>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#adb2260d509358fc9005c888215716a1e"> 1091</a></span>&#160;  uint64_t* <a class="code" href="classrgw_1_1RGWReaddirRequest.html#adb2260d509358fc9005c888215716a1e">offset</a>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a0ebf39f3499094b272e65f01ad2d7c2b"> 1092</a></span>&#160;  <span class="keywordtype">void</span>* <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a0ebf39f3499094b272e65f01ad2d7c2b">cb_arg</a>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a03a640cceaa49b1f4ad1bb83f5ca38c7"> 1093</a></span>&#160;  rgw_readdir_cb <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a03a640cceaa49b1f4ad1bb83f5ca38c7">rcb</a>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a4404a624ce339723e971b7efda896320"> 1094</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a4404a624ce339723e971b7efda896320">ix</a>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div>
<div class="line"><a name="l01096"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a33b3d789c4a3846d1a8e45f204dd3965"> 1096</a></span>&#160;  <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a33b3d789c4a3846d1a8e45f204dd3965">RGWReaddirRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _rgw_fh, rgw_readdir_cb _rcb,</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            <span class="keywordtype">void</span>* _cb_arg, uint64_t* _offset)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), rgw_fh(_rgw_fh), offset(_offset),</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      cb_arg(_cb_arg), rcb(_rcb), ix(0) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keyword">const</span> std::string&amp; sm{rgw_fh-&gt;find_marker(*offset)};</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (sm.size() &gt; 0) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <a class="code" href="classRGWListBucket.html#a7bbc1bc7753426838b6afd4bed02ba18">RGWListBucket::marker</a> = {rgw_fh-&gt;relative_object_name(), <span class="stringliteral">&quot;&quot;</span>};</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <span class="keywordflow">if</span> (marker.name.back() != <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    marker.<a class="code" href="structrgw__obj__key.html#ab51adda0cbbec2ff9230b9ffe100e939">name</a> += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      marker.name += sm;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    default_max = 1000; <span class="comment">// XXX was being omitted</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#ab13bc9ef929d3086309c6c7a628f2109"> 1112</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#ab13bc9ef929d3086309c6c7a628f2109">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div>
<div class="line"><a name="l01114"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#ac822b22859f84477184a5b1687217e3e"> 1114</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#ac822b22859f84477184a5b1687217e3e">op_init</a>() {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div>
<div class="line"><a name="l01125"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a4bc2cbff1ac3bbee35143ad22dc2195a"> 1125</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a4bc2cbff1ac3bbee35143ad22dc2195a">header_init</a>() {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;GET&quot;</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef">OP_GET</a>;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    std::string uri = <span class="stringliteral">&quot;/&quot;</span> + rgw_fh-&gt;bucket_name() + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    prefix = rgw_fh-&gt;relative_object_name();</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">if</span> (prefix.length() &gt; 0)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      prefix += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    delimiter = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a8ddc1064088ed47d6e08b91e032a24e9"> 1149</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a8ddc1064088ed47d6e08b91e032a24e9">operator()</a>(<span class="keyword">const</span> boost::string_ref name, <span class="keyword">const</span> boost::string_ref marker,</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        uint8_t type) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    assert(name.length() &gt; 0); <span class="comment">// XXX</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">/* hash offset of name in parent (short name) for NFS readdir cookie */</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    uint64_t off = XXH64(name.data(), name.length(), <a class="code" href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">fh_key::seed</a>);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    *offset = off;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">/* update traversal cache */</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    rgw_fh-&gt;add_marker(off, marker, type);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    rcb(name.data(), cb_arg, off); <span class="comment">// XXX has to be legit C-style string</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a7e6e4915dde31751b138eccd3e83ce49"> 1163</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a7e6e4915dde31751b138eccd3e83ce49">get_params</a>() {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    max = default_max;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#a63f223c029b152d713934935322fa564"> 1168</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#a63f223c029b152d713934935322fa564">send_response</a>() {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; iter : objs) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      boost::string_ref sref {iter.key.name};</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;readdir objects prefix: &quot;</span> &lt;&lt; prefix</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; obj: &quot;</span> &lt;&lt; sref &lt;&lt; dendl;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordtype">size_t</span> last_del = sref.find_last_of(<span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">if</span> (last_del != string::npos)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    sref.remove_prefix(last_del+1);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="comment">/* leaf directory? */</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keywordflow">if</span> (sref.empty())</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;RGWReaddirRequest &quot;</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                 &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;list uri=&quot;</span> &lt;&lt; s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; prefix=&quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; obj path=&quot;</span> &lt;&lt; iter.key.name</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; sref &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                 &lt;&lt; dendl;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="comment">/* call me maybe */</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      this-&gt;operator()(sref, sref, RGW_FS_TYPE_FILE);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      ++ix;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; iter : common_prefixes) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;readdir common prefixes prefix: &quot;</span> &lt;&lt; prefix</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; iter first: &quot;</span> &lt;&lt; iter.first</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; iter second: &quot;</span> &lt;&lt; iter.second</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                 &lt;&lt; dendl;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="comment">/* XXX aieee--I have seen this case! */</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">if</span> (iter.first == <span class="stringliteral">&quot;/&quot;</span>)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="comment">/* it&#39;s safest to modify the element in place--a suffix-modifying</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">       * string_ref operation is problematic since ULP rgw_file callers</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">       * will ultimately need a c-string */</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">if</span> (iter.first.back() == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    const_cast&lt;std::string&amp;&gt;(iter.first).pop_back();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      boost::string_ref sref{iter.first};</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="keywordtype">size_t</span> last_del = sref.find_last_of(<span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="keywordflow">if</span> (last_del != string::npos)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    sref.remove_prefix(last_del+1);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;RGWReaddirRequest &quot;</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                 &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;list uri=&quot;</span> &lt;&lt; s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; prefix=&quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; cpref=&quot;</span> &lt;&lt; sref</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                 &lt;&lt; dendl;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      this-&gt;operator()(sref, sref, RGW_FS_TYPE_DIRECTORY);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      ++ix;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div>
<div class="line"><a name="l01232"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#abb541000a93595345b11acfcc3788b7a"> 1232</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#abb541000a93595345b11acfcc3788b7a">send_versioned_response</a>() {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    send_response();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div>
<div class="line"><a name="l01236"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReaddirRequest.html#aae3f049bc766084ab850ee99004d35a7"> 1236</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWReaddirRequest.html#aae3f049bc766084ab850ee99004d35a7">eof</a>() {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;READDIR offset: &quot;</span> &lt;&lt; *offset</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; next marker: &quot;</span> &lt;&lt; next_marker</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; is_truncated: &quot;</span> &lt;&lt; is_truncated</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;               &lt;&lt; dendl;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">return</span> !is_truncated;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;}; <span class="comment">/* RGWReaddirRequest */</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">  create bucket</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div>
<div class="line"><a name="l01250"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html"> 1250</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWCreateBucketRequest.html">RGWCreateBucketRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                   <span class="keyword">public</span> <a class="code" href="classRGWCreateBucket.html">RGWCreateBucket</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;{</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01254"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#a13bc87810d8a55e5743d31b5a58a9f6c"> 1254</a></span>&#160;  std::string&amp; <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#a13bc87810d8a55e5743d31b5a58a9f6c">uri</a>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#a481b1d6f5e3d84c8a5001baf730deff9"> 1256</a></span>&#160;  <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#a481b1d6f5e3d84c8a5001baf730deff9">RGWCreateBucketRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            std::string&amp; _uri)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), uri(_uri) {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div>
<div class="line"><a name="l01262"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#ae20d65cdd62acaebcf0ab7f7ed215a02"> 1262</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#ae20d65cdd62acaebcf0ab7f7ed215a02">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div>
<div class="line"><a name="l01264"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#a849c7a7c8f7d00b5e61083b05165e87d"> 1264</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#a849c7a7c8f7d00b5e61083b05165e87d">read_permissions</a>(<a class="code" href="classRGWOp.html">RGWOp</a>* op_obj) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="comment">/* we ARE a &#39;create bucket&#39; request (cf. rgw_rest.cc, ll. 1305-6) */</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div>
<div class="line"><a name="l01269"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#ab009ed381323d032ac450c411231e52d"> 1269</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#ab009ed381323d032ac450c411231e52d">op_init</a>() {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#a379d790bd6b1b600af0308f7dbf8c867"> 1280</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#a379d790bd6b1b600af0308f7dbf8c867">header_init</a>() {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;PUT&quot;</span>;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa6457b8e3f30573b55e842c5e420b3b2d">OP_PUT</a>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#a9170fe5349f00f4860d4a6aa1c067f3e"> 1299</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#a9170fe5349f00f4860d4a6aa1c067f3e">get_params</a>() {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="classRGWAccessControlPolicy__S3.html">RGWAccessControlPolicy_S3</a> s3policy(s-&gt;<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">/* we don&#39;t have (any) headers, so just create canned ACLs */</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordtype">int</span> ret = s3policy.<a class="code" href="classRGWAccessControlPolicy__S3.html#ad399d9d60a8eb4759bcdf2a6e36488be">create_canned</a>(s-&gt;<a class="code" href="structreq__state.html#a2eec9247ec43945a83fd1004b9f7ee74">owner</a>, s-&gt;<a class="code" href="structreq__state.html#a2fd0c760203508360c7b9ac16993b040">bucket_owner</a>, s-&gt;<a class="code" href="structreq__state.html#a0cdf9b9ab810c7c03aa0dd1ab6529bf1">canned_acl</a>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    policy = s3policy;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCreateBucketRequest.html#a4a00892570c705783e99c5f07b83f2bf"> 1308</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWCreateBucketRequest.html#a4a00892570c705783e99c5f07b83f2bf">send_response</a>() {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">/* TODO: something (maybe) */</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;}; <span class="comment">/* RGWCreateBucketRequest */</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">  delete bucket</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteBucketRequest.html"> 1317</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWDeleteBucketRequest.html">RGWDeleteBucketRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                   <span class="keyword">public</span> <a class="code" href="classRGWDeleteBucket.html">RGWDeleteBucket</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;{</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01321"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteBucketRequest.html#a9132b1799bda88fbfb22f7676639ad59"> 1321</a></span>&#160;  std::string&amp; <a class="code" href="classrgw_1_1RGWDeleteBucketRequest.html#a9132b1799bda88fbfb22f7676639ad59">uri</a>;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div>
<div class="line"><a name="l01323"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteBucketRequest.html#ad5443913be99cab0e5e201636d84735a"> 1323</a></span>&#160;  <a class="code" href="classrgw_1_1RGWDeleteBucketRequest.html#ad5443913be99cab0e5e201636d84735a">RGWDeleteBucketRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            std::string&amp; _uri)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), uri(_uri) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteBucketRequest.html#a7dce96da3bc3b09b7d1ffa4f16d7f246"> 1329</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWDeleteBucketRequest.html#a7dce96da3bc3b09b7d1ffa4f16d7f246">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteBucketRequest.html#a8ead1c1736f3201e08c8d3114e56ac7a"> 1331</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWDeleteBucketRequest.html#a8ead1c1736f3201e08c8d3114e56ac7a">op_init</a>() {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div>
<div class="line"><a name="l01342"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteBucketRequest.html#a2f8c1590e3619dd4974ec8de838dea94"> 1342</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWDeleteBucketRequest.html#a2f8c1590e3619dd4974ec8de838dea94">header_init</a>() {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;DELETE&quot;</span>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa4c629f6a90286b343e3f222ff96f94d5">OP_DELETE</a>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01361"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteBucketRequest.html#a930f5926835a32d837d6832e4f8cd6b0"> 1361</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWDeleteBucketRequest.html#a930f5926835a32d837d6832e4f8cd6b0">send_response</a>() {}</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;}; <span class="comment">/* RGWDeleteBucketRequest */</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">  put object</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html"> 1368</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWPutObjRequest.html">RGWPutObjRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;             <span class="keyword">public</span> <a class="code" href="classRGWPutObj.html">RGWPutObj</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;{</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01372"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#aeed07fa4752cee6e336928dbd82d0da2"> 1372</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWPutObjRequest.html#aeed07fa4752cee6e336928dbd82d0da2">bucket_name</a>;</div>
<div class="line"><a name="l01373"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a6d82c82553a2d36a46974820698a5297"> 1373</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a6d82c82553a2d36a46974820698a5297">obj_name</a>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a5f5beb4dc8e4a3059e3741892a1f5975"> 1374</a></span>&#160;  buffer::list&amp; <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a5f5beb4dc8e4a3059e3741892a1f5975">bl</a>; <span class="comment">/* XXX */</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a4354374934d98f843297d5fff4ab944c"> 1375</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a4354374934d98f843297d5fff4ab944c">bytes_written</a>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a17ddbb2124507ba5c9f7bc64451530cf"> 1377</a></span>&#160;  <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a17ddbb2124507ba5c9f7bc64451530cf">RGWPutObjRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;          <span class="keyword">const</span> std::string&amp; _bname, <span class="keyword">const</span> std::string&amp; _oname,</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;          buffer::list&amp; _bl)</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), <a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>(_bname), obj_name(_oname),</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      bl(_bl), bytes_written(0) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a4e5dc35045883cf9d7a3a4b67da61811"> 1385</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a4e5dc35045883cf9d7a3a4b67da61811">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div>
<div class="line"><a name="l01387"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a79596ceceab1a58961671ad172a1d96d"> 1387</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a79596ceceab1a58961671ad172a1d96d">op_init</a>() {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">if</span> (! <a class="code" href="rgw__rest__s3_8h.html#afc5d7366f67380e0de2809c98048e8ec">valid_s3_object_name</a>(obj_name))</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="keywordflow">return</span> -<a class="code" href="rgw__common_8h.html#aff282dca44d2cd446fd499b24852d25e">ERR_INVALID_OBJECT_NAME</a>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div>
<div class="line"><a name="l01402"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a4e589d393da9c14ec4d9261653dad378"> 1402</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a4e589d393da9c14ec4d9261653dad378">header_init</a>() {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;PUT&quot;</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa6457b8e3f30573b55e842c5e420b3b2d">OP_PUT</a>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    std::string uri = <a class="code" href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">make_uri</a>(<a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>, obj_name);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">/* XXX required in RGWOp::execute() */</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a91f76afcb55eebb4b794cc1be7dacacf">content_length</a> = bl.length();</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#af645846abee26af6fb90fafeb728c4fc"> 1425</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#af645846abee26af6fb90fafeb728c4fc">get_params</a>() {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <a class="code" href="classRGWAccessControlPolicy__S3.html">RGWAccessControlPolicy_S3</a> s3policy(s-&gt;<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="comment">/* we don&#39;t have (any) headers, so just create canned ACLs */</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordtype">int</span> ret = s3policy.<a class="code" href="classRGWAccessControlPolicy__S3.html#ad399d9d60a8eb4759bcdf2a6e36488be">create_canned</a>(s-&gt;<a class="code" href="structreq__state.html#a2eec9247ec43945a83fd1004b9f7ee74">owner</a>, s-&gt;<a class="code" href="structreq__state.html#a2fd0c760203508360c7b9ac16993b040">bucket_owner</a>, s-&gt;<a class="code" href="structreq__state.html#a0cdf9b9ab810c7c03aa0dd1ab6529bf1">canned_acl</a>);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    policy = s3policy;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div>
<div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a870cf091372837356e1726170e228684"> 1434</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a870cf091372837356e1726170e228684">get_data</a>(buffer::list&amp; _bl) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">/* XXX for now, use sharing semantics */</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    _bl.claim(bl);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    uint32_t len = _bl.length();</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    bytes_written += len;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div>
<div class="line"><a name="l01442"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a98caf495b4be30b835b70697773a433a"> 1442</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a98caf495b4be30b835b70697773a433a">send_response</a>() {}</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div>
<div class="line"><a name="l01444"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWPutObjRequest.html#a3c7b6e87fd1542e1498afb8c83abae9e"> 1444</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWPutObjRequest.html#a3c7b6e87fd1542e1498afb8c83abae9e">verify_params</a>() {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">if</span> (bl.length() &gt; <a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>-&gt;_conf-&gt;rgw_max_put_size)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">return</span> -<a class="code" href="rgw__common_8h.html#aeff4b424dbfa8e3ce7f772f2429198f7">ERR_TOO_LARGE</a>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  }</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;}; <span class="comment">/* RGWPutObjRequest */</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">  get object</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html"> 1456</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWReadRequest.html">RGWReadRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;               <span class="keyword">public</span> <a class="code" href="classRGWGetObj.html">RGWGetObj</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;{</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01460"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a945f24e31d3b6d132a519a94d9ffd9db"> 1460</a></span>&#160;  <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWReadRequest.html#a945f24e31d3b6d132a519a94d9ffd9db">rgw_fh</a>;</div>
<div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#ae3dc139d32c983d341745e5b46c8a70c"> 1461</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="classrgw_1_1RGWReadRequest.html#ae3dc139d32c983d341745e5b46c8a70c">ulp_buffer</a>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#ac59403c289daf71f4cedb53fa0594e93"> 1462</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#ac59403c289daf71f4cedb53fa0594e93">nread</a>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a01013af3b107e3ddef71ceb071379bbf"> 1463</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#a01013af3b107e3ddef71ceb071379bbf">read_resid</a>; <span class="comment">/* initialize to len, &lt;= sizeof(ulp_buffer) */</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a64e8e44c8c7067dc4d1c5e7f56c96356"> 1464</a></span>&#160;  <span class="keywordtype">bool</span> do_hexdump = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#ac4fa589cf8e464c22f57cbb4d36d5748"> 1466</a></span>&#160;  <a class="code" href="classrgw_1_1RGWReadRequest.html#ac4fa589cf8e464c22f57cbb4d36d5748">RGWReadRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;         <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _rgw_fh, uint64_t off, uint64_t len,</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;         <span class="keywordtype">void</span> *_ulp_buffer)</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), rgw_fh(_rgw_fh), ulp_buffer(_ulp_buffer),</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      nread(0), read_resid(len) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">/* fixup RGWGetObj (already know range parameters) */</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <a class="code" href="classRGWGetObj.html#ad223af95b61e98ff878f26c07530ef64">RGWGetObj::range_parsed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <a class="code" href="classRGWGetObj.html#a49461c5f951a732bfc335e7671c57c9e">RGWGetObj::get_data</a> = <span class="keyword">true</span>; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="classRGWGetObj.html#a64c7347d6d84de3796f661d19d7fc619">RGWGetObj::partial_content</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="classRGWGetObj.html#ae72790bc149f70385fcf6ae1dd7a9afb">RGWGetObj::ofs</a> = off;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <a class="code" href="classRGWGetObj.html#ad5e1b827d9220e8c84c2ac2f47298712">RGWGetObj::end</a> = off + len;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div>
<div class="line"><a name="l01481"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a5f175d8808079da3eb511c519652686e"> 1481</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#a5f175d8808079da3eb511c519652686e">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div>
<div class="line"><a name="l01483"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a97f74b6dbbab0ed938b2802ebc22bfe5"> 1483</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#a97f74b6dbbab0ed938b2802ebc22bfe5">op_init</a>() {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a3973ecfd24da048755a879d3bf79002e"> 1494</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#a3973ecfd24da048755a879d3bf79002e">header_init</a>() {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;GET&quot;</span>;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef">OP_GET</a>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = <a class="code" href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">make_uri</a>(rgw_fh-&gt;bucket_name(),</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                   rgw_fh-&gt;relative_object_name());</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a>; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a>;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a32f4a6b773792341c0ef65c9a4a9f10b"> 1514</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#a32f4a6b773792341c0ef65c9a4a9f10b">get_params</a>() {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a048d9c743d05e997636aaea1a89e7aa6"> 1518</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#a048d9c743d05e997636aaea1a89e7aa6">send_response_data</a>(ceph::buffer::list&amp; bl, off_t bl_off,</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                off_t bl_len) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordtype">size_t</span> bytes;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; bp : bl.buffers()) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="comment">/* if for some reason bl_off indicates the start-of-data is not at</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">       * the current buffer::ptr, skip it and account */</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <span class="keywordflow">if</span> (bl_off &gt; bp.length()) {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    bl_off -= bp.length();</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="comment">/* read no more than read_resid */</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      bytes = std::min(read_resid, <span class="keywordtype">size_t</span>(bp.length()-bl_off));</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      memcpy(static_cast&lt;char*&gt;(ulp_buffer)+nread, bp.c_str()+bl_off, bytes);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      read_resid -= bytes; <span class="comment">/* reduce read_resid by bytes read */</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      nread += bytes;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      bl_off = 0;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      <span class="comment">/* stop if we have no residual ulp_buffer */</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <span class="keywordflow">if</span> (! read_resid)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div>
<div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWReadRequest.html#a76bd369cf6dcec239b36e74ff1af9fb6"> 1541</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWReadRequest.html#a76bd369cf6dcec239b36e74ff1af9fb6">send_response_data_error</a>() {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">/* S3 implementation just sends nothing--there is no side effect</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">     * to simulate here */</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;}; <span class="comment">/* RGWReadRequest */</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">  delete object</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div>
<div class="line"><a name="l01553"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html"> 1553</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWDeleteObjRequest.html">RGWDeleteObjRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                <span class="keyword">public</span> <a class="code" href="classRGWDeleteObj.html">RGWDeleteObj</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;{</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01557"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html#ab3bcde7c3f655279719c1ed0848f87bc"> 1557</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWDeleteObjRequest.html#ab3bcde7c3f655279719c1ed0848f87bc">bucket_name</a>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html#ac081f5aa62267d318350640ae322cfc9"> 1558</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWDeleteObjRequest.html#ac081f5aa62267d318350640ae322cfc9">obj_name</a>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div>
<div class="line"><a name="l01560"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html#ad98de60e069e8e6d374a95e407c11bc1"> 1560</a></span>&#160;  <a class="code" href="classrgw_1_1RGWDeleteObjRequest.html#ad98de60e069e8e6d374a95e407c11bc1">RGWDeleteObjRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;              <span class="keyword">const</span> std::string&amp; _bname, <span class="keyword">const</span> std::string&amp; _oname)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), <a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>(_bname), obj_name(_oname) {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html#a38e6fda8301ad1b3c8e53967e44483b8"> 1566</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWDeleteObjRequest.html#a38e6fda8301ad1b3c8e53967e44483b8">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div>
<div class="line"><a name="l01568"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html#a22982d37a8082cb3491aae0f41f879ae"> 1568</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWDeleteObjRequest.html#a22982d37a8082cb3491aae0f41f879ae">op_init</a>() {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  }</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div>
<div class="line"><a name="l01579"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html#a059fa28b78f0b62b21007533d3c8b95c"> 1579</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWDeleteObjRequest.html#a059fa28b78f0b62b21007533d3c8b95c">header_init</a>() {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;DELETE&quot;</span>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa4c629f6a90286b343e3f222ff96f94d5">OP_DELETE</a>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    std::string uri = <a class="code" href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">make_uri</a>(<a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>, obj_name);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div>
<div class="line"><a name="l01599"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWDeleteObjRequest.html#a432839cd0eb1a6747bed32f9f355fbba"> 1599</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWDeleteObjRequest.html#a432839cd0eb1a6747bed32f9f355fbba">send_response</a>() {}</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;}; <span class="comment">/* RGWDeleteObjRequest */</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html"> 1603</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWStatObjRequest.html">RGWStatObjRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;              <span class="keyword">public</span> <a class="code" href="classRGWGetObj.html">RGWGetObj</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;{</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a88e9c8f5c6248962b5ba3f119d78aae8"> 1607</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a88e9c8f5c6248962b5ba3f119d78aae8">bucket_name</a>;</div>
<div class="line"><a name="l01608"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a6a34d12d6a3ec0c2b653d3017739e811"> 1608</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a6a34d12d6a3ec0c2b653d3017739e811">obj_name</a>;</div>
<div class="line"><a name="l01609"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a732a49b095a04049e7bbe89945fa27e5"> 1609</a></span>&#160;  uint64_t <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a732a49b095a04049e7bbe89945fa27e5">_size</a>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a3355ad2383f1c16ae3dc620d9171d8f0"> 1610</a></span>&#160;  uint32_t <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a3355ad2383f1c16ae3dc620d9171d8f0">flags</a>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div>
<div class="line"><a name="l01612"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#acf74119848444d075e2417331ac3b987"> 1612</a></span>&#160;  <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">FLAG_NONE</a> = 0x000;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div>
<div class="line"><a name="l01614"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a5dce1d9833563e362de228ec08953106"> 1614</a></span>&#160;  <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a5dce1d9833563e362de228ec08953106">RGWStatObjRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="keyword">const</span> std::string&amp; _bname, <span class="keyword">const</span> std::string&amp; _oname,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            uint32_t _flags)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), <a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>(_bname), obj_name(_oname),</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      _size(0), flags(_flags) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">/* fixup RGWGetObj (already know range parameters) */</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <a class="code" href="classRGWGetObj.html#ad223af95b61e98ff878f26c07530ef64">RGWGetObj::range_parsed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <a class="code" href="classRGWGetObj.html#a49461c5f951a732bfc335e7671c57c9e">RGWGetObj::get_data</a> = <span class="keyword">false</span>; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <a class="code" href="classRGWGetObj.html#a64c7347d6d84de3796f661d19d7fc619">RGWGetObj::partial_content</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <a class="code" href="classRGWGetObj.html#ae72790bc149f70385fcf6ae1dd7a9afb">RGWGetObj::ofs</a> = 0;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <a class="code" href="classRGWGetObj.html#ad5e1b827d9220e8c84c2ac2f47298712">RGWGetObj::end</a> = UINT64_MAX;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a5ee74e590bf7349c0cd1e08cb6ecd4e3"> 1629</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a5ee74e590bf7349c0cd1e08cb6ecd4e3">name</a>() { <span class="keywordflow">return</span> <span class="stringliteral">&quot;stat_obj&quot;</span>; }</div>
<div class="line"><a name="l01630"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#aa35641c2c5b4775d8bbaa9fcd54c661a"> 1630</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="rgw__common_8h.html#adedf6eb016de146128a1adb706df37d8">RGWOpType</a> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#aa35641c2c5b4775d8bbaa9fcd54c661a">get_type</a>() { <span class="keywordflow">return</span> <a class="code" href="rgw__common_8h.html#adedf6eb016de146128a1adb706df37d8a2d190385dd5c788f89f49088db67e346">RGW_OP_STAT_OBJ</a>; }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div>
<div class="line"><a name="l01632"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a338050595eedd61cc22426ba39768171"> 1632</a></span>&#160;  real_time <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a338050595eedd61cc22426ba39768171">get_mtime</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordflow">return</span> lastmod;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="comment">/* attributes */</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a5c508c2e29bda304a78cc81982ab65ef"> 1637</a></span>&#160;  uint64_t <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a5c508c2e29bda304a78cc81982ab65ef">get_size</a>() { <span class="keywordflow">return</span> _size; }</div>
<div class="line"><a name="l01638"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a151afda8d1acaca77e40017601818899"> 1638</a></span>&#160;  real_time <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a151afda8d1acaca77e40017601818899">ctime</a>() { <span class="keywordflow">return</span> mod_time; } <span class="comment">// XXX</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#afaf9f23d968b80f2894d9e84691df8a8"> 1639</a></span>&#160;  real_time <a class="code" href="classrgw_1_1RGWStatObjRequest.html#afaf9f23d968b80f2894d9e84691df8a8">mtime</a>() { <span class="keywordflow">return</span> mod_time; }</div>
<div class="line"><a name="l01640"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a0ada6e62d933f1ab05fe18c4e8e5c9bd"> 1640</a></span>&#160;  std::map&lt;string, bufferlist&gt;&amp; <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a0ada6e62d933f1ab05fe18c4e8e5c9bd">get_attrs</a>() { <span class="keywordflow">return</span> attrs; }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div>
<div class="line"><a name="l01642"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#ab611e3e26cc44d913c5403bfb757ea69"> 1642</a></span>&#160;  buffer::list* <a class="code" href="classrgw_1_1RGWStatObjRequest.html#ab611e3e26cc44d913c5403bfb757ea69">get_attr</a>(<span class="keyword">const</span> std::string&amp; k) {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keyword">auto</span> iter = attrs.find(k);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">return</span> (iter != attrs.end()) ? &amp;(iter-&gt;second) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01647"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a5f7f65038ea8ec242a0a7a308f28f861"> 1647</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a5f7f65038ea8ec242a0a7a308f28f861">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div>
<div class="line"><a name="l01649"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#aa2dcd425fa591b0b4b2d05b71f9a4f5b"> 1649</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#aa2dcd425fa591b0b4b2d05b71f9a4f5b">op_init</a>() {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div>
<div class="line"><a name="l01660"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#ade88b3b8ef261a29036904cafd935ce3"> 1660</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#ade88b3b8ef261a29036904cafd935ce3">header_init</a>() {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;GET&quot;</span>;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef">OP_GET</a>;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = <a class="code" href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">make_uri</a>(<a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>, obj_name);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a>; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a>;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  }</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a8d712dfbcebd78e6c33b0e92359f5be2"> 1679</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a8d712dfbcebd78e6c33b0e92359f5be2">get_params</a>() {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#ae7703b5ff67da9d27369e448ace4180b"> 1683</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#ae7703b5ff67da9d27369e448ace4180b">send_response_data</a>(ceph::buffer::list&amp; _bl, off_t s_off,</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                off_t e_off) {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">/* NOP */</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="comment">/* XXX save attrs? */</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#aeaf06ce869fba5c3bf85f29343359f3d"> 1690</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#aeaf06ce869fba5c3bf85f29343359f3d">send_response_data_error</a>() {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="comment">/* NOP */</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div>
<div class="line"><a name="l01695"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatObjRequest.html#a0bb687662e26e56ad9c238dae44a8974"> 1695</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWStatObjRequest.html#a0bb687662e26e56ad9c238dae44a8974">execute</a>() {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="classRGWGetObj.html#a9c8656dea08180704b7a7a1ee8671929">RGWGetObj::execute</a>();</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    _size = get_state()-&gt;obj_size;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;}; <span class="comment">/* RGWStatObjRequest */</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html"> 1702</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWStatBucketRequest.html">RGWStatBucketRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                 <span class="keyword">public</span> <a class="code" href="classRGWStatBucket.html">RGWStatBucket</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;{</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01706"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#ab24567ae4df5a9c208e6923179ba5e72"> 1706</a></span>&#160;  std::string <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#ab24567ae4df5a9c208e6923179ba5e72">uri</a>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#a486e1d3e6a16e4f72d5540b83ff5d979"> 1707</a></span>&#160;  std::map&lt;std::string, buffer::list&gt; <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#a486e1d3e6a16e4f72d5540b83ff5d979">attrs</a>;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div>
<div class="line"><a name="l01709"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#a45f6a11394ad0b6130e17d58880b44f2"> 1709</a></span>&#160;  <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#a45f6a11394ad0b6130e17d58880b44f2">RGWStatBucketRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;               <span class="keyword">const</span> std::string&amp; _path)</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user) {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    uri = <span class="stringliteral">&quot;/&quot;</span> + _path;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#af9ce32310ec7b44b014b1259dc6132b0"> 1716</a></span>&#160;  buffer::list* <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#af9ce32310ec7b44b014b1259dc6132b0">get_attr</a>(<span class="keyword">const</span> std::string&amp; k) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keyword">auto</span> iter = attrs.find(k);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keywordflow">return</span> (iter != attrs.end()) ? &amp;(iter-&gt;second) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#a1e07b5b0976846e3e5464ab59df80f0a"> 1721</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#a1e07b5b0976846e3e5464ab59df80f0a">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div>
<div class="line"><a name="l01723"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#ac9db0c9f03992c41ad65af12ac8fb13a"> 1723</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#ac9db0c9f03992c41ad65af12ac8fb13a">op_init</a>() {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div>
<div class="line"><a name="l01734"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#a96fb26151ff0cb4425b9fc6deb3f1e04"> 1734</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#a96fb26151ff0cb4425b9fc6deb3f1e04">header_init</a>() {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;GET&quot;</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef">OP_GET</a>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div>
<div class="line"><a name="l01753"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#a307f06a04702dc42db82dd6114b0ae0c"> 1753</a></span>&#160;  real_time <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#a307f06a04702dc42db82dd6114b0ae0c">get_ctime</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structreq__state.html#aff7ec1d9130564f00e60adbef589925a">bucket</a>.creation_time;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#aca6d7c27dedbe28fd4584db4e804af32"> 1757</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#aca6d7c27dedbe28fd4584db4e804af32">get_params</a>() {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  }</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div>
<div class="line"><a name="l01761"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#aabc2bc87cd873984329527cb888b5c1b"> 1761</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#aabc2bc87cd873984329527cb888b5c1b">send_response</a>() {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="structreq__state.html#aff7ec1d9130564f00e60adbef589925a">bucket</a>.creation_time = get_state()-&gt;bucket_info.creation_time;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    std::swap(attrs, get_state()-&gt;<a class="code" href="structreq__state.html#a39681a359f8083bdf2ca3c058086cce9">bucket_attrs</a>);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatBucketRequest.html#a79236e614f834efe976c69bb2b4bc4ed"> 1766</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWStatBucketRequest.html#a79236e614f834efe976c69bb2b4bc4ed">matched</a>() {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structreq__state.html#aff7ec1d9130564f00e60adbef589925a">bucket</a>.bucket.<a class="code" href="structrgw__bucket.html#a32d3529f5b0c53051c856a7abe867a6b">name</a>.length() &gt; 0);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;}; <span class="comment">/* RGWStatBucketRequest */</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html"> 1772</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWStatLeafRequest.html">RGWStatLeafRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;               <span class="keyword">public</span> <a class="code" href="classRGWListBucket.html">RGWListBucket</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;{</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01776"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#abfe276bd033d1f434448006d50b91678"> 1776</a></span>&#160;  <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#abfe276bd033d1f434448006d50b91678">rgw_fh</a>;</div>
<div class="line"><a name="l01777"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#a9e2343eb99ef71f51646c5ca8e71596c"> 1777</a></span>&#160;  std::string <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#a9e2343eb99ef71f51646c5ca8e71596c">path</a>;</div>
<div class="line"><a name="l01778"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#a21b6eda2d05366278705094b3a46586e"> 1778</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#a21b6eda2d05366278705094b3a46586e">matched</a>;</div>
<div class="line"><a name="l01779"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#a898a1688ddec98ebd1357263cb0ec5f9"> 1779</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#a898a1688ddec98ebd1357263cb0ec5f9">is_dir</a>;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#ac582b6154d850e7b4e9ebf6007ac3e55"> 1781</a></span>&#160;  <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#ac582b6154d850e7b4e9ebf6007ac3e55">RGWStatLeafRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;             <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _rgw_fh, <span class="keyword">const</span> std::string&amp; _path)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), rgw_fh(_rgw_fh), path(_path),</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      matched(false), <a class="code" href="classrgw_1_1RGWFileHandle.html#aee0a7e2a3c4d950261f4bc76eeb8ed8a">is_dir</a>(false) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    default_max = 1000; <span class="comment">// logical max {&quot;foo&quot;, &quot;foo/&quot;}</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#a00777144b9e021b385791a7d93451362"> 1789</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#a00777144b9e021b385791a7d93451362">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#aaa3891c21d317d8f85f843026fa8e21e"> 1791</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#aaa3891c21d317d8f85f843026fa8e21e">op_init</a>() {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  }</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div>
<div class="line"><a name="l01802"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#a146ed5b5b0b228195da2e112feaa39e9"> 1802</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#a146ed5b5b0b228195da2e112feaa39e9">header_init</a>() {</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;GET&quot;</span>;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef">OP_GET</a>;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    std::string uri = <span class="stringliteral">&quot;/&quot;</span> + rgw_fh-&gt;bucket_name() + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    prefix = rgw_fh-&gt;relative_object_name();</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">if</span> (prefix.length() &gt; 0)</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      prefix += <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    prefix += path;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    delimiter = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div>
<div class="line"><a name="l01828"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#a7cb98871f3f6a2b35dd84e00e372d8e4"> 1828</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#a7cb98871f3f6a2b35dd84e00e372d8e4">get_params</a>() {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    max = default_max;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div>
<div class="line"><a name="l01833"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#a37d71b098e09e54279cf799bca037b79"> 1833</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#a37d71b098e09e54279cf799bca037b79">send_response</a>() {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">// try objects</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; iter : objs) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <span class="keyword">auto</span>&amp; name = iter.key.name;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;RGWStatLeafRequest &quot;</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                 &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;list uri=&quot;</span> &lt;&lt; s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; prefix=&quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; obj path=&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                 &lt;&lt; dendl;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <span class="comment">/* XXX is there a missing match-dir case (trailing &#39;/&#39;)? */</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      matched = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">// try prefixes</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; iter : common_prefixes) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      <span class="keyword">auto</span>&amp; name = iter.first;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      lsubdout(<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>, rgw, 15) &lt;&lt; <span class="stringliteral">&quot;RGWStatLeafRequest &quot;</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                 &lt;&lt; __func__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;list uri=&quot;</span> &lt;&lt; s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; prefix=&quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; pref path=&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; (not chomped)&quot;</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                 &lt;&lt; dendl;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      matched = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <a class="code" href="classrgw_1_1RGWFileHandle.html#aee0a7e2a3c4d950261f4bc76eeb8ed8a">is_dir</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;</div>
<div class="line"><a name="l01863"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWStatLeafRequest.html#ab4198fe81558945256401b582e79440e"> 1863</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWStatLeafRequest.html#ab4198fe81558945256401b582e79440e">send_versioned_response</a>() {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    send_response();</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;}; <span class="comment">/* RGWStatLeafRequest */</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">  put object</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html"> 1872</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWWriteRequest.html">RGWWriteRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibContinuedReq.html">RGWLibContinuedReq</a>,</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            <span class="keyword">public</span> <a class="code" href="classRGWPutObj.html">RGWPutObj</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;{</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01876"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a2458fca689a8607e30e8806b03c4d49d"> 1876</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWWriteRequest.html#a2458fca689a8607e30e8806b03c4d49d">bucket_name</a>;</div>
<div class="line"><a name="l01877"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#af701e43f7e66ad6ce6c21d70c53344fe"> 1877</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWWriteRequest.html#af701e43f7e66ad6ce6c21d70c53344fe">obj_name</a>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a5d8fc3081e34fd66e4c13df88e225ddf"> 1878</a></span>&#160;  <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWWriteRequest.html#a5d8fc3081e34fd66e4c13df88e225ddf">rgw_fh</a>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a02f7b04656c4ad9551765cfda6778c25"> 1879</a></span>&#160;  <a class="code" href="classRGWPutObjProcessor.html">RGWPutObjProcessor</a> *<a class="code" href="classrgw_1_1RGWWriteRequest.html#a02f7b04656c4ad9551765cfda6778c25">processor</a>;</div>
<div class="line"><a name="l01880"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a9067bf33363c02e1f8b96ae990ea5f08"> 1880</a></span>&#160;  buffer::list <a class="code" href="classrgw_1_1RGWWriteRequest.html#a9067bf33363c02e1f8b96ae990ea5f08">data</a>;</div>
<div class="line"><a name="l01881"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#acc9d4bb2d37eb0dc82aaf5bb405b037c"> 1881</a></span>&#160;  MD5 <a class="code" href="classrgw_1_1RGWWriteRequest.html#acc9d4bb2d37eb0dc82aaf5bb405b037c">hash</a>;</div>
<div class="line"><a name="l01882"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a982eb7fd86aafb449f56b2c450e45b56"> 1882</a></span>&#160;  off_t <a class="code" href="classrgw_1_1RGWWriteRequest.html#a982eb7fd86aafb449f56b2c450e45b56">last_off</a>;</div>
<div class="line"><a name="l01883"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#ae002efce3e6c15b881b179c47115d551"> 1883</a></span>&#160;  off_t <a class="code" href="classrgw_1_1RGWWriteRequest.html#ae002efce3e6c15b881b179c47115d551">next_off</a>;</div>
<div class="line"><a name="l01884"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a31a4427616764fbb5d2d639dc741eb29"> 1884</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#a31a4427616764fbb5d2d639dc741eb29">bytes_written</a>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#aa653b324eccad11ee3ce7b5b0f0c0903"> 1885</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#aa653b324eccad11ee3ce7b5b0f0c0903">multipart</a>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div>
<div class="line"><a name="l01887"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#aeccf56284a5442fcf146805671c9411c"> 1887</a></span>&#160;  <a class="code" href="classrgw_1_1RGWWriteRequest.html#aeccf56284a5442fcf146805671c9411c">RGWWriteRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user, <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _fh,</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;          <span class="keyword">const</span> std::string&amp; _bname, <span class="keyword">const</span> std::string&amp; _oname)</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibContinuedReq.html">RGWLibContinuedReq</a>(_cct, _user), <a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>(_bname), obj_name(_oname),</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      rgw_fh(_fh), processor(nullptr), last_off(0), next_off(0),</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      bytes_written(0), multipart(false) {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="keywordtype">int</span> ret = header_init();</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      ret = init_from_header(get_state());</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  }</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div>
<div class="line"><a name="l01900"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a176d4b98e9872308e8567a62980367ec"> 1900</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#a176d4b98e9872308e8567a62980367ec">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#aaec06c9054e6d52ab8af9b054628e15c"> 1902</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#aaec06c9054e6d52ab8af9b054628e15c">op_init</a>() {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div>
<div class="line"><a name="l01913"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a767fa5ea9baee94e77639345219e6684"> 1913</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#a767fa5ea9baee94e77639345219e6684">header_init</a>() {</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;PUT&quot;</span>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa6457b8e3f30573b55e842c5e420b3b2d">OP_PUT</a>;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="comment">/* XXX derp derp derp */</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    std::string uri = <a class="code" href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">make_uri</a>(<a class="code" href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">bucket_name</a>, obj_name);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  }</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a9bdafa7458e1e6f4668f57588256416f"> 1933</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classRGWPutObjProcessor.html">RGWPutObjProcessor</a> *<a class="code" href="classrgw_1_1RGWWriteRequest.html#a9bdafa7458e1e6f4668f57588256416f">select_processor</a>(<a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>&amp; <a class="code" href="structreq__state.html#a4694052e052f14d872b0dc085125e469">obj_ctx</a>,</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                           <span class="keywordtype">bool</span> *is_multipart) {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    uint64_t part_size = s-&gt;<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>-&gt;_conf-&gt;rgw_obj_stripe_size;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <a class="code" href="classRGWPutObjProcessor__Atomic.html">RGWPutObjProcessor_Atomic</a> *processor =</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keyword">new</span> <a class="code" href="classRGWPutObjProcessor__Atomic.html">RGWPutObjProcessor_Atomic</a>(obj_ctx, s-&gt;<a class="code" href="structreq__state.html#a61a64a06753b78b9a824b5fea8d23c02">bucket_info</a>, s-&gt;<a class="code" href="structreq__state.html#aff7ec1d9130564f00e60adbef589925a">bucket</a>,</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                    s-&gt;<a class="code" href="structreq__state.html#a4bb1760c50a9306e90bcc1b63d453d53">object</a>.<a class="code" href="structrgw__obj__key.html#ab51adda0cbbec2ff9230b9ffe100e939">name</a>, part_size, s-&gt;<a class="code" href="structreq__state.html#a6a3ded70140318ea71794298a8a400f1">req_id</a>,</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                    s-&gt;<a class="code" href="structreq__state.html#a61a64a06753b78b9a824b5fea8d23c02">bucket_info</a>.<a class="code" href="structRGWBucketInfo.html#a64ff1d5e63ce6f20429058a56b45660f">versioning_enabled</a>());</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    processor-&gt;<a class="code" href="classRGWPutObjProcessor__Atomic.html#a5b4b0f29627407ad8b456e292d43ea0f">set_olh_epoch</a>(olh_epoch);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    processor-&gt;<a class="code" href="classRGWPutObjProcessor__Atomic.html#a7909728f367fcf8b53c224173e7a40c8">set_version_id</a>(version_id);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">return</span> processor;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  }</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div>
<div class="line"><a name="l01946"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a8ddeffddf2157927c9d95a882b9c82e9"> 1946</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#a8ddeffddf2157927c9d95a882b9c82e9">get_params</a>() {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <a class="code" href="classRGWAccessControlPolicy__S3.html">RGWAccessControlPolicy_S3</a> s3policy(s-&gt;<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="comment">/* we don&#39;t have (any) headers, so just create canned ACLs */</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordtype">int</span> ret = s3policy.<a class="code" href="classRGWAccessControlPolicy__S3.html#ad399d9d60a8eb4759bcdf2a6e36488be">create_canned</a>(s-&gt;<a class="code" href="structreq__state.html#a2eec9247ec43945a83fd1004b9f7ee74">owner</a>, s-&gt;<a class="code" href="structreq__state.html#a2fd0c760203508360c7b9ac16993b040">bucket_owner</a>, s-&gt;<a class="code" href="structreq__state.html#a0cdf9b9ab810c7c03aa0dd1ab6529bf1">canned_acl</a>);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    policy = s3policy;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a7d1ed061d0d137f417a8d35968777b1a"> 1955</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#a7d1ed061d0d137f417a8d35968777b1a">get_data</a>(buffer::list&amp; _bl) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">/* XXX for now, use sharing semantics */</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    uint32_t len = data.length();</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    _bl.claim(data);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    bytes_written += len;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  }</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div>
<div class="line"><a name="l01963"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#ace20a89f7cb82645f5deda74c17023aa"> 1963</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#ace20a89f7cb82645f5deda74c17023aa">put_data</a>(off_t off, buffer::list&amp; _bl) {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    ofs = off;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    data.claim(_bl);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> exec_start();</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> exec_continue();</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> exec_finish();</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div>
<div class="line"><a name="l01972"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#ab7f5ee8359ae059c4808a0eeea1205c5"> 1972</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#ab7f5ee8359ae059c4808a0eeea1205c5">send_response</a>() {}</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWWriteRequest.html#a5817a1a77964146451cac8e75cf1df81"> 1974</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWWriteRequest.html#a5817a1a77964146451cac8e75cf1df81">verify_params</a>() {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;}; <span class="comment">/* RGWWriteRequest */</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">  copy object</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html"> 1982</a></span>&#160;<span class="keyword">class </span><a class="code" href="classrgw_1_1RGWCopyObjRequest.html">RGWCopyObjRequest</a> : <span class="keyword">public</span> <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>,</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;              <span class="keyword">public</span> <a class="code" href="classRGWCopyObj.html">RGWCopyObj</a> <span class="comment">/* RGWOp */</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;{</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01986"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#afa4e69794fe431ddeb98085f2ca7dbab"> 1986</a></span>&#160;  <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#afa4e69794fe431ddeb98085f2ca7dbab">src_parent</a>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#abfcfb9206a98b5bd3b0a448ac7c52f25"> 1987</a></span>&#160;  <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#abfcfb9206a98b5bd3b0a448ac7c52f25">dst_parent</a>;</div>
<div class="line"><a name="l01988"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#a49a290359e4fec4be49d694b174aa0b7"> 1988</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#a49a290359e4fec4be49d694b174aa0b7">src_name</a>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#a741704ff334b65025b250363ed919bd2"> 1989</a></span>&#160;  <span class="keyword">const</span> std::string&amp; <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#a741704ff334b65025b250363ed919bd2">dst_name</a>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#a0f47a2c5846ca70376de4637793e4d48"> 1991</a></span>&#160;  <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#a0f47a2c5846ca70376de4637793e4d48">RGWCopyObjRequest</a>(CephContext* _cct, <a class="code" href="structRGWUserInfo.html">RGWUserInfo</a> *_user,</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _src_parent, <a class="code" href="classrgw_1_1RGWFileHandle.html">RGWFileHandle</a>* _dst_parent,</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <span class="keyword">const</span> std::string&amp; _src_name, <span class="keyword">const</span> std::string&amp; _dst_name)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    : <a class="code" href="classrgw_1_1RGWLibRequest.html">RGWLibRequest</a>(_cct, _user), src_parent(_src_parent),</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      dst_parent(_dst_parent), src_name(_src_name), dst_name(_dst_name) {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">/* all requests have this */</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    op = <span class="keyword">this</span>;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="comment">/* allow this request to replace selected attrs */</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    attrs_mod = <a class="code" href="classRGWRados.html#acf6063a74d8174f965ace73d8c72d237ace5a2fd298de3324b5f5e64eb9aad63f">RGWRados::ATTRSMOD_MERGE</a>;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div>
<div class="line"><a name="l02003"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#ad589ee0792f846ea86ac5430e3b657fe"> 2003</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#ad589ee0792f846ea86ac5430e3b657fe">only_bucket</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div>
<div class="line"><a name="l02005"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#a4a22af0f5cb2b3d73ed4e5eabd5ee310"> 2005</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#a4a22af0f5cb2b3d73ed4e5eabd5ee310">op_init</a>() {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="comment">// assign store, s, and dialect_handler</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>* rados_ctx</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      = <span class="keyword">static_cast&lt;</span><a class="code" href="structRGWObjectCtx.html">RGWObjectCtx</a>*<span class="keyword">&gt;</span>(get_state()-&gt;obj_ctx);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">// framework promises to call op_init after parent init</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    assert(rados_ctx);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <a class="code" href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a>(rados_ctx-&gt;<a class="code" href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">store</a>, get_state(), <span class="keyword">this</span>);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    op = <span class="keyword">this</span>; <span class="comment">// assign self as op: REQUIRED</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div>
<div class="line"><a name="l02017"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#a3f62a1ce8c7d8b4982bc762d07b095c1"> 2017</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#a3f62a1ce8c7d8b4982bc762d07b095c1">header_init</a>() {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">method</a> = <span class="stringliteral">&quot;PUT&quot;</span>; <span class="comment">// XXX check</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">op</a> = <a class="code" href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa6457b8e3f30573b55e842c5e420b3b2d">OP_PUT</a>;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <a class="code" href="structreq__state.html#a0a8be031d3dfaa6ff9500ae0aa3e580f">src_bucket_name</a> = src_parent-&gt;bucket_name();</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">// need s-&gt;src_bucket_name?</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <a class="code" href="structreq__state.html#a72a6e29f70fea4bf43a5c684f0487285">src_object</a>.<a class="code" href="structrgw__obj__key.html#ab51adda0cbbec2ff9230b9ffe100e939">name</a> = src_parent-&gt;format_child_name(src_name);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="comment">// need s-&gt;src_object?</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    dest_bucket_name = dst_parent-&gt;bucket_name();</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="comment">// need s-&gt;bucket.name?</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    dest_object = dst_parent-&gt;format_child_name(dst_name);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="comment">// need s-&gt;object_name?</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">if</span> (! <a class="code" href="rgw__rest__s3_8h.html#afc5d7366f67380e0de2809c98048e8ec">valid_s3_object_name</a>(dest_object))</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <span class="keywordflow">return</span> -<a class="code" href="rgw__common_8h.html#aff282dca44d2cd446fd499b24852d25e">ERR_INVALID_OBJECT_NAME</a>;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="comment">/* XXX and fixup key attr (could optimize w/string ref and</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">     * dest_object) */</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    buffer::list ux_key;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    std::string key_name{dst_parent-&gt;make_key_name(dst_name.c_str())};</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="structrgw_1_1fh__key.html">fh_key</a> fhk = dst_parent-&gt;make_fhk(key_name);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    rgw::encode(fhk, ux_key);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    emplace_attr(<a class="code" href="rgw__common_8h.html#a401f2754b8c0f4d60651b6b4635ed92e">RGW_ATTR_UNIX_KEY1</a>, std::move(ux_key));</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="preprocessor">#if 0 </span><span class="comment">/* XXX needed? */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="preprocessor"></span>    s-&gt;<a class="code" href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">relative_uri</a> = uri;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">request_uri</a> = uri; <span class="comment">// XXX</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">effective_uri</a> = uri;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">request_params</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">info</a>.<a class="code" href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">domain</a> = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">/* XXX ? */</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="comment">// woo</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    s-&gt;<a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a> = <a class="code" href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">user</a>;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div>
<div class="line"><a name="l02058"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#aa206fe3d27c4a15cc569d987f580f6b1"> 2058</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#aa206fe3d27c4a15cc569d987f580f6b1">get_params</a>() {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keyword">struct </span><a class="code" href="structreq__state.html">req_state</a>* s = get_state();</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <a class="code" href="classRGWAccessControlPolicy__S3.html">RGWAccessControlPolicy_S3</a> s3policy(s-&gt;<a class="code" href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">cct</a>);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="comment">/* we don&#39;t have (any) headers, so just create canned ACLs */</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordtype">int</span> ret = s3policy.<a class="code" href="classRGWAccessControlPolicy__S3.html#ad399d9d60a8eb4759bcdf2a6e36488be">create_canned</a>(s-&gt;<a class="code" href="structreq__state.html#a2eec9247ec43945a83fd1004b9f7ee74">owner</a>, s-&gt;<a class="code" href="structreq__state.html#a2fd0c760203508360c7b9ac16993b040">bucket_owner</a>, s-&gt;<a class="code" href="structreq__state.html#a0cdf9b9ab810c7c03aa0dd1ab6529bf1">canned_acl</a>);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    dest_policy = s3policy;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  }</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;</div>
<div class="line"><a name="l02067"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#ac179a6372df267a3dd96ab9ee80f0023"> 2067</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#ac179a6372df267a3dd96ab9ee80f0023">send_response</a>() {}</div>
<div class="line"><a name="l02068"></a><span class="lineno"><a class="line" href="classrgw_1_1RGWCopyObjRequest.html#aa6460ddc46d67b1734eb904db8133568"> 2068</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrgw_1_1RGWCopyObjRequest.html#aa6460ddc46d67b1734eb904db8133568">send_partial_response</a>(off_t ofs) {}</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;}; <span class="comment">/* RGWCopyObjRequest */</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;} <span class="comment">/* namespace rgw */</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* RGW_FILE_H */</span><span class="preprocessor"></span></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhEQ_html_a1a085453b8697cfd8399d4513525f077"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#a1a085453b8697cfd8399d4513525f077">rgw::RGWFileHandle::FhEQ::operator()</a></div><div class="ttdeci">bool operator()(const RGWFileHandle &amp;lhs, const RGWFileHandle &amp;rhs) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:604</div></div>
<div class="ttc" id="rgw__user_8cc_html_af3740c7763c6f4ce4dea93627a36decc"><div class="ttname"><a href="rgw__user_8cc.html#af3740c7763c6f4ce4dea93627a36decc">rgw_store_user_info</a></div><div class="ttdeci">int rgw_store_user_info(RGWRados *store, RGWUserInfo &amp;info, RGWUserInfo *old_info, RGWObjVersionTracker *objv_tracker, real_time mtime, bool exclusive, map&lt; string, bufferlist &gt; *pattrs)</div><div class="ttdef"><b>Definition:</b> rgw_user.cc:90</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_ad54f435622514661452e4bae74613e20"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#ad54f435622514661452e4bae74613e20">rgw::RGWFileHandle::Factory::recycle</a></div><div class="ttdeci">void recycle(cohort::lru::Object *o)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:653</div></div>
<div class="ttc" id="classrgw_1_1RGWLib_html_afc455f5dcbcf1ffac25ac60084ba85a3"><div class="ttname"><a href="classrgw_1_1RGWLib.html#afc455f5dcbcf1ffac25ac60084ba85a3">rgw::RGWLib::get_ldh</a></div><div class="ttdeci">rgw::LDAPHelper * get_ldh()</div><div class="ttdef"><b>Definition:</b> rgw_lib.h:42</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_afc125bc2bbd9ee49d91f0d67e57425f3"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#afc125bc2bbd9ee49d91f0d67e57425f3">rgw::RGWFileHandle::is_file</a></div><div class="ttdeci">bool is_file() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:489</div></div>
<div class="ttc" id="classRGWOp_html_ae9ce89895ab6f34f7da3cf38e823c832"><div class="ttname"><a href="classRGWOp.html#ae9ce89895ab6f34f7da3cf38e823c832">RGWOp::init</a></div><div class="ttdeci">virtual void init(RGWRados *store, struct req_state *s, RGWHandler *dialect_handler)</div><div class="ttdef"><b>Definition:</b> rgw_op.h:76</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a33b3d789c4a3846d1a8e45f204dd3965"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a33b3d789c4a3846d1a8e45f204dd3965">rgw::RGWReaddirRequest::RGWReaddirRequest</a></div><div class="ttdeci">RGWReaddirRequest(CephContext *_cct, RGWUserInfo *_user, RGWFileHandle *_rgw_fh, rgw_readdir_cb _rcb, void *_cb_arg, uint64_t *_offset)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1096</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a982eb7fd86aafb449f56b2c450e45b56"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a982eb7fd86aafb449f56b2c450e45b56">rgw::RGWWriteRequest::last_off</a></div><div class="ttdeci">off_t last_off</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1882</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_a898a1688ddec98ebd1357263cb0ec5f9"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#a898a1688ddec98ebd1357263cb0ec5f9">rgw::RGWStatLeafRequest::is_dir</a></div><div class="ttdeci">bool is_dir</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1779</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_abfe276bd033d1f434448006d50b91678"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#abfe276bd033d1f434448006d50b91678">rgw::RGWStatLeafRequest::rgw_fh</a></div><div class="ttdeci">RGWFileHandle * rgw_fh</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1776</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a7e6e4915dde31751b138eccd3e83ce49"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a7e6e4915dde31751b138eccd3e83ce49">rgw::RGWReaddirRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1163</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ac8c4afd64dedb5ad8bbb0e1a93ef362e"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ac8c4afd64dedb5ad8bbb0e1a93ef362e">rgw::RGWFileHandle::~RGWFileHandle</a></div><div class="ttdeci">virtual ~RGWFileHandle()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:634</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aa850ddb3561607ca6b4129ef2a382271"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aa850ddb3561607ca6b4129ef2a382271">rgw::RGWFileHandle::write_finish</a></div><div class="ttdeci">int write_finish()</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a5f5beb4dc8e4a3059e3741892a1f5975"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a5f5beb4dc8e4a3059e3741892a1f5975">rgw::RGWPutObjRequest::bl</a></div><div class="ttdeci">buffer::list &amp; bl</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1374</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a4404a624ce339723e971b7efda896320"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a4404a624ce339723e971b7efda896320">rgw::RGWReaddirRequest::ix</a></div><div class="ttdeci">size_t ix</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1094</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html">rgw::RGWFileHandle</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:152</div></div>
<div class="ttc" id="structRGWAccessKey_html_a8a87deb3d5d326b8e990dbc915015c03"><div class="ttname"><a href="structRGWAccessKey.html#a8a87deb3d5d326b8e990dbc915015c03">RGWAccessKey::key</a></div><div class="ttdeci">string key</div><div class="ttdef"><b>Definition:</b> rgw_common.h:436</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html">rgw::RGWReadRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1456</div></div>
<div class="ttc" id="namespacergw_html_a91c107b9a28ca60c4777c28cf5f59632"><div class="ttname"><a href="namespacergw.html#a91c107b9a28ca60c4777c28cf5f59632">rgw::LookupFHResult</a></div><div class="ttdeci">std::tuple&lt; RGWFileHandle *, uint32_t &gt; LookupFHResult</div><div class="ttdef"><b>Definition:</b> rgw_file.h:673</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_a88481e302c981383e97f4fe6f608b7b6"><div class="ttname"><a href="structrgw_1_1fh__key.html#a88481e302c981383e97f4fe6f608b7b6">rgw::fh_key::fh_hk</a></div><div class="ttdeci">rgw_fh_hk fh_hk</div><div class="ttdef"><b>Definition:</b> rgw_file.h:78</div></div>
<div class="ttc" id="namespacergw_html_aa217e6c2e1039bb992e36ab91d69d8bf"><div class="ttname"><a href="namespacergw.html#aa217e6c2e1039bb992e36ab91d69d8bf">rgw::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(const fh_key &amp;lhs, const fh_key &amp;rhs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:121</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html">rgw::RGWListBucketsRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:981</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_acd23b102146d3824cd32522368d5a103"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#acd23b102146d3824cd32522368d5a103">rgw::RGWListBucketsRequest::operator()</a></div><div class="ttdeci">int operator()(const boost::string_ref &amp;name, const boost::string_ref &amp;marker)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1064</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a5817a1a77964146451cac8e75cf1df81"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a5817a1a77964146451cac8e75cf1df81">rgw::RGWWriteRequest::verify_params</a></div><div class="ttdeci">virtual int verify_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1974</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_a379d790bd6b1b600af0308f7dbf8c867"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#a379d790bd6b1b600af0308f7dbf8c867">rgw::RGWCreateBucketRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1280</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html">rgw::RGWFileHandle::Factory</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:636</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a6505d0956c7ff406b319b61380e8d2ba"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a6505d0956c7ff406b319b61380e8d2ba">rgw::RGWFileHandle::decode_attrs</a></div><div class="ttdeci">void decode_attrs(const ceph::buffer::list *ux_key1, const ceph::buffer::list *ux_attrs1)</div><div class="ttdef"><b>Definition:</b> rgw_file.cc:572</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a5468d199ae9fb3ad111d5ccfc6f99987"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a5468d199ae9fb3ad111d5ccfc6f99987">rgw::RGWListBucketsRequest::eof</a></div><div class="ttdeci">bool eof()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1073</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_a481b1d6f5e3d84c8a5001baf730deff9"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#a481b1d6f5e3d84c8a5001baf730deff9">rgw::RGWCreateBucketRequest::RGWCreateBucketRequest</a></div><div class="ttdeci">RGWCreateBucketRequest(CephContext *_cct, RGWUserInfo *_user, std::string &amp;_uri)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1256</div></div>
<div class="ttc" id="classRGWCreateBucket_html"><div class="ttname"><a href="classRGWCreateBucket.html">RGWCreateBucket</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:526</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a1c63eb2c03904d626e62a8401be1b92c"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a1c63eb2c03904d626e62a8401be1b92c">rgw::RGWListBucketsRequest::rgw_fh</a></div><div class="ttdeci">RGWFileHandle * rgw_fh</div><div class="ttdef"><b>Definition:</b> rgw_file.h:985</div></div>
<div class="ttc" id="classRGWUserBuckets_html"><div class="ttname"><a href="classRGWUserBuckets.html">RGWUserBuckets</a></div><div class="ttdef"><b>Definition:</b> rgw_bucket.h:101</div></div>
<div class="ttc" id="classRGWGetObj_html_ad223af95b61e98ff878f26c07530ef64"><div class="ttname"><a href="classRGWGetObj.html#ad223af95b61e98ff878f26c07530ef64">RGWGetObj::range_parsed</a></div><div class="ttdeci">bool range_parsed</div><div class="ttdef"><b>Definition:</b> rgw_op.h:123</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_ac582b6154d850e7b4e9ebf6007ac3e55"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#ac582b6154d850e7b4e9ebf6007ac3e55">rgw::RGWStatLeafRequest::RGWStatLeafRequest</a></div><div class="ttdeci">RGWStatLeafRequest(CephContext *_cct, RGWUserInfo *_user, RGWFileHandle *_rgw_fh, const std::string &amp;_path)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1781</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a767fa5ea9baee94e77639345219e6684"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a767fa5ea9baee94e77639345219e6684">rgw::RGWWriteRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1913</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a85c4c632dbc12630a9a2f084e7d24878"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a85c4c632dbc12630a9a2f084e7d24878">rgw::RGWFileHandle::get_owner_uid</a></div><div class="ttdeci">uint32_t get_owner_uid() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:330</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a31a4427616764fbb5d2d639dc741eb29"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a31a4427616764fbb5d2d639dc741eb29">rgw::RGWWriteRequest::bytes_written</a></div><div class="ttdeci">size_t bytes_written</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1884</div></div>
<div class="ttc" id="rgw__ldap_8h_html"><div class="ttname"><a href="rgw__ldap_8h.html">rgw_ldap.h</a></div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aee0a7e2a3c4d950261f4bc76eeb8ed8a"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aee0a7e2a3c4d950261f4bc76eeb8ed8a">rgw::RGWFileHandle::is_dir</a></div><div class="ttdeci">bool is_dir() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:490</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_abb541000a93595345b11acfcc3788b7a"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#abb541000a93595345b11acfcc3788b7a">rgw::RGWReaddirRequest::send_versioned_response</a></div><div class="ttdeci">virtual void send_versioned_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1232</div></div>
<div class="ttc" id="classRGWPutObjProcessor__Atomic_html"><div class="ttname"><a href="classRGWPutObjProcessor__Atomic.html">RGWPutObjProcessor_Atomic</a></div><div class="ttdef"><b>Definition:</b> rgw_rados.h:3117</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_ae3dc139d32c983d341745e5b46c8a70c"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#ae3dc139d32c983d341745e5b46c8a70c">rgw::RGWReadRequest::ulp_buffer</a></div><div class="ttdeci">void * ulp_buffer</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1461</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a3355ad2383f1c16ae3dc620d9171d8f0"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a3355ad2383f1c16ae3dc620d9171d8f0">rgw::RGWStatObjRequest::flags</a></div><div class="ttdeci">uint32_t flags</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1610</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a6d00387228389c3a65ace094383ab025"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a6d00387228389c3a65ace094383ab025">rgw::RGWFileHandle::FLAG_OPEN</a></div><div class="ttdeci">static constexpr uint32_t FLAG_OPEN</div><div class="ttdef"><b>Definition:</b> rgw_file.h:226</div></div>
<div class="ttc" id="classRGWListBuckets_html"><div class="ttname"><a href="classRGWListBuckets.html">RGWListBuckets</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:271</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ab5db5b6c8bc5a32349912720241df65f"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ab5db5b6c8bc5a32349912720241df65f">rgw::RGWFileHandle::clear_creating</a></div><div class="ttdeci">void clear_creating()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:513</div></div>
<div class="ttc" id="rgw__common_8h_html_aff282dca44d2cd446fd499b24852d25e"><div class="ttname"><a href="rgw__common_8h.html#aff282dca44d2cd446fd499b24852d25e">ERR_INVALID_OBJECT_NAME</a></div><div class="ttdeci">#define ERR_INVALID_OBJECT_NAME</div><div class="ttdef"><b>Definition:</b> rgw_common.h:147</div></div>
<div class="ttc" id="classRGWListBucket_html_a7bbc1bc7753426838b6afd4bed02ba18"><div class="ttname"><a href="classRGWListBucket.html#a7bbc1bc7753426838b6afd4bed02ba18">RGWListBucket::marker</a></div><div class="ttdeci">rgw_obj_key marker</div><div class="ttdef"><b>Definition:</b> rgw_op.h:370</div></div>
<div class="ttc" id="namespacergw_html_a62778069fc9c34bb1aada3f786438489"><div class="ttname"><a href="namespacergw.html#a62778069fc9c34bb1aada3f786438489">rgw::from_base64</a></div><div class="ttdeci">std::string from_base64(boost::string_ref sref)</div><div class="ttdef"><b>Definition:</b> rgw_b64.h:62</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_aececbe4b0b9dfff8fdb4eb39c9420e18"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#aececbe4b0b9dfff8fdb4eb39c9420e18">rgw::RGWFileHandle::Factory::fhk</a></div><div class="ttdeci">const fh_key &amp; fhk</div><div class="ttdef"><b>Definition:</b> rgw_file.h:642</div></div>
<div class="ttc" id="namespacergw_html_af648f6b54862c8b7037d8b006ef7b65b"><div class="ttname"><a href="namespacergw.html#af648f6b54862c8b7037d8b006ef7b65b">rgw::operator&lt;=</a></div><div class="ttdeci">bool operator&lt;=(const fh_key &amp;lhs, const fh_key &amp;rhs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:144</div></div>
<div class="ttc" id="rgw__file_8h_html_a34de3d25465d88a39b97eee7882d3379"><div class="ttname"><a href="rgw__file_8h.html#a34de3d25465d88a39b97eee7882d3379">RGW_RWXMODE</a></div><div class="ttdeci">#define RGW_RWXMODE</div><div class="ttdef"><b>Definition:</b> rgw_file.h:45</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a8fa75a2cf243f79875cf08c73d0f389c"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a8fa75a2cf243f79875cf08c73d0f389c">rgw::RGWFileHandle::FLAG_DELETED</a></div><div class="ttdeci">static constexpr uint32_t FLAG_DELETED</div><div class="ttdef"><b>Definition:</b> rgw_file.h:233</div></div>
<div class="ttc" id="structreq__state_html_a91f76afcb55eebb4b794cc1be7dacacf"><div class="ttname"><a href="structreq__state.html#a91f76afcb55eebb4b794cc1be7dacacf">req_state::content_length</a></div><div class="ttdeci">int64_t content_length</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1239</div></div>
<div class="ttc" id="structreq__info_html_ac7aed51ef2fcafd803617b94c175214e"><div class="ttname"><a href="structreq__info.html#ac7aed51ef2fcafd803617b94c175214e">req_info::request_uri</a></div><div class="ttdeci">string request_uri</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1105</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html">rgw::RGWStatLeafRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1772</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a75a1eacc3db9c16cc675c0df8ba52476"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a75a1eacc3db9c16cc675c0df8ba52476">rgw::RGWFileHandle::format_child_name</a></div><div class="ttdeci">std::string format_child_name(const std::string &amp;cbasename)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:427</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a3bd92a8779e0278b55f728ce4a423b84"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a3bd92a8779e0278b55f728ce4a423b84">rgw::RGWListBucketsRequest::cb_arg</a></div><div class="ttdeci">void * cb_arg</div><div class="ttdef"><b>Definition:</b> rgw_file.h:987</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_af77e2766023d950170fb214170e35a44"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#af77e2766023d950170fb214170e35a44">rgw::RGWListBucketsRequest::RGWListBucketsRequest</a></div><div class="ttdeci">RGWListBucketsRequest(CephContext *_cct, RGWUserInfo *_user, RGWFileHandle *_rgw_fh, rgw_readdir_cb _rcb, void *_cb_arg, uint64_t *_offset)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:991</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_a3db02f6ea5b5a90da4874d3b2e5fca35"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#a3db02f6ea5b5a90da4874d3b2e5fca35">rgw::RGWFileHandle::Factory::fs</a></div><div class="ttdeci">RGWLibFS * fs</div><div class="ttdef"><b>Definition:</b> rgw_file.h:639</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html">rgw::RGWWriteRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1872</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_aa6460ddc46d67b1734eb904db8133568"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#aa6460ddc46d67b1734eb904db8133568">rgw::RGWCopyObjRequest::send_partial_response</a></div><div class="ttdeci">virtual void send_partial_response(off_t ofs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:2068</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ac0d23c8cdc62ec49770842713756f129"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ac0d23c8cdc62ec49770842713756f129">rgw::RGWFileHandle::tree_hook_type</a></div><div class="ttdeci">bi::set_member_hook&lt; link_mode &gt; tree_hook_type</div><div class="ttdef"><b>Definition:</b> rgw_file.h:619</div></div>
<div class="ttc" id="structreq__state_html_a494770c97c157bfcf918251e31ad2fdc"><div class="ttname"><a href="structreq__state.html#a494770c97c157bfcf918251e31ad2fdc">req_state::info</a></div><div class="ttdeci">req_info info</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1314</div></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhLT_html_a772b572a84d82be6fb6e87ec25457397"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhLT.html#a772b572a84d82be6fb6e87ec25457397">rgw::RGWFileHandle::FhLT::operator()</a></div><div class="ttdeci">bool operator()(const RGWFileHandle &amp;fh, const fh_key &amp;k) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:598</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a176d4b98e9872308e8567a62980367ec"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a176d4b98e9872308e8567a62980367ec">rgw::RGWWriteRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1900</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a0c0784b237d715616ac5002305528d48"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a0c0784b237d715616ac5002305528d48">rgw::RGWFileHandle::is_bucket</a></div><div class="ttdeci">bool is_bucket() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:487</div></div>
<div class="ttc" id="structrgw__bucket_html_a32d3529f5b0c53051c856a7abe867a6b"><div class="ttname"><a href="structrgw__bucket.html#a32d3529f5b0c53051c856a7abe867a6b">rgw_bucket::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> rgw_common.h:692</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteBucketRequest_html_ad5443913be99cab0e5e201636d84735a"><div class="ttname"><a href="classrgw_1_1RGWDeleteBucketRequest.html#ad5443913be99cab0e5e201636d84735a">rgw::RGWDeleteBucketRequest::RGWDeleteBucketRequest</a></div><div class="ttdeci">RGWDeleteBucketRequest(CephContext *_cct, RGWUserInfo *_user, std::string &amp;_uri)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1323</div></div>
<div class="ttc" id="classRGWGetObj_html"><div class="ttname"><a href="classRGWGetObj.html">RGWGetObj</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:102</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_ac4fa589cf8e464c22f57cbb4d36d5748"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#ac4fa589cf8e464c22f57cbb4d36d5748">rgw::RGWReadRequest::RGWReadRequest</a></div><div class="ttdeci">RGWReadRequest(CephContext *_cct, RGWUserInfo *_user, RGWFileHandle *_rgw_fh, uint64_t off, uint64_t len, void *_ulp_buffer)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1466</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a4f355729b987961d5117bea3a7237efe"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a4f355729b987961d5117bea3a7237efe">rgw::RGWFileHandle::MAX_DEPTH</a></div><div class="ttdeci">static constexpr uint16_t MAX_DEPTH</div><div class="ttdef"><b>Definition:</b> rgw_file.h:223</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ae0578e2667ece4725262575f6feaa31b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ae0578e2667ece4725262575f6feaa31b">rgw::RGWFileHandle::set_ctime</a></div><div class="ttdeci">void set_ctime(const struct timespec &amp;ts)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:532</div></div>
<div class="ttc" id="structreq__state_html_a8ac86427062e2716c5664b22510c22ef"><div class="ttname"><a href="structreq__state.html#a8ac86427062e2716c5664b22510c22ef">req_state::op</a></div><div class="ttdeci">http_op op</div><div class="ttdoc">XXX: re-remove?? </div><div class="ttdef"><b>Definition:</b> rgw_common.h:1231</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a78f3128f52285ce46b68407fb6edc769"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a78f3128f52285ce46b68407fb6edc769">rgw::RGWLibFS::ref</a></div><div class="ttdeci">RGWFileHandle * ref(RGWFileHandle *fh)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:882</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a06e29dc1d70d9f8d354e12ff32d442a4"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a06e29dc1d70d9f8d354e12ff32d442a4">rgw::RGWLibFS::get_fs</a></div><div class="ttdeci">struct rgw_fs * get_fs()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:957</div></div>
<div class="ttc" id="structRGWObjectCtx_html_a3dc28afcc3b20c510f032e651bf5cb44"><div class="ttname"><a href="structRGWObjectCtx.html#a3dc28afcc3b20c510f032e651bf5cb44">RGWObjectCtx::store</a></div><div class="ttdeci">RGWRados * store</div><div class="ttdef"><b>Definition:</b> rgw_rados.h:1676</div></div>
<div class="ttc" id="structreq__state_html_a0cdf9b9ab810c7c03aa0dd1ab6529bf1"><div class="ttname"><a href="structreq__state.html#a0cdf9b9ab810c7c03aa0dd1ab6529bf1">req_state::canned_acl</a></div><div class="ttdeci">string canned_acl</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1299</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_a146ed5b5b0b228195da2e112feaa39e9"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#a146ed5b5b0b228195da2e112feaa39e9">rgw::RGWStatLeafRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1802</div></div>
<div class="ttc" id="structreq__state_html_a2eec9247ec43945a83fd1004b9f7ee74"><div class="ttname"><a href="structreq__state.html#a2eec9247ec43945a83fd1004b9f7ee74">req_state::owner</a></div><div class="ttdeci">ACLOwner owner</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1263</div></div>
<div class="ttc" id="classrgw_1_1RGWLibContinuedReq_html"><div class="ttname"><a href="classrgw_1_1RGWLibContinuedReq.html">rgw::RGWLibContinuedReq</a></div><div class="ttdef"><b>Definition:</b> rgw_lib.h:163</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aa60a708cb8c058de16d4fc040a2ee827"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aa60a708cb8c058de16d4fc040a2ee827">rgw::RGWFileHandle::reclaim</a></div><div class="ttdeci">virtual bool reclaim()</div><div class="ttdef"><b>Definition:</b> rgw_file.cc:584</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a9bdafa7458e1e6f4668f57588256416f"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a9bdafa7458e1e6f4668f57588256416f">rgw::RGWWriteRequest::select_processor</a></div><div class="ttdeci">virtual RGWPutObjProcessor * select_processor(RGWObjectCtx &amp;obj_ctx, bool *is_multipart)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1933</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a97f74b6dbbab0ed938b2802ebc22bfe5"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a97f74b6dbbab0ed938b2802ebc22bfe5">rgw::RGWReadRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1483</div></div>
<div class="ttc" id="structRGWBucketInfo_html_a64ff1d5e63ce6f20429058a56b45660f"><div class="ttname"><a href="structRGWBucketInfo.html#a64ff1d5e63ce6f20429058a56b45660f">RGWBucketInfo::versioning_enabled</a></div><div class="ttdeci">bool versioning_enabled()</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1011</div></div>
<div class="ttc" id="namespacergw_html_a925f71101c6109eaabbbf4d65c591c5d"><div class="ttname"><a href="namespacergw.html#a925f71101c6109eaabbbf4d65c591c5d">rgw::MkObjResult</a></div><div class="ttdeci">std::tuple&lt; RGWFileHandle *, int &gt; MkObjResult</div><div class="ttdef"><b>Definition:</b> rgw_file.h:674</div></div>
<div class="ttc" id="rgw__common_8h_html_a7d2f08967a81e2e29e2cfa6e376bc1efa6457b8e3f30573b55e842c5e420b3b2d"><div class="ttname"><a href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa6457b8e3f30573b55e842c5e420b3b2d">OP_PUT</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:379</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a836685891496827e7b814e2c4e0e0001"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a836685891496827e7b814e2c4e0e0001">rgw::RGWFileHandle::FhLRU</a></div><div class="ttdeci">cohort::lru::LRU&lt; std::mutex &gt; FhLRU</div><div class="ttdef"><b>Definition:</b> rgw_file.h:586</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a6d82c82553a2d36a46974820698a5297"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a6d82c82553a2d36a46974820698a5297">rgw::RGWPutObjRequest::obj_name</a></div><div class="ttdeci">const std::string &amp; obj_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1373</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_aee335d52eb05461a644505a4fba5277d"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#aee335d52eb05461a644505a4fba5277d">rgw::RGWLibFS::unref</a></div><div class="ttdeci">void unref(RGWFileHandle *fh)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:878</div></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhEQ_html_a9c2296475a618c7fa972c18f021da435"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#a9c2296475a618c7fa972c18f021da435">rgw::RGWFileHandle::FhEQ::operator()</a></div><div class="ttdeci">bool operator()(const RGWFileHandle &amp;fh, const fh_key &amp;k) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:610</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_aa2dcd425fa591b0b4b2d05b71f9a4f5b"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#aa2dcd425fa591b0b4b2d05b71f9a4f5b">rgw::RGWStatObjRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1649</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a151afda8d1acaca77e40017601818899"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a151afda8d1acaca77e40017601818899">rgw::RGWStatObjRequest::ctime</a></div><div class="ttdeci">real_time ctime()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1638</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a0031684e510e759fa1c1b0ca68b9794e"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a0031684e510e759fa1c1b0ca68b9794e">rgw::RGWFileHandle::FLAG_CREATE</a></div><div class="ttdeci">static constexpr uint32_t FLAG_CREATE</div><div class="ttdef"><b>Definition:</b> rgw_file.h:228</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a174ce3fbc31fbb2ff07875aea1d56fe1"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a174ce3fbc31fbb2ff07875aea1d56fe1">rgw::RGWFileHandle::set_size</a></div><div class="ttdeci">void set_size(const size_t size)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:522</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ab50442186c8b140b5da64eac684d9f20"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ab50442186c8b140b5da64eac684d9f20">rgw::RGWFileHandle::is_root</a></div><div class="ttdeci">bool is_root() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:486</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_a47ab0fdc65c2a29d167d9bff88c204f3"><div class="ttname"><a href="structrgw_1_1fh__key.html#a47ab0fdc65c2a29d167d9bff88c204f3">rgw::fh_key::fh_key</a></div><div class="ttdeci">fh_key()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:82</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a8ddc1064088ed47d6e08b91e032a24e9"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a8ddc1064088ed47d6e08b91e032a24e9">rgw::RGWReaddirRequest::operator()</a></div><div class="ttdeci">int operator()(const boost::string_ref name, const boost::string_ref marker, uint8_t type)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1149</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a4354374934d98f843297d5fff4ab944c"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a4354374934d98f843297d5fff4ab944c">rgw::RGWPutObjRequest::bytes_written</a></div><div class="ttdeci">size_t bytes_written</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1375</div></div>
<div class="ttc" id="structreq__state_html_a61a64a06753b78b9a824b5fea8d23c02"><div class="ttname"><a href="structreq__state.html#a61a64a06753b78b9a824b5fea8d23c02">req_state::bucket_info</a></div><div class="ttdeci">RGWBucketInfo bucket_info</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1272</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_a4a00892570c705783e99c5f07b83f2bf"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#a4a00892570c705783e99c5f07b83f2bf">rgw::RGWCreateBucketRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1308</div></div>
<div class="ttc" id="classRGWPutObjProcessor__Atomic_html_a7909728f367fcf8b53c224173e7a40c8"><div class="ttname"><a href="classRGWPutObjProcessor__Atomic.html#a7909728f367fcf8b53c224173e7a40c8">RGWPutObjProcessor_Atomic::set_version_id</a></div><div class="ttdeci">void set_version_id(const string &amp;vid)</div><div class="ttdef"><b>Definition:</b> rgw_rados.h:3187</div></div>
<div class="ttc" id="rgw__token_8h_html"><div class="ttname"><a href="rgw__token_8h.html">rgw_token.h</a></div></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhEQ_html"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhEQ.html">rgw::RGWFileHandle::FhEQ</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:602</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_acc9d4bb2d37eb0dc82aaf5bb405b037c"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#acc9d4bb2d37eb0dc82aaf5bb405b037c">rgw::RGWWriteRequest::hash</a></div><div class="ttdeci">MD5 hash</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1881</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_aa3c545ff3c489a696992d8d2e180a69b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa3c545ff3c489a696992d8d2e180a69b">rgw::RGWFileHandle::Factory::parent</a></div><div class="ttdeci">RGWFileHandle * parent</div><div class="ttdef"><b>Definition:</b> rgw_file.h:641</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_a4874c26ca197aa4657ffe3abb946b1f3"><div class="ttname"><a href="structrgw_1_1fh__key.html#a4874c26ca197aa4657ffe3abb946b1f3">rgw::fh_key::seed</a></div><div class="ttdeci">static constexpr uint64_t seed</div><div class="ttdef"><b>Definition:</b> rgw_file.h:80</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_ab4198fe81558945256401b582e79440e"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#ab4198fe81558945256401b582e79440e">rgw::RGWStatLeafRequest::send_versioned_response</a></div><div class="ttdeci">virtual void send_versioned_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1863</div></div>
<div class="ttc" id="classRGWGetObj_html_ae72790bc149f70385fcf6ae1dd7a9afb"><div class="ttname"><a href="classRGWGetObj.html#ae72790bc149f70385fcf6ae1dd7a9afb">RGWGetObj::ofs</a></div><div class="ttdeci">off_t ofs</div><div class="ttdef"><b>Definition:</b> rgw_op.h:111</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html">rgw::RGWStatObjRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1603</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a17ddbb2124507ba5c9f7bc64451530cf"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a17ddbb2124507ba5c9f7bc64451530cf">rgw::RGWPutObjRequest::RGWPutObjRequest</a></div><div class="ttdeci">RGWPutObjRequest(CephContext *_cct, RGWUserInfo *_user, const std::string &amp;_bname, const std::string &amp;_oname, buffer::list &amp;_bl)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1377</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_acfabf725c0bbe38e1f00442cbb9bd057"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#acfabf725c0bbe38e1f00442cbb9bd057">rgw::RGWFileHandle::get_owner_gid</a></div><div class="ttdeci">uint32_t get_owner_gid() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:331</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a5c771407169165286bc9cb33a11683f6"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a5c771407169165286bc9cb33a11683f6">rgw::RGWFileHandle::get_parent</a></div><div class="ttdeci">RGWFileHandle * get_parent()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:328</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_a57d77c5f562d21290ed94280849ef128"><div class="ttname"><a href="structrgw_1_1fh__key.html#a57d77c5f562d21290ed94280849ef128">rgw::fh_key::encode</a></div><div class="ttdeci">void encode(buffer::list &amp;bl) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:104</div></div>
<div class="ttc" id="namespacergw_html_ace98a4a745bbd84c76dc340a42691054"><div class="ttname"><a href="namespacergw.html#ace98a4a745bbd84c76dc340a42691054">rgw::make_uri</a></div><div class="ttdeci">static std::string make_uri(const std::string &amp;bucket_name, const std::string &amp;object_name)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:967</div></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhLT_html"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhLT.html">rgw::RGWFileHandle::FhLT</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:588</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a07dc960e190ecbeaf2ad17a7ffa8a660"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a07dc960e190ecbeaf2ad17a7ffa8a660">rgw::RGWFileHandle::encode_attrs</a></div><div class="ttdeci">void encode_attrs(ceph::buffer::list &amp;ux_key1, ceph::buffer::list &amp;ux_attrs1)</div><div class="ttdef"><b>Definition:</b> rgw_file.cc:564</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteBucketRequest_html_a8ead1c1736f3201e08c8d3114e56ac7a"><div class="ttname"><a href="classrgw_1_1RGWDeleteBucketRequest.html#a8ead1c1736f3201e08c8d3114e56ac7a">rgw::RGWDeleteBucketRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1331</div></div>
<div class="ttc" id="rgw__common_8h_html_ae725f810ce0b0649b76acded093131bf"><div class="ttname"><a href="rgw__common_8h.html#ae725f810ce0b0649b76acded093131bf">ERR_USER_SUSPENDED</a></div><div class="ttdeci">#define ERR_USER_SUSPENDED</div><div class="ttdef"><b>Definition:</b> rgw_common.h:187</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_af701e43f7e66ad6ce6c21d70c53344fe"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#af701e43f7e66ad6ce6c21d70c53344fe">rgw::RGWWriteRequest::obj_name</a></div><div class="ttdeci">const std::string &amp; obj_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1877</div></div>
<div class="ttc" id="rgw__rest__s3_8h_html_afc5d7366f67380e0de2809c98048e8ec"><div class="ttname"><a href="rgw__rest__s3_8h.html#afc5d7366f67380e0de2809c98048e8ec">valid_s3_object_name</a></div><div class="ttdeci">static bool valid_s3_object_name(const string &amp;name)</div><div class="ttdef"><b>Definition:</b> rgw_rest_s3.h:584</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a224cde9cf422aac065a4935d5e02af23"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a224cde9cf422aac065a4935d5e02af23">rgw::RGWFileHandle::link_mode</a></div><div class="ttdeci">bi::link_mode&lt; bi::safe_link &gt; link_mode</div><div class="ttdef"><b>Definition:</b> rgw_file.h:614</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a5dce1d9833563e362de228ec08953106"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a5dce1d9833563e362de228ec08953106">rgw::RGWStatObjRequest::RGWStatObjRequest</a></div><div class="ttdeci">RGWStatObjRequest(CephContext *_cct, RGWUserInfo *_user, const std::string &amp;_bname, const std::string &amp;_oname, uint32_t _flags)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1614</div></div>
<div class="ttc" id="namespacergw_html_af832fa02fa66e375a70119598d0e3c50"><div class="ttname"><a href="namespacergw.html#af832fa02fa66e375a70119598d0e3c50">rgw::operator!=</a></div><div class="ttdeci">bool operator!=(const fh_key &amp;lhs, const fh_key &amp;rhs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:139</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_ab7f5ee8359ae059c4808a0eeea1205c5"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#ab7f5ee8359ae059c4808a0eeea1205c5">rgw::RGWWriteRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1972</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_a98f63f57a8b8673f6cb4883211a4a5b3"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#a98f63f57a8b8673f6cb4883211a4a5b3">rgw::RGWFileHandle::Factory::name</a></div><div class="ttdeci">std::string &amp; name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:643</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_a111d1d4f10fba6466dd066320a121f76"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#a111d1d4f10fba6466dd066320a121f76">rgw::RGWFileHandle::Factory::fs_inst</a></div><div class="ttdeci">uint32_t fs_inst</div><div class="ttdef"><b>Definition:</b> rgw_file.h:640</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_adcafca24a0fd87f21d275cdb0d7db743"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#adcafca24a0fd87f21d275cdb0d7db743">rgw::RGWFileHandle::bucket_name</a></div><div class="ttdeci">const std::string &amp; bucket_name() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:388</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a50e404a5fed170b5e1d2d0e854ccba5a"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a50e404a5fed170b5e1d2d0e854ccba5a">rgw::RGWLibFS::get_context</a></div><div class="ttdeci">CephContext * get_context()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:953</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a0ada6e62d933f1ab05fe18c4e8e5c9bd"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a0ada6e62d933f1ab05fe18c4e8e5c9bd">rgw::RGWStatObjRequest::get_attrs</a></div><div class="ttdeci">std::map&lt; string, bufferlist &gt; &amp; get_attrs()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1640</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a1a0d30cca4b985877e11539a90777fc0"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a1a0d30cca4b985877e11539a90777fc0">rgw::RGWListBucketsRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1020</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a4bc2cbff1ac3bbee35143ad22dc2195a"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a4bc2cbff1ac3bbee35143ad22dc2195a">rgw::RGWReaddirRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1125</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_acfaedf1fa07d814faa5c21197fa4258b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#acfaedf1fa07d814faa5c21197fa4258b">rgw::RGWFileHandle::RGWFileHandle</a></div><div class="ttdeci">RGWFileHandle(RGWLibFS *fs, uint32_t fs_inst, RGWFileHandle *_parent, const fh_key &amp;_fhk, std::string &amp;_name, uint32_t _flags)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:265</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteBucketRequest_html_a9132b1799bda88fbfb22f7676639ad59"><div class="ttname"><a href="classrgw_1_1RGWDeleteBucketRequest.html#a9132b1799bda88fbfb22f7676639ad59">rgw::RGWDeleteBucketRequest::uri</a></div><div class="ttdeci">std::string &amp; uri</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1321</div></div>
<div class="ttc" id="structreq__state_html"><div class="ttname"><a href="structreq__state.html">req_state</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:1227</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_ae20d65cdd62acaebcf0ab7f7ed215a02"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#ae20d65cdd62acaebcf0ab7f7ed215a02">rgw::RGWCreateBucketRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1262</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a8d0131dff32d88e53ef8a6920f0acecf"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a8d0131dff32d88e53ef8a6920f0acecf">rgw::RGWLibFS::intrusive_ptr_add_ref</a></div><div class="ttdeci">friend void intrusive_ptr_add_ref(const RGWLibFS *fs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:751</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a8a8f25f47b9b792d72a54952b00f622b"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a8a8f25f47b9b792d72a54952b00f622b">rgw::RGWListBucketsRequest::get_params</a></div><div class="ttdeci">int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1038</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html_ad98de60e069e8e6d374a95e407c11bc1"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html#ad98de60e069e8e6d374a95e407c11bc1">rgw::RGWDeleteObjRequest::RGWDeleteObjRequest</a></div><div class="ttdeci">RGWDeleteObjRequest(CephContext *_cct, RGWUserInfo *_user, const std::string &amp;_bname, const std::string &amp;_oname)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1560</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a60a129497f73f9e16a4d86d873e096ff"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a60a129497f73f9e16a4d86d873e096ff">rgw::RGWFileHandle::readdir</a></div><div class="ttdeci">int readdir(rgw_readdir_cb rcb, void *cb_arg, uint64_t *offset, bool *eof, uint32_t flags)</div><div class="ttdef"><b>Definition:</b> rgw_file.cc:589</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a98caf495b4be30b835b70697773a433a"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a98caf495b4be30b835b70697773a433a">rgw::RGWPutObjRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1442</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a3b9e07d9efcd0dd25963117b7c77c70b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a3b9e07d9efcd0dd25963117b7c77c70b">rgw::RGWFileHandle::open_for_create</a></div><div class="ttdeci">void open_for_create()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:508</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ab8062b6d03caf3cdb31c19a3c8571c81"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ab8062b6d03caf3cdb31c19a3c8571c81">rgw::RGWFileHandle::FLAG_CREATING</a></div><div class="ttdeci">static constexpr uint32_t FLAG_CREATING</div><div class="ttdef"><b>Definition:</b> rgw_file.h:229</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a5c508c2e29bda304a78cc81982ab65ef"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a5c508c2e29bda304a78cc81982ab65ef">rgw::RGWStatObjRequest::get_size</a></div><div class="ttdeci">uint64_t get_size()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1637</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a92d338d83c64813a44f041842edd8cc1"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a92d338d83c64813a44f041842edd8cc1">rgw::RGWLibFS::authorize</a></div><div class="ttdeci">int authorize(RGWRados *store)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:771</div></div>
<div class="ttc" id="namespacergw_html_a7c2a0e1d50dba271764d3f34f70b12a0"><div class="ttname"><a href="namespacergw.html#a7c2a0e1d50dba271764d3f34f70b12a0">rgw::operator==</a></div><div class="ttdeci">bool operator==(const fh_key &amp;lhs, const fh_key &amp;rhs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:133</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html_a432839cd0eb1a6747bed32f9f355fbba"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html#a432839cd0eb1a6747bed32f9f355fbba">rgw::RGWDeleteObjRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1599</div></div>
<div class="ttc" id="classRGWPutObjProcessor_html"><div class="ttname"><a href="classRGWPutObjProcessor.html">RGWPutObjProcessor</a></div><div class="ttdef"><b>Definition:</b> rgw_rados.h:3048</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_ac822b22859f84477184a5b1687217e3e"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#ac822b22859f84477184a5b1687217e3e">rgw::RGWReaddirRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1114</div></div>
<div class="ttc" id="classRGWDeleteBucket_html"><div class="ttname"><a href="classRGWDeleteBucket.html">RGWDeleteBucket</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:564</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a359e6338c7436b5b9fb47aa1117235b0"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a359e6338c7436b5b9fb47aa1117235b0">rgw::RGWFileHandle::decode</a></div><div class="ttdeci">void decode(bufferlist::iterator &amp;bl)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:559</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a20a64de75ec640751e3503c2cfaf3da3"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a20a64de75ec640751e3503c2cfaf3da3">rgw::RGWFileHandle::set_nlink</a></div><div class="ttdeci">void set_nlink(const uint64_t n)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:518</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a47dd86ffc364e747248594c6d5723897"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a47dd86ffc364e747248594c6d5723897">rgw::RGWFileHandle::FhHook</a></div><div class="ttdeci">bi::member_hook&lt; RGWFileHandle, tree_hook_type,&amp;RGWFileHandle::fh_hook &gt; FhHook</div><div class="ttdef"><b>Definition:</b> rgw_file.h:624</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a7b953f6ab9112622a016e61d4da98f04"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a7b953f6ab9112622a016e61d4da98f04">rgw::RGWLibFS::get_inst</a></div><div class="ttdeci">uint32_t get_inst()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:959</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ab23c79f6fa92315f8124e42ec3d615f3"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ab23c79f6fa92315f8124e42ec3d615f3">rgw::RGWFileHandle::get_key</a></div><div class="ttdeci">const fh_key &amp; get_key() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:308</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_abd217f21e47973a87727a7ee45509c0a"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#abd217f21e47973a87727a7ee45509c0a">rgw::RGWFileHandle::get_size</a></div><div class="ttdeci">size_t get_size() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:316</div></div>
<div class="ttc" id="classRGWGetObj_html_a49461c5f951a732bfc335e7671c57c9e"><div class="ttname"><a href="classRGWGetObj.html#a49461c5f951a732bfc335e7671c57c9e">RGWGetObj::get_data</a></div><div class="ttdeci">bool get_data</div><div class="ttdef"><b>Definition:</b> rgw_op.h:121</div></div>
<div class="ttc" id="namespacergw_html_a2d2589dec8dc14314573384f2244ff45"><div class="ttname"><a href="namespacergw.html#a2d2589dec8dc14314573384f2244ff45">rgw::rgwlib</a></div><div class="ttdeci">RGWLib rgwlib</div><div class="ttdef"><b>Definition:</b> librgw.cc:67</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a1789de1dcc9d3103dedcaefb9b563939"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a1789de1dcc9d3103dedcaefb9b563939">rgw::RGWFileHandle::create_stat</a></div><div class="ttdeci">void create_stat(struct stat *st, uint32_t mask)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:335</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_a486e1d3e6a16e4f72d5540b83ff5d979"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#a486e1d3e6a16e4f72d5540b83ff5d979">rgw::RGWStatBucketRequest::attrs</a></div><div class="ttdeci">std::map&lt; std::string, buffer::list &gt; attrs</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1707</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a2000cc05c28804e04a10620eab3bdf53"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a2000cc05c28804e04a10620eab3bdf53">rgw::RGWListBucketsRequest::send_response_begin</a></div><div class="ttdeci">virtual void send_response_begin(bool has_buckets)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1043</div></div>
<div class="ttc" id="structreq__state_html_a6a3ded70140318ea71794298a8a400f1"><div class="ttname"><a href="structreq__state.html#a6a3ded70140318ea71794298a8a400f1">req_state::req_id</a></div><div class="ttdeci">string req_id</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1320</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html_a38e6fda8301ad1b3c8e53967e44483b8"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html#a38e6fda8301ad1b3c8e53967e44483b8">rgw::RGWDeleteObjRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1566</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_aa206fe3d27c4a15cc569d987f580f6b1"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#aa206fe3d27c4a15cc569d987f580f6b1">rgw::RGWCopyObjRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:2058</div></div>
<div class="ttc" id="classRGWPutObjProcessor__Atomic_html_a5b4b0f29627407ad8b456e292d43ea0f"><div class="ttname"><a href="classRGWPutObjProcessor__Atomic.html#a5b4b0f29627407ad8b456e292d43ea0f">RGWPutObjProcessor_Atomic::set_olh_epoch</a></div><div class="ttdeci">void set_olh_epoch(uint64_t epoch)</div><div class="ttdef"><b>Definition:</b> rgw_rados.h:3183</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_a741704ff334b65025b250363ed919bd2"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#a741704ff334b65025b250363ed919bd2">rgw::RGWCopyObjRequest::dst_name</a></div><div class="ttdeci">const std::string &amp; dst_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1989</div></div>
<div class="ttc" id="classRGWRados_html"><div class="ttname"><a href="classRGWRados.html">RGWRados</a></div><div class="ttdef"><b>Definition:</b> rgw_rados.h:1702</div></div>
<div class="ttc" id="rgw__main_8cc_html_af3e97d07a077cd4939ff7cc8a1661e85"><div class="ttname"><a href="rgw__main_8cc.html#af3e97d07a077cd4939ff7cc8a1661e85">intrusive_ptr_release</a></div><div class="ttdeci">void intrusive_ptr_release(CephContext *cct)</div><div class="ttdef"><b>Definition:</b> rgw_main.cc:177</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a4b58f97c5a957b6c19c22ea9118e723e"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a4b58f97c5a957b6c19c22ea9118e723e">rgw::RGWListBucketsRequest::offset</a></div><div class="ttdeci">uint64_t * offset</div><div class="ttdef"><b>Definition:</b> rgw_file.h:986</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_ac179a6372df267a3dd96ab9ee80f0023"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#ac179a6372df267a3dd96ab9ee80f0023">rgw::RGWCopyObjRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:2067</div></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhEQ_html_ab78f5b5b0b2caf7ca0e8eadc8615798e"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhEQ.html#ab78f5b5b0b2caf7ca0e8eadc8615798e">rgw::RGWFileHandle::FhEQ::operator()</a></div><div class="ttdeci">bool operator()(const fh_key &amp;k, const RGWFileHandle &amp;fh) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:607</div></div>
<div class="ttc" id="rgw__user_8h_html"><div class="ttname"><a href="rgw__user_8h.html">rgw_user.h</a></div></div>
<div class="ttc" id="classRGWGetObj_html_a64c7347d6d84de3796f661d19d7fc619"><div class="ttname"><a href="classRGWGetObj.html#a64c7347d6d84de3796f661d19d7fc619">RGWGetObj::partial_content</a></div><div class="ttdeci">bool partial_content</div><div class="ttdef"><b>Definition:</b> rgw_op.h:122</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_aa47266444aea293f58544708a78b2bb2"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#aa47266444aea293f58544708a78b2bb2">rgw::RGWFileHandle::Factory::Factory</a></div><div class="ttdeci">Factory()=delete</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a20daf561a0fb92aa12ae6cd449b93afb"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a20daf561a0fb92aa12ae6cd449b93afb">rgw::RGWFileHandle::set_mtime</a></div><div class="ttdeci">void set_mtime(const struct timespec &amp;ts)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:536</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_ad589ee0792f846ea86ac5430e3b657fe"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#ad589ee0792f846ea86ac5430e3b657fe">rgw::RGWCopyObjRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:2003</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a6baabcc9626a6b9ca4aca2757a40e6c1"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a6baabcc9626a6b9ca4aca2757a40e6c1">rgw::RGWFileHandle::add_marker</a></div><div class="ttdeci">void add_marker(uint64_t off, const boost::string_ref &amp;marker, uint8_t obj_type)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:453</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_aabc2bc87cd873984329527cb888b5c1b"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#aabc2bc87cd873984329527cb888b5c1b">rgw::RGWStatBucketRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1761</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a9349d7b338f95e08b5a481dec8175bb9"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a9349d7b338f95e08b5a481dec8175bb9">rgw::RGWFileHandle::is_open</a></div><div class="ttdeci">bool is_open() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:485</div></div>
<div class="ttc" id="classRGWAccessControlPolicy__S3_html"><div class="ttname"><a href="classRGWAccessControlPolicy__S3.html">RGWAccessControlPolicy_S3</a></div><div class="ttdef"><b>Definition:</b> rgw_acl_s3.h:80</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a9c48e1a236adb4908aaf4027f3dba8d6"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a9c48e1a236adb4908aaf4027f3dba8d6">rgw::RGWListBucketsRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1009</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a54119250286cc55abb58e66bbe65eeed"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a54119250286cc55abb58e66bbe65eeed">rgw::RGWLibFS::lookup_handle</a></div><div class="ttdeci">RGWFileHandle * lookup_handle(struct rgw_fh_hk fh_hk)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:912</div></div>
<div class="ttc" id="structreq__info_html_a30a877664bb45fcdf2204a065a913bc1"><div class="ttname"><a href="structreq__info.html#a30a877664bb45fcdf2204a065a913bc1">req_info::effective_uri</a></div><div class="ttdeci">string effective_uri</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1107</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_ab13bc9ef929d3086309c6c7a628f2109"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#ab13bc9ef929d3086309c6c7a628f2109">rgw::RGWReaddirRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1112</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a76bd369cf6dcec239b36e74ff1af9fb6"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a76bd369cf6dcec239b36e74ff1af9fb6">rgw::RGWReadRequest::send_response_data_error</a></div><div class="ttdeci">virtual int send_response_data_error()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1541</div></div>
<div class="ttc" id="classRGWListBuckets_html_a66dc6625c4e6826b95533f1549c52933"><div class="ttname"><a href="classRGWListBuckets.html#a66dc6625c4e6826b95533f1549c52933">RGWListBuckets::marker</a></div><div class="ttdeci">string marker</div><div class="ttdef"><b>Definition:</b> rgw_op.h:274</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ada58227cc76f0974c6f9eb77042d534d"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ada58227cc76f0974c6f9eb77042d534d">rgw::RGWFileHandle::get_depth</a></div><div class="ttdeci">uint16_t get_depth() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:322</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aedf815c3b4bef0b2a8e197ec29613df2"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aedf815c3b4bef0b2a8e197ec29613df2">rgw::RGWFileHandle::get_mtime</a></div><div class="ttdeci">struct timespec get_mtime() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:333</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_a9e2343eb99ef71f51646c5ca8e71596c"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#a9e2343eb99ef71f51646c5ca8e71596c">rgw::RGWStatLeafRequest::path</a></div><div class="ttdeci">std::string path</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1777</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_ac59403c289daf71f4cedb53fa0594e93"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#ac59403c289daf71f4cedb53fa0594e93">rgw::RGWReadRequest::nread</a></div><div class="ttdeci">size_t nread</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1462</div></div>
<div class="ttc" id="rgw__user_8cc_html_a9d0d930124e3ab630b88157dd300bc21"><div class="ttname"><a href="rgw__user_8cc.html#a9d0d930124e3ab630b88157dd300bc21">rgw_get_user_info_by_access_key</a></div><div class="ttdeci">int rgw_get_user_info_by_access_key(RGWRados *store, string &amp;access_key, RGWUserInfo &amp;info, RGWObjVersionTracker *objv_tracker, real_time *pmtime)</div><div class="ttdef"><b>Definition:</b> rgw_user.cc:335</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteBucketRequest_html_a930f5926835a32d837d6832e4f8cd6b0"><div class="ttname"><a href="classrgw_1_1RGWDeleteBucketRequest.html#a930f5926835a32d837d6832e4f8cd6b0">rgw::RGWDeleteBucketRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1361</div></div>
<div class="ttc" id="rgw__admin_8cc_html_a9b49a835107f65049c05bddc99751652"><div class="ttname"><a href="rgw__admin_8cc.html#a9b49a835107f65049c05bddc99751652">store</a></div><div class="ttdeci">static RGWRados * store</div><div class="ttdef"><b>Definition:</b> rgw_admin.cc:46</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html">rgw::RGWReaddirRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1086</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a7cb402ea666ff86a390d10adb99807af"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a7cb402ea666ff86a390d10adb99807af">rgw::RGWFileHandle::full_object_name</a></div><div class="ttdeci">std::string full_object_name(bool omit_bucket=false)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:398</div></div>
<div class="ttc" id="rgw__file_8h_html_abae3672cba958af452662b56b8ddcb0a"><div class="ttname"><a href="rgw__file_8h.html#abae3672cba958af452662b56b8ddcb0a">RGW_RWMODE</a></div><div class="ttdeci">#define RGW_RWMODE</div><div class="ttdef"><b>Definition:</b> rgw_file.h:47</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteBucketRequest_html"><div class="ttname"><a href="classrgw_1_1RGWDeleteBucketRequest.html">rgw::RGWDeleteBucketRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1317</div></div>
<div class="ttc" id="structRGWObjectCtx_html"><div class="ttname"><a href="structRGWObjectCtx.html">RGWObjectCtx</a></div><div class="ttdef"><b>Definition:</b> rgw_rados.h:1675</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a2458fca689a8607e30e8806b03c4d49d"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a2458fca689a8607e30e8806b03c4d49d">rgw::RGWWriteRequest::bucket_name</a></div><div class="ttdeci">const std::string &amp; bucket_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1876</div></div>
<div class="ttc" id="rgw__common_8h_html_adedf6eb016de146128a1adb706df37d8a2d190385dd5c788f89f49088db67e346"><div class="ttname"><a href="rgw__common_8h.html#adedf6eb016de146128a1adb706df37d8a2d190385dd5c788f89f49088db67e346">RGW_OP_STAT_OBJ</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:403</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_afa4e69794fe431ddeb98085f2ca7dbab"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#afa4e69794fe431ddeb98085f2ca7dbab">rgw::RGWCopyObjRequest::src_parent</a></div><div class="ttdeci">RGWFileHandle * src_parent</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1986</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a56f38544722185b5776797652641a1f1"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a56f38544722185b5776797652641a1f1">rgw::RGWFileHandle::stype</a></div><div class="ttdeci">const char * stype()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:318</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aa505b1652780ffb0e7928fff8c99727b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aa505b1652780ffb0e7928fff8c99727b">rgw::RGWFileHandle::FHCache</a></div><div class="ttdeci">cohort::lru::TreeX&lt; RGWFileHandle, FhTree, FhLT, FhEQ, fh_key, std::mutex &gt; FHCache</div><div class="ttdef"><b>Definition:</b> rgw_file.h:632</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_ae002efce3e6c15b881b179c47115d551"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#ae002efce3e6c15b881b179c47115d551">rgw::RGWWriteRequest::next_off</a></div><div class="ttdeci">off_t next_off</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1883</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a7d1ed061d0d137f417a8d35968777b1a"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a7d1ed061d0d137f417a8d35968777b1a">rgw::RGWWriteRequest::get_data</a></div><div class="ttdeci">virtual int get_data(buffer::list &amp;_bl)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1955</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_a37d71b098e09e54279cf799bca037b79"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#a37d71b098e09e54279cf799bca037b79">rgw::RGWStatLeafRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1833</div></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhLT_html_aede91ac2f051e41df3555d8f9ffb9201"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhLT.html#aede91ac2f051e41df3555d8f9ffb9201">rgw::RGWFileHandle::FhLT::operator()</a></div><div class="ttdeci">bool operator()(const RGWFileHandle &amp;lhs, const RGWFileHandle &amp;rhs) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:591</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aff531ac63c0d64e084f86048262cf335"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aff531ac63c0d64e084f86048262cf335">rgw::RGWFileHandle::FLAG_DIRECTORY</a></div><div class="ttdeci">static constexpr uint32_t FLAG_DIRECTORY</div><div class="ttdef"><b>Definition:</b> rgw_file.h:230</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a1696d5967f7de8188ca2a865a5be7860"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a1696d5967f7de8188ca2a865a5be7860">rgw::RGWListBucketsRequest::send_response_end</a></div><div class="ttdeci">virtual void send_response_end()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1060</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a4e5dc35045883cf9d7a3a4b67da61811"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a4e5dc35045883cf9d7a3a4b67da61811">rgw::RGWPutObjRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1385</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_af9ce32310ec7b44b014b1259dc6132b0"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#af9ce32310ec7b44b014b1259dc6132b0">rgw::RGWStatBucketRequest::get_attr</a></div><div class="ttdeci">buffer::list * get_attr(const std::string &amp;k)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1716</div></div>
<div class="ttc" id="namespacergw_html_a12e768365595ed6aa121311114126794"><div class="ttname"><a href="namespacergw.html#a12e768365595ed6aa121311114126794">rgw::WRITE_CLASS_ENCODER</a></div><div class="ttdeci">WRITE_CLASS_ENCODER(fh_key)</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_ac9db0c9f03992c41ad65af12ac8fb13a"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#ac9db0c9f03992c41ad65af12ac8fb13a">rgw::RGWStatBucketRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1723</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_aa35641c2c5b4775d8bbaa9fcd54c661a"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#aa35641c2c5b4775d8bbaa9fcd54c661a">rgw::RGWStatObjRequest::get_type</a></div><div class="ttdeci">virtual RGWOpType get_type()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1630</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a79596ceceab1a58961671ad172a1d96d"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a79596ceceab1a58961671ad172a1d96d">rgw::RGWPutObjRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1387</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a5bc97911889f7a3d1ca866c894d5e6bc"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a5bc97911889f7a3d1ca866c894d5e6bc">rgw::RGWListBucketsRequest::ix</a></div><div class="ttdeci">size_t ix</div><div class="ttdef"><b>Definition:</b> rgw_file.h:989</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_ae7703b5ff67da9d27369e448ace4180b"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#ae7703b5ff67da9d27369e448ace4180b">rgw::RGWStatObjRequest::send_response_data</a></div><div class="ttdeci">virtual int send_response_data(ceph::buffer::list &amp;_bl, off_t s_off, off_t e_off)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1683</div></div>
<div class="ttc" id="rgw__file_8h_html_a35b722e79e5cbfc3e70c42dc67657534"><div class="ttname"><a href="rgw__file_8h.html#a35b722e79e5cbfc3e70c42dc67657534">CREATE_FLAGS</a></div><div class="ttdeci">#define CREATE_FLAGS(x)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:235</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_aafec173de4b8d2b726bff6fb50a69f88"><div class="ttname"><a href="structrgw_1_1fh__key.html#aafec173de4b8d2b726bff6fb50a69f88">rgw::fh_key::fh_key</a></div><div class="ttdeci">fh_key(const std::string &amp;_b, const std::string &amp;_o)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:99</div></div>
<div class="ttc" id="structreq__state_html_a004fabcfb7244e3ed536dedbb6a98be1"><div class="ttname"><a href="structreq__state.html#a004fabcfb7244e3ed536dedbb6a98be1">req_state::relative_uri</a></div><div class="ttdeci">string relative_uri</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1237</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a5d8fc3081e34fd66e4c13df88e225ddf"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a5d8fc3081e34fd66e4c13df88e225ddf">rgw::RGWWriteRequest::rgw_fh</a></div><div class="ttdeci">RGWFileHandle * rgw_fh</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1878</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a5563c9498bce45b4f9581730d64bdba1"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a5563c9498bce45b4f9581730d64bdba1">rgw::RGWFileHandle::FhTree</a></div><div class="ttdeci">bi::rbtree&lt; RGWFileHandle, bi::compare&lt; FhLT &gt;, FhHook &gt; FhTree</div><div class="ttdef"><b>Definition:</b> rgw_file.h:629</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_a13bc87810d8a55e5743d31b5a58a9f6c"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#a13bc87810d8a55e5743d31b5a58a9f6c">rgw::RGWCreateBucketRequest::uri</a></div><div class="ttdeci">std::string &amp; uri</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1254</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html">rgw::RGWLibFS</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:676</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a8ddeffddf2157927c9d95a882b9c82e9"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a8ddeffddf2157927c9d95a882b9c82e9">rgw::RGWWriteRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1946</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_abfcfb9206a98b5bd3b0a448ac7c52f25"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#abfcfb9206a98b5bd3b0a448ac7c52f25">rgw::RGWCopyObjRequest::dst_parent</a></div><div class="ttdeci">RGWFileHandle * dst_parent</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1987</div></div>
<div class="ttc" id="classRGWGetObj_html_ad5e1b827d9220e8c84c2ac2f47298712"><div class="ttname"><a href="classRGWGetObj.html#ad5e1b827d9220e8c84c2ac2f47298712">RGWGetObj::end</a></div><div class="ttdeci">off_t end</div><div class="ttdef"><b>Definition:</b> rgw_op.h:114</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a03a640cceaa49b1f4ad1bb83f5ca38c7"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a03a640cceaa49b1f4ad1bb83f5ca38c7">rgw::RGWReaddirRequest::rcb</a></div><div class="ttdeci">rgw_readdir_cb rcb</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1093</div></div>
<div class="ttc" id="rgw__common_8h_html_aeff4b424dbfa8e3ce7f772f2429198f7"><div class="ttname"><a href="rgw__common_8h.html#aeff4b424dbfa8e3ce7f772f2429198f7">ERR_TOO_LARGE</a></div><div class="ttdeci">#define ERR_TOO_LARGE</div><div class="ttdef"><b>Definition:</b> rgw_common.h:165</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a5ee74e590bf7349c0cd1e08cb6ecd4e3"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a5ee74e590bf7349c0cd1e08cb6ecd4e3">rgw::RGWStatObjRequest::name</a></div><div class="ttdeci">virtual const string name()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1629</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a527db9bd370f200b120ec9d136a38c15"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a527db9bd370f200b120ec9d136a38c15">rgw::RGWFileHandle::set_times</a></div><div class="ttdeci">void set_times(real_time t)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:526</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html_a059fa28b78f0b62b21007533d3c8b95c"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html#a059fa28b78f0b62b21007533d3c8b95c">rgw::RGWDeleteObjRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1579</div></div>
<div class="ttc" id="classRGWCopyObj_html"><div class="ttname"><a href="classRGWCopyObj.html">RGWCopyObj</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:877</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a11e8af827a1bcf6dec846d0291185285"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a11e8af827a1bcf6dec846d0291185285">rgw::RGWLibFS::lookup_fh</a></div><div class="ttdeci">LookupFHResult lookup_fh(RGWFileHandle *parent, const char *name, const uint32_t flags=RGWFileHandle::FLAG_NONE)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:801</div></div>
<div class="ttc" id="structrgw__obj__key_html_ab51adda0cbbec2ff9230b9ffe100e939"><div class="ttname"><a href="structrgw__obj__key.html#ab51adda0cbbec2ff9230b9ffe100e939">rgw_obj_key::name</a></div><div class="ttdeci">string name</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1117</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a9213adb9ffb760cdbfe5109d3db972e8"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a9213adb9ffb760cdbfe5109d3db972e8">rgw::RGWFileHandle::creating</a></div><div class="ttdeci">bool creating() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:491</div></div>
<div class="ttc" id="classRGWUserBuckets_html_ad54feabb52e471a9cacdbaca4828b9e6"><div class="ttname"><a href="classRGWUserBuckets.html#ad54feabb52e471a9cacdbaca4828b9e6">RGWUserBuckets::get_buckets</a></div><div class="ttdeci">map&lt; string, RGWBucketEnt &gt; &amp; get_buckets()</div><div class="ttdef"><b>Definition:</b> rgw_bucket.h:143</div></div>
<div class="ttc" id="namespacergw_html_a5733d80369bdc151f8f734905770a1f3"><div class="ttname"><a href="namespacergw.html#a5733d80369bdc151f8f734905770a1f3">rgw::ignore</a></div><div class="ttdeci">static void ignore(T &amp;&amp;)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:54</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_a9170fe5349f00f4860d4a6aa1c067f3e"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#a9170fe5349f00f4860d4a6aa1c067f3e">rgw::RGWCreateBucketRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1299</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_afaf9f23d968b80f2894d9e84691df8a8"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#afaf9f23d968b80f2894d9e84691df8a8">rgw::RGWStatObjRequest::mtime</a></div><div class="ttdeci">real_time mtime()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1639</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_aa1c7c83992e6a23a3c173e492b52e792"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#aa1c7c83992e6a23a3c173e492b52e792">rgw::RGWLibFS::get_user</a></div><div class="ttdeci">RGWUserInfo * get_user()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:961</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_a53acc4c80ee2e847200f9667625d2883"><div class="ttname"><a href="structrgw_1_1fh__key.html#a53acc4c80ee2e847200f9667625d2883">rgw::fh_key::fh_key</a></div><div class="ttdeci">fh_key(const uint64_t bk, const char *_o)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:94</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_a96fb26151ff0cb4425b9fc6deb3f1e04"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#a96fb26151ff0cb4425b9fc6deb3f1e04">rgw::RGWStatBucketRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1734</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_ade88b3b8ef261a29036904cafd935ce3"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#ade88b3b8ef261a29036904cafd935ce3">rgw::RGWStatObjRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1660</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a93ee4c3f0f85ce2d1ad8cbd9c1ad7df3"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a93ee4c3f0f85ce2d1ad8cbd9c1ad7df3">rgw::RGWFileHandle::relative_object_name</a></div><div class="ttdeci">std::string relative_object_name()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:423</div></div>
<div class="ttc" id="classrgw_1_1LDAPHelper_html"><div class="ttname"><a href="classrgw_1_1LDAPHelper.html">rgw::LDAPHelper</a></div><div class="ttdef"><b>Definition:</b> rgw_ldap.h:113</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ad161b2b69b1702aaaa3a77436050fc7c"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ad161b2b69b1702aaaa3a77436050fc7c">rgw::RGWFileHandle::write</a></div><div class="ttdeci">int write(uint64_t off, size_t len, size_t *nbytes, void *buffer)</div><div class="ttdef"><b>Definition:</b> rgw_file.cc:632</div></div>
<div class="ttc" id="structreq__state_html_a39681a359f8083bdf2ca3c058086cce9"><div class="ttname"><a href="structreq__state.html#a39681a359f8083bdf2ca3c058086cce9">req_state::bucket_attrs</a></div><div class="ttdeci">map&lt; string, bufferlist &gt; bucket_attrs</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1273</div></div>
<div class="ttc" id="classRGWRados_html_acf6063a74d8174f965ace73d8c72d237ace5a2fd298de3324b5f5e64eb9aad63f"><div class="ttname"><a href="classRGWRados.html#acf6063a74d8174f965ace73d8c72d237ace5a2fd298de3324b5f5e64eb9aad63f">RGWRados::ATTRSMOD_MERGE</a></div><div class="ttdef"><b>Definition:</b> rgw_rados.h:2430</div></div>
<div class="ttc" id="rgw__user_8cc_html_adf858619fe81ae69cc25ce7f96454302"><div class="ttname"><a href="rgw__user_8cc.html#adf858619fe81ae69cc25ce7f96454302">rgw_get_user_info_by_uid</a></div><div class="ttdeci">int rgw_get_user_info_by_uid(RGWRados *store, const rgw_user &amp;uid, RGWUserInfo &amp;info, RGWObjVersionTracker *const objv_tracker, real_time *const pmtime, rgw_cache_entry_info *const cache_info, map&lt; string, bufferlist &gt; *const pattrs)</div><div class="ttdef"><b>Definition:</b> rgw_user.cc:270</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a732a49b095a04049e7bbe89945fa27e5"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a732a49b095a04049e7bbe89945fa27e5">rgw::RGWStatObjRequest::_size</a></div><div class="ttdeci">uint64_t _size</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1609</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a34f5489c4294a9f4cdc4c7ab8ebd2aba"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a34f5489c4294a9f4cdc4c7ab8ebd2aba">rgw::RGWReaddirRequest::rgw_fh</a></div><div class="ttdeci">RGWFileHandle * rgw_fh</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1090</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_aeaf06ce869fba5c3bf85f29343359f3d"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#aeaf06ce869fba5c3bf85f29343359f3d">rgw::RGWStatObjRequest::send_response_data_error</a></div><div class="ttdeci">virtual int send_response_data_error()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1690</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a01013af3b107e3ddef71ceb071379bbf"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a01013af3b107e3ddef71ceb071379bbf">rgw::RGWReadRequest::read_resid</a></div><div class="ttdeci">size_t read_resid</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1463</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_a4a22af0f5cb2b3d73ed4e5eabd5ee310"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#a4a22af0f5cb2b3d73ed4e5eabd5ee310">rgw::RGWCopyObjRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:2005</div></div>
<div class="ttc" id="classRGWDeleteObj_html"><div class="ttname"><a href="classRGWDeleteObj.html">RGWDeleteObj</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:847</div></div>
<div class="ttc" id="classRGWGetObj_html_a9c8656dea08180704b7a7a1ee8671929"><div class="ttname"><a href="classRGWGetObj.html#a9c8656dea08180704b7a7a1ee8671929">RGWGetObj::execute</a></div><div class="ttdeci">void execute()</div><div class="ttdef"><b>Definition:</b> rgw_op.cc:1291</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_aeccf56284a5442fcf146805671c9411c"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#aeccf56284a5442fcf146805671c9411c">rgw::RGWWriteRequest::RGWWriteRequest</a></div><div class="ttdeci">RGWWriteRequest(CephContext *_cct, RGWUserInfo *_user, RGWFileHandle *_fh, const std::string &amp;_bname, const std::string &amp;_oname)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1887</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html"><div class="ttname"><a href="structrgw_1_1fh__key.html">rgw::fh_key</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:76</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a42f32743687a46f2f670e785938cf7b0"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a42f32743687a46f2f670e785938cf7b0">rgw::RGWFileHandle::stat</a></div><div class="ttdeci">int stat(struct stat *st)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:355</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_af95b01f600fd6a173d2b604685553bda"><div class="ttname"><a href="structrgw_1_1fh__key.html#af95b01f600fd6a173d2b604685553bda">rgw::fh_key::decode</a></div><div class="ttdeci">void decode(bufferlist::iterator &amp;bl)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:111</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteBucketRequest_html_a7dce96da3bc3b09b7d1ffa4f16d7f246"><div class="ttname"><a href="classrgw_1_1RGWDeleteBucketRequest.html#a7dce96da3bc3b09b7d1ffa4f16d7f246">rgw::RGWDeleteBucketRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1329</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html_a22982d37a8082cb3491aae0f41f879ae"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html#a22982d37a8082cb3491aae0f41f879ae">rgw::RGWDeleteObjRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1568</div></div>
<div class="ttc" id="namespacergw_html_ac9b5e09284173b17c1c330337c079b0d"><div class="ttname"><a href="namespacergw.html#ac9b5e09284173b17c1c330337c079b0d">rgw::operator&gt;</a></div><div class="ttdeci">bool operator&gt;(const fh_key &amp;lhs, const fh_key &amp;rhs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:128</div></div>
<div class="ttc" id="rgw__common_8h_html_a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef"><div class="ttname"><a href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa30c255de586ab01e0cffc930fa653cef">OP_GET</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:378</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ac927da7ee130812cd099fe2fff956b67"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ac927da7ee130812cd099fe2fff956b67">rgw::RGWFileHandle::fh_hook</a></div><div class="ttdeci">tree_hook_type fh_hook</div><div class="ttdef"><b>Definition:</b> rgw_file.h:621</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a02f7b04656c4ad9551765cfda6778c25"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a02f7b04656c4ad9551765cfda6778c25">rgw::RGWWriteRequest::processor</a></div><div class="ttdeci">RGWPutObjProcessor * processor</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1879</div></div>
<div class="ttc" id="structreq__state_html_a0a8be031d3dfaa6ff9500ae0aa3e580f"><div class="ttname"><a href="structreq__state.html#a0a8be031d3dfaa6ff9500ae0aa3e580f">req_state::src_bucket_name</a></div><div class="ttdeci">string src_bucket_name</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1260</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_af2ff9fe0ef5e0545a807067c6636c34c"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#af2ff9fe0ef5e0545a807067c6636c34c">rgw::RGWLibFS::RGWLibFS</a></div><div class="ttdeci">RGWLibFS(CephContext *_cct, const char *_uid, const char *_user_id, const char *_key)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:729</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a4e589d393da9c14ec4d9261653dad378"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a4e589d393da9c14ec4d9261653dad378">rgw::RGWPutObjRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1402</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ac565ed2678f9c2755f4dee617bcabea1"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ac565ed2678f9c2755f4dee617bcabea1">rgw::RGWFileHandle::make_fhk</a></div><div class="ttdeci">fh_key make_fhk(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:444</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a71add63c3631838b73297f4f34cda182"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a71add63c3631838b73297f4f34cda182">rgw::RGWFileHandle::find_marker</a></div><div class="ttdeci">std::string find_marker(uint64_t off)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:474</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a048d9c743d05e997636aaea1a89e7aa6"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a048d9c743d05e997636aaea1a89e7aa6">rgw::RGWReadRequest::send_response_data</a></div><div class="ttdeci">virtual int send_response_data(ceph::buffer::list &amp;bl, off_t bl_off, off_t bl_len)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1518</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aa4a3e26bc13cce2e80a843c2e878050e"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aa4a3e26bc13cce2e80a843c2e878050e">rgw::RGWFileHandle::open</a></div><div class="ttdeci">uint32_t open(uint32_t gsh_flags)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:493</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a5f7f65038ea8ec242a0a7a308f28f861"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a5f7f65038ea8ec242a0a7a308f28f861">rgw::RGWStatObjRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1647</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_a849c7a7c8f7d00b5e61083b05165e87d"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#a849c7a7c8f7d00b5e61083b05165e87d">rgw::RGWCreateBucketRequest::read_permissions</a></div><div class="ttdeci">virtual int read_permissions(RGWOp *op_obj)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1264</div></div>
<div class="ttc" id="classRGWListBucket_html"><div class="ttname"><a href="classRGWListBucket.html">RGWListBucket</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:366</div></div>
<div class="ttc" id="classRGWPutObj_html"><div class="ttname"><a href="classRGWPutObj.html">RGWPutObj</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:637</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a341675e834ef07cc43021999de82717c"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a341675e834ef07cc43021999de82717c">rgw::RGWFileHandle::get_fs</a></div><div class="ttdeci">RGWLibFS * get_fs()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:326</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a32f4a6b773792341c0ef65c9a4a9f10b"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a32f4a6b773792341c0ef65c9a4a9f10b">rgw::RGWReadRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1514</div></div>
<div class="ttc" id="rgw__common_8h_html"><div class="ttname"><a href="rgw__common_8h.html">rgw_common.h</a></div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_aa938558fd255ee4fc297596ad3ae5991"><div class="ttname"><a href="structrgw_1_1fh__key.html#aa938558fd255ee4fc297596ad3ae5991">rgw::fh_key::fh_key</a></div><div class="ttdeci">fh_key(const uint64_t bk, const uint64_t ok)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:89</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a384688b20c1b8f4bbb9aaff335239963"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a384688b20c1b8f4bbb9aaff335239963">rgw::RGWListBucketsRequest::send_response_data</a></div><div class="ttdeci">virtual void send_response_data(RGWUserBuckets &amp;buckets)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1047</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_aad7147e0ac74c588716b23f1d15f1387"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#aad7147e0ac74c588716b23f1d15f1387">rgw::RGWFileHandle::FLAG_BUCKET</a></div><div class="ttdeci">static constexpr uint32_t FLAG_BUCKET</div><div class="ttdef"><b>Definition:</b> rgw_file.h:231</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html_ac081f5aa62267d318350640ae322cfc9"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html#ac081f5aa62267d318350640ae322cfc9">rgw::RGWDeleteObjRequest::obj_name</a></div><div class="ttdeci">const std::string &amp; obj_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1558</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_a3f62a1ce8c7d8b4982bc762d07b095c1"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#a3f62a1ce8c7d8b4982bc762d07b095c1">rgw::RGWCopyObjRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:2017</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_ab24567ae4df5a9c208e6923179ba5e72"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#ab24567ae4df5a9c208e6923179ba5e72">rgw::RGWStatBucketRequest::uri</a></div><div class="ttdeci">std::string uri</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1706</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a338050595eedd61cc22426ba39768171"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a338050595eedd61cc22426ba39768171">rgw::RGWStatObjRequest::get_mtime</a></div><div class="ttdeci">real_time get_mtime() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:1632</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_a0f47a2c5846ca70376de4637793e4d48"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#a0f47a2c5846ca70376de4637793e4d48">rgw::RGWCopyObjRequest::RGWCopyObjRequest</a></div><div class="ttdeci">RGWCopyObjRequest(CephContext *_cct, RGWUserInfo *_user, RGWFileHandle *_src_parent, RGWFileHandle *_dst_parent, const std::string &amp;_src_name, const std::string &amp;_dst_name)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1991</div></div>
<div class="ttc" id="rgw__lib_8h_html"><div class="ttname"><a href="rgw__lib_8h.html">rgw_lib.h</a></div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a0ebf39f3499094b272e65f01ad2d7c2b"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a0ebf39f3499094b272e65f01ad2d7c2b">rgw::RGWReaddirRequest::cb_arg</a></div><div class="ttdeci">void * cb_arg</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1092</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_a9067bf33363c02e1f8b96ae990ea5f08"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#a9067bf33363c02e1f8b96ae990ea5f08">rgw::RGWWriteRequest::data</a></div><div class="ttdeci">buffer::list data</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1880</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a8d712dfbcebd78e6c33b0e92359f5be2"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a8d712dfbcebd78e6c33b0e92359f5be2">rgw::RGWStatObjRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1679</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_af7449c9fe71c1bcdb32e023fcbcd8e11"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#af7449c9fe71c1bcdb32e023fcbcd8e11">rgw::RGWFileHandle::FLAG_ROOT</a></div><div class="ttdeci">static constexpr uint32_t FLAG_ROOT</div><div class="ttdef"><b>Definition:</b> rgw_file.h:227</div></div>
<div class="ttc" id="structreq__state_html_a4694052e052f14d872b0dc085125e469"><div class="ttname"><a href="structreq__state.html#a4694052e052f14d872b0dc085125e469">req_state::obj_ctx</a></div><div class="ttdeci">void * obj_ctx</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1318</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html">rgw::RGWCopyObjRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1982</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_ab611e3e26cc44d913c5403bfb757ea69"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#ab611e3e26cc44d913c5403bfb757ea69">rgw::RGWStatObjRequest::get_attr</a></div><div class="ttdeci">buffer::list * get_attr(const std::string &amp;k)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1642</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a3973ecfd24da048755a879d3bf79002e"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a3973ecfd24da048755a879d3bf79002e">rgw::RGWReadRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1494</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a937de8d92576a62e12190267948fde4b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a937de8d92576a62e12190267948fde4b">rgw::RGWFileHandle::object_name</a></div><div class="ttdeci">const std::string &amp; object_name() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:396</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_a7ef649bf83d9530a7377e651b0676d3b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#a7ef649bf83d9530a7377e651b0676d3b">rgw::RGWFileHandle::Factory::flags</a></div><div class="ttdeci">uint32_t flags</div><div class="ttdef"><b>Definition:</b> rgw_file.h:644</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a3c7b6e87fd1542e1498afb8c83abae9e"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a3c7b6e87fd1542e1498afb8c83abae9e">rgw::RGWPutObjRequest::verify_params</a></div><div class="ttdeci">virtual int verify_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1444</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteBucketRequest_html_a2f8c1590e3619dd4974ec8de838dea94"><div class="ttname"><a href="classrgw_1_1RGWDeleteBucketRequest.html#a2f8c1590e3619dd4974ec8de838dea94">rgw::RGWDeleteBucketRequest::header_init</a></div><div class="ttdeci">virtual int header_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1342</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a1ea8c6d92723ade8196ca80dde1f5b9a"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a1ea8c6d92723ade8196ca80dde1f5b9a">rgw::RGWLibFS::ref</a></div><div class="ttdeci">RGWLibFS * ref()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:762</div></div>
<div class="ttc" id="structreq__info_html_ab810e10f4cc4c306b3f6ff303ee5f64f"><div class="ttname"><a href="structreq__info.html#ab810e10f4cc4c306b3f6ff303ee5f64f">req_info::method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1103</div></div>
<div class="ttc" id="classrgw_1_1RGWLibRequest_html"><div class="ttname"><a href="classrgw_1_1RGWLibRequest.html">rgw::RGWLibRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_lib.h:103</div></div>
<div class="ttc" id="structRGWBucketEnt_html_af8b9ef66b40a78862007e883847da902"><div class="ttname"><a href="structRGWBucketEnt.html#af8b9ef66b40a78862007e883847da902">RGWBucketEnt::bucket</a></div><div class="ttdeci">rgw_bucket bucket</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1358</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_a45f6a11394ad0b6130e17d58880b44f2"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#a45f6a11394ad0b6130e17d58880b44f2">rgw::RGWStatBucketRequest::RGWStatBucketRequest</a></div><div class="ttdeci">RGWStatBucketRequest(CephContext *_cct, RGWUserInfo *_user, const std::string &amp;_path)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1709</div></div>
<div class="ttc" id="structRGWBucketEnt_html"><div class="ttname"><a href="structRGWBucketEnt.html">RGWBucketEnt</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:1357</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_a870cf091372837356e1726170e228684"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#a870cf091372837356e1726170e228684">rgw::RGWPutObjRequest::get_data</a></div><div class="ttdeci">virtual int get_data(buffer::list &amp;_bl)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1434</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_aca6d7c27dedbe28fd4584db4e804af32"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#aca6d7c27dedbe28fd4584db4e804af32">rgw::RGWStatBucketRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1757</div></div>
<div class="ttc" id="rgw__main_8cc_html_a16c5542a513398593bf270eeebd3ea6d"><div class="ttname"><a href="rgw__main_8cc.html#a16c5542a513398593bf270eeebd3ea6d">intrusive_ptr_add_ref</a></div><div class="ttdeci">void intrusive_ptr_add_ref(CephContext *cct)</div><div class="ttdef"><b>Definition:</b> rgw_main.cc:176</div></div>
<div class="ttc" id="classRGWAccessControlPolicy__S3_html_ad399d9d60a8eb4759bcdf2a6e36488be"><div class="ttname"><a href="classRGWAccessControlPolicy__S3.html#ad399d9d60a8eb4759bcdf2a6e36488be">RGWAccessControlPolicy_S3::create_canned</a></div><div class="ttdeci">virtual int create_canned(ACLOwner &amp;_owner, ACLOwner &amp;bucket_owner, string canned_acl)</div><div class="ttdef"><b>Definition:</b> rgw_acl_s3.h:92</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html">rgw::RGWPutObjRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1368</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html">rgw::RGWDeleteObjRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1553</div></div>
<div class="ttc" id="structreq__state_html_a4bb1760c50a9306e90bcc1b63d453d53"><div class="ttname"><a href="structreq__state.html#a4bb1760c50a9306e90bcc1b63d453d53">req_state::object</a></div><div class="ttdeci">rgw_obj_key object</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1258</div></div>
<div class="ttc" id="structreq__state_html_a2fd0c760203508360c7b9ac16993b040"><div class="ttname"><a href="structreq__state.html#a2fd0c760203508360c7b9ac16993b040">req_state::bucket_owner</a></div><div class="ttdeci">ACLOwner bucket_owner</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1262</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_a1e07b5b0976846e3e5464ab59df80f0a"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#a1e07b5b0976846e3e5464ab59df80f0a">rgw::RGWStatBucketRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1721</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_aa653b324eccad11ee3ce7b5b0f0c0903"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#aa653b324eccad11ee3ce7b5b0f0c0903">rgw::RGWWriteRequest::multipart</a></div><div class="ttdeci">bool multipart</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1885</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_a6d0043585c5a46437fafb2c0a9c3d7af"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#a6d0043585c5a46437fafb2c0a9c3d7af">rgw::RGWLibFS::intrusive_ptr_release</a></div><div class="ttdeci">friend void intrusive_ptr_release(const RGWLibFS *fs)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:755</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_a63f223c029b152d713934935322fa564"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#a63f223c029b152d713934935322fa564">rgw::RGWReaddirRequest::send_response</a></div><div class="ttdeci">virtual void send_response()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1168</div></div>
<div class="ttc" id="classRGWOp_html"><div class="ttname"><a href="classRGWOp.html">RGWOp</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:46</div></div>
<div class="ttc" id="structRGWUserInfo_html"><div class="ttname"><a href="structRGWUserInfo.html">RGWUserInfo</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:530</div></div>
<div class="ttc" id="structreq__state_html_a790486d3727d3bfd75f815d0c5a5d5cd"><div class="ttname"><a href="structreq__state.html#a790486d3727d3bfd75f815d0c5a5d5cd">req_state::user</a></div><div class="ttdeci">RGWUserInfo * user</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1278</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_a307f06a04702dc42db82dd6114b0ae0c"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#a307f06a04702dc42db82dd6114b0ae0c">rgw::RGWStatBucketRequest::get_ctime</a></div><div class="ttdeci">real_time get_ctime() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:1753</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_ace20a89f7cb82645f5deda74c17023aa"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#ace20a89f7cb82645f5deda74c17023aa">rgw::RGWWriteRequest::put_data</a></div><div class="ttdeci">void put_data(off_t off, buffer::list &amp;_bl)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1963</div></div>
<div class="ttc" id="structreq__info_html_a29b3cc2e09783b4fbf0c388a10f5c2a4"><div class="ttname"><a href="structreq__info.html#a29b3cc2e09783b4fbf0c388a10f5c2a4">req_info::request_params</a></div><div class="ttdeci">string request_params</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1108</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a4803d4c38744d31a6934094f4127ac01"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a4803d4c38744d31a6934094f4127ac01">rgw::RGWFileHandle::encode</a></div><div class="ttdeci">void encode(buffer::list &amp;bl) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:544</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_ace9c37299b8c00ceee03e3d769f0a98f"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#ace9c37299b8c00ceee03e3d769f0a98f">rgw::RGWFileHandle::Factory::Factory</a></div><div class="ttdeci">Factory(RGWLibFS *fs, uint32_t fs_inst, RGWFileHandle *parent, const fh_key &amp;fhk, std::string &amp;name, uint32_t flags)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:648</div></div>
<div class="ttc" id="structreq__state_html_aff7ec1d9130564f00e60adbef589925a"><div class="ttname"><a href="structreq__state.html#aff7ec1d9130564f00e60adbef589925a">req_state::bucket</a></div><div class="ttdeci">rgw_bucket bucket</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1257</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_a21b6eda2d05366278705094b3a46586e"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#a21b6eda2d05366278705094b3a46586e">rgw::RGWStatLeafRequest::matched</a></div><div class="ttdeci">bool matched</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1778</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html">rgw::RGWCreateBucketRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1250</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a0bb687662e26e56ad9c238dae44a8974"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a0bb687662e26e56ad9c238dae44a8974">rgw::RGWStatObjRequest::execute</a></div><div class="ttdeci">virtual void execute()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1695</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html">rgw::RGWStatBucketRequest</a></div><div class="ttdef"><b>Definition:</b> rgw_file.h:1702</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a151c7b6a6f016e56104020cfbecb2b88"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a151c7b6a6f016e56104020cfbecb2b88">rgw::RGWFileHandle::FLAG_LOCK</a></div><div class="ttdeci">static constexpr uint32_t FLAG_LOCK</div><div class="ttdef"><b>Definition:</b> rgw_file.h:232</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ac619fb7838374169af1b34a4f8a1dcad"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ac619fb7838374169af1b34a4f8a1dcad">rgw::RGWFileHandle::close</a></div><div class="ttdeci">int close()</div><div class="ttdef"><b>Definition:</b> rgw_file.cc:676</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a945f24e31d3b6d132a519a94d9ffd9db"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a945f24e31d3b6d132a519a94d9ffd9db">rgw::RGWReadRequest::rgw_fh</a></div><div class="ttdeci">RGWFileHandle * rgw_fh</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1460</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a88e9c8f5c6248962b5ba3f119d78aae8"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a88e9c8f5c6248962b5ba3f119d78aae8">rgw::RGWStatObjRequest::bucket_name</a></div><div class="ttdeci">const std::string &amp; bucket_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1607</div></div>
<div class="ttc" id="structreq__state_html_a98ff7b0fe2e9f0a932493c80c89280dc"><div class="ttname"><a href="structreq__state.html#a98ff7b0fe2e9f0a932493c80c89280dc">req_state::cct</a></div><div class="ttdeci">CephContext * cct</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1228</div></div>
<div class="ttc" id="structreq__state_html_a72a6e29f70fea4bf43a5c684f0487285"><div class="ttname"><a href="structreq__state.html#a72a6e29f70fea4bf43a5c684f0487285">req_state::src_object</a></div><div class="ttdeci">rgw_obj_key src_object</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1261</div></div>
<div class="ttc" id="classrgw_1_1RGWWriteRequest_html_aaec06c9054e6d52ab8af9b054628e15c"><div class="ttname"><a href="classrgw_1_1RGWWriteRequest.html#aaec06c9054e6d52ab8af9b054628e15c">rgw::RGWWriteRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1902</div></div>
<div class="ttc" id="classRGWStatBucket_html"><div class="ttname"><a href="classRGWStatBucket.html">RGWStatBucket</a></div><div class="ttdef"><b>Definition:</b> rgw_op.h:508</div></div>
<div class="ttc" id="classrgw_1_1RGWCreateBucketRequest_html_ab009ed381323d032ac450c411231e52d"><div class="ttname"><a href="classrgw_1_1RGWCreateBucketRequest.html#ab009ed381323d032ac450c411231e52d">rgw::RGWCreateBucketRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1269</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a7fdbebe5b4659bb57e548808cace45be"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a7fdbebe5b4659bb57e548808cace45be">rgw::RGWFileHandle::is_object</a></div><div class="ttdeci">bool is_object() const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:488</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_af645846abee26af6fb90fafeb728c4fc"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#af645846abee26af6fb90fafeb728c4fc">rgw::RGWPutObjRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1425</div></div>
<div class="ttc" id="classrgw_1_1RGWToken_html"><div class="ttname"><a href="classrgw_1_1RGWToken.html">rgw::RGWToken</a></div><div class="ttdef"><b>Definition:</b> rgw_token.h:30</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a31ca13a8d792f594a537fa058d846292"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a31ca13a8d792f594a537fa058d846292">rgw::RGWFileHandle::set_atime</a></div><div class="ttdeci">void set_atime(const struct timespec &amp;ts)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:540</div></div>
<div class="ttc" id="classrgw_1_1RGWReadRequest_html_a5f175d8808079da3eb511c519652686e"><div class="ttname"><a href="classrgw_1_1RGWReadRequest.html#a5f175d8808079da3eb511c519652686e">rgw::RGWReadRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1481</div></div>
<div class="ttc" id="classrgw_1_1RGWDeleteObjRequest_html_ab3bcde7c3f655279719c1ed0848f87bc"><div class="ttname"><a href="classrgw_1_1RGWDeleteObjRequest.html#ab3bcde7c3f655279719c1ed0848f87bc">rgw::RGWDeleteObjRequest::bucket_name</a></div><div class="ttdeci">const std::string &amp; bucket_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1557</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_adb2260d509358fc9005c888215716a1e"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#adb2260d509358fc9005c888215716a1e">rgw::RGWReaddirRequest::offset</a></div><div class="ttdeci">uint64_t * offset</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1091</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_1_1Factory_html_a38b0a79144abfeff79a25a5b4aa380eb"><div class="ttname"><a href="classrgw_1_1RGWFileHandle_1_1Factory.html#a38b0a79144abfeff79a25a5b4aa380eb">rgw::RGWFileHandle::Factory::alloc</a></div><div class="ttdeci">cohort::lru::Object * alloc()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:660</div></div>
<div class="ttc" id="structrgw_1_1RGWFileHandle_1_1FhLT_html_a037449d03534e81432d13b0b8486f3eb"><div class="ttname"><a href="structrgw_1_1RGWFileHandle_1_1FhLT.html#a037449d03534e81432d13b0b8486f3eb">rgw::RGWFileHandle::FhLT::operator()</a></div><div class="ttdeci">bool operator()(const fh_key &amp;k, const RGWFileHandle &amp;fh) const </div><div class="ttdef"><b>Definition:</b> rgw_file.h:595</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_ac54638447ec4940e07d69dac37de4292"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#ac54638447ec4940e07d69dac37de4292">rgw::RGWFileHandle::get_directory</a></div><div class="ttdeci">directory * get_directory()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:312</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_add7324e84d5ebafd1e1a086bd4813800"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#add7324e84d5ebafd1e1a086bd4813800">rgw::RGWListBucketsRequest::rcb</a></div><div class="ttdeci">rgw_readdir_cb rcb</div><div class="ttdef"><b>Definition:</b> rgw_file.h:988</div></div>
<div class="ttc" id="classrgw_1_1RGWStatBucketRequest_html_a79236e614f834efe976c69bb2b4bc4ed"><div class="ttname"><a href="classrgw_1_1RGWStatBucketRequest.html#a79236e614f834efe976c69bb2b4bc4ed">rgw::RGWStatBucketRequest::matched</a></div><div class="ttdeci">bool matched()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1766</div></div>
<div class="ttc" id="classrgw_1_1RGWPutObjRequest_html_aeed07fa4752cee6e336928dbd82d0da2"><div class="ttname"><a href="classrgw_1_1RGWPutObjRequest.html#aeed07fa4752cee6e336928dbd82d0da2">rgw::RGWPutObjRequest::bucket_name</a></div><div class="ttdeci">const std::string &amp; bucket_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1372</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a42104aadfd3dfd985655b3bff2824da3"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a42104aadfd3dfd985655b3bff2824da3">rgw::RGWFileHandle::make_key_name</a></div><div class="ttdeci">std::string make_key_name(const char *name)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:436</div></div>
<div class="ttc" id="rgw__common_8h_html_a7d2f08967a81e2e29e2cfa6e376bc1efa4c629f6a90286b343e3f222ff96f94d5"><div class="ttname"><a href="rgw__common_8h.html#a7d2f08967a81e2e29e2cfa6e376bc1efa4c629f6a90286b343e3f222ff96f94d5">OP_DELETE</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:380</div></div>
<div class="ttc" id="classrgw_1_1RGWReaddirRequest_html_aae3f049bc766084ab850ee99004d35a7"><div class="ttname"><a href="classrgw_1_1RGWReaddirRequest.html#aae3f049bc766084ab850ee99004d35a7">rgw::RGWReaddirRequest::eof</a></div><div class="ttdeci">bool eof()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1236</div></div>
<div class="ttc" id="classrgw_1_1LDAPHelper_html_a695c45289ece0fa35b1242666bb0db75"><div class="ttname"><a href="classrgw_1_1LDAPHelper.html#a695c45289ece0fa35b1242666bb0db75">rgw::LDAPHelper::auth</a></div><div class="ttdeci">int auth(const std::string uid, const std::string pwd)</div><div class="ttdef"><b>Definition:</b> rgw_ldap.h:128</div></div>
<div class="ttc" id="classrgw_1_1RGWCopyObjRequest_html_a49a290359e4fec4be49d694b174aa0b7"><div class="ttname"><a href="classrgw_1_1RGWCopyObjRequest.html#a49a290359e4fec4be49d694b174aa0b7">rgw::RGWCopyObjRequest::src_name</a></div><div class="ttdeci">const std::string &amp; src_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1988</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_acf29e35b3333e7a3faf079d33f295e7b"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#acf29e35b3333e7a3faf079d33f295e7b">rgw::RGWFileHandle::get_fh</a></div><div class="ttdeci">struct rgw_file_handle * get_fh()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:324</div></div>
<div class="ttc" id="structrgw_1_1fh__key_html_a786a0b84dc3295769b85a33876cb687e"><div class="ttname"><a href="structrgw_1_1fh__key.html#a786a0b84dc3295769b85a33876cb687e">rgw::fh_key::fh_key</a></div><div class="ttdeci">fh_key(const rgw_fh_hk &amp;_hk)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:84</div></div>
<div class="ttc" id="structreq__info_html_a1adfdf97b8480f4b55ae8c2aa9e18404"><div class="ttname"><a href="structreq__info.html#a1adfdf97b8480f4b55ae8c2aa9e18404">req_info::domain</a></div><div class="ttdeci">string domain</div><div class="ttdef"><b>Definition:</b> rgw_common.h:1109</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_a7cb98871f3f6a2b35dd84e00e372d8e4"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#a7cb98871f3f6a2b35dd84e00e372d8e4">rgw::RGWStatLeafRequest::get_params</a></div><div class="ttdeci">virtual int get_params()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1828</div></div>
<div class="ttc" id="namespacergw_html_a07be50b94390c980f71b1e0604380520"><div class="ttname"><a href="namespacergw.html#a07be50b94390c980f71b1e0604380520">rgw::get_rgwfh</a></div><div class="ttdeci">static RGWFileHandle * get_rgwfh(struct rgw_file_handle *fh)</div><div class="ttdef"><b>Definition:</b> rgw_file.h:669</div></div>
<div class="ttc" id="classrgw_1_1RGWListBucketsRequest_html_a1c5355b578c682ebecb084c43d88a092"><div class="ttname"><a href="classrgw_1_1RGWListBucketsRequest.html#a1c5355b578c682ebecb084c43d88a092">rgw::RGWListBucketsRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1007</div></div>
<div class="ttc" id="rgw__common_8h_html_a401f2754b8c0f4d60651b6b4635ed92e"><div class="ttname"><a href="rgw__common_8h.html#a401f2754b8c0f4d60651b6b4635ed92e">RGW_ATTR_UNIX_KEY1</a></div><div class="ttdeci">#define RGW_ATTR_UNIX_KEY1</div><div class="ttdef"><b>Definition:</b> rgw_common.h:103</div></div>
<div class="ttc" id="structRGWAccessKey_html"><div class="ttname"><a href="structRGWAccessKey.html">RGWAccessKey</a></div><div class="ttdef"><b>Definition:</b> rgw_common.h:434</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_aaa3891c21d317d8f85f843026fa8e21e"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#aaa3891c21d317d8f85f843026fa8e21e">rgw::RGWStatLeafRequest::op_init</a></div><div class="ttdeci">virtual int op_init()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1791</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_a932accea77101187fee3a915b0d20588"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#a932accea77101187fee3a915b0d20588">rgw::RGWFileHandle::root_name</a></div><div class="ttdeci">static const std::string root_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:221</div></div>
<div class="ttc" id="classrgw_1_1RGWStatLeafRequest_html_a00777144b9e021b385791a7d93451362"><div class="ttname"><a href="classrgw_1_1RGWStatLeafRequest.html#a00777144b9e021b385791a7d93451362">rgw::RGWStatLeafRequest::only_bucket</a></div><div class="ttdeci">virtual bool only_bucket()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1789</div></div>
<div class="ttc" id="classrgw_1_1RGWFileHandle_html_afd2a5eb703596cb52311f229f6944956"><div class="ttname"><a href="classrgw_1_1RGWFileHandle.html#afd2a5eb703596cb52311f229f6944956">rgw::RGWFileHandle::FLAG_NONE</a></div><div class="ttdeci">static constexpr uint32_t FLAG_NONE</div><div class="ttdef"><b>Definition:</b> rgw_file.h:225</div></div>
<div class="ttc" id="rgw__common_8h_html_adedf6eb016de146128a1adb706df37d8"><div class="ttname"><a href="rgw__common_8h.html#adedf6eb016de146128a1adb706df37d8">RGWOpType</a></div><div class="ttdeci">RGWOpType</div><div class="ttdef"><b>Definition:</b> rgw_common.h:388</div></div>
<div class="ttc" id="classrgw_1_1RGWLibFS_html_acf285a5e341bb35fad15a6870e167e0d"><div class="ttname"><a href="classrgw_1_1RGWLibFS.html#acf285a5e341bb35fad15a6870e167e0d">rgw::RGWLibFS::rele</a></div><div class="ttdeci">void rele()</div><div class="ttdef"><b>Definition:</b> rgw_file.h:767</div></div>
<div class="ttc" id="classrgw_1_1RGWStatObjRequest_html_a6a34d12d6a3ec0c2b653d3017739e811"><div class="ttname"><a href="classrgw_1_1RGWStatObjRequest.html#a6a34d12d6a3ec0c2b653d3017739e811">rgw::RGWStatObjRequest::obj_name</a></div><div class="ttdeci">const std::string &amp; obj_name</div><div class="ttdef"><b>Definition:</b> rgw_file.h:1608</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 14 2016 21:41:39 for Ceph RADOS Gateway by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
