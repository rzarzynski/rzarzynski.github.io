<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Ceph RADOS Library: Snapshots</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ceph RADOS Library
   &#160;<span id="projectnumber">60e2bec73ff3970e0c6b44250ce465e6c5dde56f</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Snapshots</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad51eaaea0ff8775386cb46e8d3482461"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#gad51eaaea0ff8775386cb46e8d3482461">rados_ioctx_snap_create</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, const char *snapname)</td></tr>
<tr class="separator:gad51eaaea0ff8775386cb46e8d3482461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7f436d59ceab1779a342770dd33816b"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#gaa7f436d59ceab1779a342770dd33816b">rados_ioctx_snap_remove</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, const char *snapname)</td></tr>
<tr class="separator:gaa7f436d59ceab1779a342770dd33816b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32f26dfcf00f7d5ad2ece4bea0e549b9"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga32f26dfcf00f7d5ad2ece4bea0e549b9">rados_ioctx_snap_rollback</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, const char *oid, const char *snapname)</td></tr>
<tr class="separator:ga32f26dfcf00f7d5ad2ece4bea0e549b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba0559b2cf1d82b9527507788a994f78"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#gaba0559b2cf1d82b9527507788a994f78">rados_rollback</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, const char *oid, const char *snapname) __attribute__((deprecated))</td></tr>
<tr class="separator:gaba0559b2cf1d82b9527507788a994f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0952bef2b12373b2cb7c86d59131fc9"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#gac0952bef2b12373b2cb7c86d59131fc9">rados_ioctx_snap_set_read</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> snap)</td></tr>
<tr class="separator:gac0952bef2b12373b2cb7c86d59131fc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c1349c0fa36033abac30052bee2a8f3"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga0c1349c0fa36033abac30052bee2a8f3">rados_ioctx_selfmanaged_snap_create</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *snapid)</td></tr>
<tr class="separator:ga0c1349c0fa36033abac30052bee2a8f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82b319c2e959e354e9f4065111b3451d"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga82b319c2e959e354e9f4065111b3451d">rados_ioctx_selfmanaged_snap_remove</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> snapid)</td></tr>
<tr class="separator:ga82b319c2e959e354e9f4065111b3451d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada1171cf52b6b37571cc5d8519da489b"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#gada1171cf52b6b37571cc5d8519da489b">rados_ioctx_selfmanaged_snap_rollback</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, const char *oid, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> snapid)</td></tr>
<tr class="separator:gada1171cf52b6b37571cc5d8519da489b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga167b88a0cccb06c553e786cf1190ba22"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga167b88a0cccb06c553e786cf1190ba22">rados_ioctx_selfmanaged_snap_set_write_ctx</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> seq, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *snaps, int num_snaps)</td></tr>
<tr class="separator:ga167b88a0cccb06c553e786cf1190ba22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga07cbdeb89d3bb57712e2efd9a276b216"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga07cbdeb89d3bb57712e2efd9a276b216">rados_ioctx_snap_list</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *snaps, int maxlen)</td></tr>
<tr class="separator:ga07cbdeb89d3bb57712e2efd9a276b216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e3605c1e6ec7e1f74d89e6f5cb6c780"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga0e3605c1e6ec7e1f74d89e6f5cb6c780">rados_ioctx_snap_lookup</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, const char *name, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *id)</td></tr>
<tr class="separator:ga0e3605c1e6ec7e1f74d89e6f5cb6c780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c4dd3bc1af3e693559cdd77677d0367"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga5c4dd3bc1af3e693559cdd77677d0367">rados_ioctx_snap_get_name</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> id, char *name, int maxlen)</td></tr>
<tr class="separator:ga5c4dd3bc1af3e693559cdd77677d0367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga43e4b3c47a04540b9dae9526f51446b2"><td class="memItemLeft" align="right" valign="top">CEPH_RADOS_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__librados__h__snaps.html#ga43e4b3c47a04540b9dae9526f51446b2">rados_ioctx_snap_get_stamp</a> (<a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a> io, <a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> id, time_t *t)</td></tr>
<tr class="separator:ga43e4b3c47a04540b9dae9526f51446b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>RADOS snapshots are based upon sequence numbers that form a snapshot context. They are pool-specific. The snapshot context consists of the current snapshot sequence number for a pool, and an array of sequence numbers at which snapshots were taken, in descending order. Whenever a snapshot is created or deleted, the snapshot sequence number for the pool is increased. To add a new snapshot, the new snapshot sequence number must be increased and added to the snapshot context.</p>
<p>There are two ways to manage these snapshot contexts:</p>
<ol type="1">
<li>within the RADOS cluster These are called pool snapshots, and store the snapshot context in the OSDMap. These represent a snapshot of all the objects in a pool.</li>
<li>within the RADOS clients These are called self-managed snapshots, and push the responsibility for keeping track of the snapshot context to the clients. For every write, the client must send the snapshot context. In librados, this is accomplished with rados_selfmanaged_snap_set_write_ctx(). These are more difficult to manage, but are restricted to specific objects instead of applying to an entire pool. </li>
</ol>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga0c1349c0fa36033abac30052bee2a8f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_selfmanaged_snap_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *&#160;</td>
          <td class="paramname"><em>snapid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate an ID for a self-managed snapshot</p>
<p>Get a unique ID to put in the snaphot context to create a snapshot. A clone of an object is not created until a write with the new snapshot context is completed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool in which the snapshot will exist </td></tr>
    <tr><td class="paramname">snapid</td><td>where to store the newly allocated snapshot ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="ga82b319c2e959e354e9f4065111b3451d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_selfmanaged_snap_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a>&#160;</td>
          <td class="paramname"><em>snapid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a self-managed snapshot</p>
<p>This increases the snapshot sequence number, which will cause snapshots to be removed lazily.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool in which the snapshot will exist </td></tr>
    <tr><td class="paramname">snapid</td><td>where to store the newly allocated snapshot ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="gada1171cf52b6b37571cc5d8519da489b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_selfmanaged_snap_rollback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a>&#160;</td>
          <td class="paramname"><em>snapid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rollback an object to a self-managed snapshot</p>
<p>The contents of the object will be the same as when the snapshot was taken.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool in which the object is stored </td></tr>
    <tr><td class="paramname">oid</td><td>the name of the object to rollback </td></tr>
    <tr><td class="paramname">snapid</td><td>which snapshot to rollback to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="ga167b88a0cccb06c553e786cf1190ba22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_selfmanaged_snap_set_write_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a>&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *&#160;</td>
          <td class="paramname"><em>snaps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_snaps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the snapshot context for use when writing to objects</p>
<p>This is stored in the io context, and applies to all future writes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the io context to change </td></tr>
    <tr><td class="paramname">seq</td><td>the newest snapshot sequence number for the pool </td></tr>
    <tr><td class="paramname">snaps</td><td>array of snapshots in sorted by descending id </td></tr>
    <tr><td class="paramname">num_snaps</td><td>how many snaphosts are in the snaps array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd>
<dd>
-EINVAL if snaps are not in descending order </dd></dl>

</div>
</div>
<a class="anchor" id="gad51eaaea0ff8775386cb46e8d3482461"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_snap_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>snapname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a pool-wide snapshot</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool to snapshot </td></tr>
    <tr><td class="paramname">snapname</td><td>the name of the snapshot </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="ga5c4dd3bc1af3e693559cdd77677d0367"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_snap_get_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the name of a pool snapshot</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool to read from </td></tr>
    <tr><td class="paramname">id</td><td>the snapshot to find </td></tr>
    <tr><td class="paramname">name</td><td>where to store the result </td></tr>
    <tr><td class="paramname">maxlen</td><td>the size of the name array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd>
<dd>
-ERANGE if the name array is too small </dd></dl>

</div>
</div>
<a class="anchor" id="ga43e4b3c47a04540b9dae9526f51446b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_snap_get_stamp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find when a pool snapshot occurred</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool the snapshot was taken in </td></tr>
    <tr><td class="paramname">id</td><td>the snapshot to lookup </td></tr>
    <tr><td class="paramname">t</td><td>where to store the result </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="ga07cbdeb89d3bb57712e2efd9a276b216"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_snap_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *&#160;</td>
          <td class="paramname"><em>snaps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>List all the ids of pool snapshots</p>
<p>If the output array does not have enough space to fit all the snapshots, -ERANGE is returned and the caller should retry with a larger array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool to read from </td></tr>
    <tr><td class="paramname">snaps</td><td>where to store the results </td></tr>
    <tr><td class="paramname">maxlen</td><td>the number of rados_snap_t that fit in the snaps array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of snapshots on success, negative error code on failure </dd>
<dd>
-ERANGE is returned if the snaps array is too short </dd></dl>

</div>
</div>
<a class="anchor" id="ga0e3605c1e6ec7e1f74d89e6f5cb6c780"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_snap_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a> *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the id of a pool snapshot</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool to read from </td></tr>
    <tr><td class="paramname">name</td><td>the snapshot to find </td></tr>
    <tr><td class="paramname">id</td><td>where to store the result </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="gaa7f436d59ceab1779a342770dd33816b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_snap_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>snapname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete a pool snapshot</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool to delete the snapshot from </td></tr>
    <tr><td class="paramname">snapname</td><td>which snapshot to delete </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="ga32f26dfcf00f7d5ad2ece4bea0e549b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_ioctx_snap_rollback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>snapname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rollback an object to a pool snapshot</p>
<p>The contents of the object will be the same as when the snapshot was taken.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the pool in which the object is stored </td></tr>
    <tr><td class="paramname">oid</td><td>the name of the object to rollback </td></tr>
    <tr><td class="paramname">snapname</td><td>which snapshot to rollback to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative error code on failure </dd></dl>

</div>
</div>
<a class="anchor" id="gac0952bef2b12373b2cb7c86d59131fc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API void rados_ioctx_snap_set_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="librados_8h.html#ac997570481a967558a27892037ed0f40">rados_snap_t</a>&#160;</td>
          <td class="paramname"><em>snap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the snapshot from which reads are performed.</p>
<p>Subsequent reads will return data as it was at the time of that snapshot.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">io</td><td>the io context to change </td></tr>
    <tr><td class="paramname">snap</td><td>the id of the snapshot to set, or LIBRADOS_SNAP_HEAD for no snapshot (i.e. normal operation) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaba0559b2cf1d82b9527507788a994f78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CEPH_RADOS_API int rados_rollback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="librados_8h.html#aa892568c6a8b4f1c07785b228014e3e3">rados_ioctx_t</a>&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>snapname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>Deprecated: Use <a class="el" href="group__librados__h__snaps.html#ga32f26dfcf00f7d5ad2ece4bea0e549b9">rados_ioctx_snap_rollback()</a> instead </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 5 2015 14:26:23 for Ceph RADOS Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
